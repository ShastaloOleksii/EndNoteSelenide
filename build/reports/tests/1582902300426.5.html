<html class="dj_webkit dj_chrome dj_contentbox"><head>
<base href="https://www.myendnoteweb.com:443/EndNoteWeb.html">
<title>EndNote</title>
<!-- EndNote 3.24 #MONIKER# -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="apple-itunes-app" content="app-id=593994211">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="shortcut icon" href="/images/en_us/ENWeb_favicon.ico">


<link rel="stylesheet" type="text/css" href="/css/001/en_us/int.min.css">
<link rel="preload" as="style" href="/css/001/en_us/int.min.css">
<link rel="stylesheet" type="text/css" href="ext.min.css">
<link rel="preload" as="style" href="ext.min.css">
<link id="themeStyles" rel="stylesheet" href="/dojo/dijit/themes/tundra/tundra.css">
<link id="themeStyles" rel="preload" as="style" href="/dojo/dijit/themes/tundra/tundra.css">
<link rel="stylesheet" href="/dojo/dojox/image/resources/image.css">
<link rel="preload" as="style" href="/dojo/dojox/image/resources/image.css">


<script type="text/javascript" async="" src="https://www.google-analytics.com/plugins/ua/linkid.js"></script><script async="" src="//www.google-analytics.com/analytics.js"></script><script async="" src="//d3rm6si6l6yzgk.cloudfront.net/1p-frontend/snowplow/sp-2.6.1.js"></script><script src="toolkits/ext.min.js" async=""></script>
<link rel="preload" as="script" href="dojo/dojo/dojo.js">
<script type="text/javascript" src="/dojo/dojo/dojo.js"></script>
<script>(function(p,l,o,w,i,n,g){if(!p[i]){p.GlobalSnowplowNamespace=p.GlobalSnowplowNamespace||[];p.GlobalSnowplowNamespace.push(i);p[i]=function(){(p[i].q=p[i].q||[]).push(arguments)};p[i].q=p[i].q||[];n=l.createElement(o);g=l.getElementsByTagName(o)[0];n.async=1;n.src=w;g.parentNode.insertBefore(n,g);}}(window,document,'script','//d3rm6si6l6yzgk.cloudfront.net/1p-frontend/snowplow/sp-2.6.1.js','snowplow'));window.snowplow('newTracker','cf','snowplow.apps.clarivate.com',{encodeBase64:false,appId:'endnote',platform:'web',contexts:{gaCookies:true,performanceTiming:true}});window.snowplow('setUserId','13001176');const experimentId=123;function setupExperimentContext() { if (!experimentId) { return []; } return [{"schema":"iglu:ne.clarivate.com/usage/jsonschema/1-0-0","data": {"exp":"", "customerId":"", "appSessionId":""} }]; }</script>


<style type="text/css">
body {
	font-family:'Source Sans Pro',Calibri,Arial,Helvetica,sans-serif,'Helvetica Neue';
}
.contnavtext{
	border-right : 0px;
}
.RichTextEditable {
	border:1px solid #849CBD;
}
.gsrow1 {
    background-color: #E6E7E9;
    vertical-align: top;
}
/* Editor Border Color -  dojo 1.5 */
.dijitEditor {
        border:1px solid #849CBD;
}
.dijitInlineEditBoxDisplayModeHover {	
	background-color: #e2ebf2;
	border: solid 1px white;
	width: 726px;
}
.dijitInlineEditBoxDisplayMode {
	width: 727px;
	word-wrap: break-word;
/* border: 1px dotted #849CBD; */
}
.dijitInlineEditBoxEmptyField {
    border: 1px dotted #849CBD; 
    cursor: text;
	width: 727px;
}
.dijitInlineEditBoxDataField {
    border: 0px;
    cursor: text;
	width: 726px;
}
.ResearcherID_links{
	color: #996633;
	font-weight:normal;
	font-size:65%;;
	font-family:'Source Sans Pro',Calibri,Arial,Helvetica,sans-serif;
	padding: 0;
	margin: 0 7px 0 15px;
}
.GroupSet_links{
	color:#707070;
	font-weight:normal;
	font-size:65%;
	font-family:'Source Sans Pro',Calibri,Arial,Helvetica,sans-serif;
	padding: 0;
	margin: 0 7px 0 15px;
}
.GroupSet_groups{
	font-weight:normal;
	font-size:65%;
	font-family:'Source Sans Pro',Calibri,Arial,Helvetica,sans-serif;
	padding: 0;
	margin: 0 7px 0 15px;
}
.groupshead {
       color: #996633;
	 }
.SharedGroupsLine {
      color: #990033;	 
 }
.SharedGroupsHeading {
      color: #990033;
	  font-weight:bold;
 }
.sharedHead {
	font-weight: bold;
	font-size: 120%;
	padding-bottom: 2px;
	/*padding-left: 5px;*/
	padding-top: 8px;
	color: #990033; 
}
 .dotvert_g { 
 	background: url(/images/dots_vert.gif) 50% 100% repeat-y;
 	background-color: #E8E8E8;
 	width: 15px; 	
 }
</style>


</head><body><a name=" "></a>



<script> 
	var isIE11 = '0';
	var lang = '';
	djConfig = { parseWidgets: false, searchIds: [] , parseOnLoad: false, locale: lang }; </script>

<script type="text/JavaScript">
window.snowplow('trackPageView', null, setupExperimentContext());
<!--
function MM_preloadImages() { //v3.0	
    var d=document; 
    if(d.images){ 
        if(!d.MM_p) 
            d.MM_p=new Array();
        var i,j=d.MM_p.length,a=MM_preloadImages.arguments; 
        for(i=0; i<a.length; i++)
            if (a[i].indexOf("#")!=0){ 
                d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];
            }
    }
}
function MM_swapImgRestore() { //v3.0
    var i,x,a=document.MM_sr; 
    for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) 
        x.src=x.oSrc;
}
function MM_findObj(n, d) { //v4.01
    var p,i,x;  
    if(!d) d=document; 
    if((p=n.indexOf("?"))>0&&parent.frames.length) {
        d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);
    }
    if(!(x=d[n])&&d.all)
        x=d.all[n]; 
    for (i=0;!x&&i<d.forms.length;i++) 
        x=d.forms[i][n];
    for(i=0;!x&&d.layers&&i<d.layers.length;i++) 
        x=MM_findObj(n,d.layers[i].document);
    if(!x && d.getElementById) 
        x=d.getElementById(n); 
    return x;
}
function MM_swapImage() { //v3.0
    var i,j=0,x,a=MM_swapImage.arguments; 
    document.MM_sr=new Array; 
    for(i=0;i<(a.length-2);i+=3)
    if ((x=MM_findObj(a[i]))!=null) {
        document.MM_sr[j++]=x; 
        if(!x.oSrc) 
            x.oSrc=x.src; 
        x.src=a[i+2];
    }
}
//---------------------------
menu=["myref", "collect", "organize", "format", "options", "connect","adminTools",];
function showMenu(menuId) 
{	
	noHide();
	prevMenuId = menuId;
	hidePrevSubmenu(prevMenuId,menuId);
	if(menuId != 1 &&  menuId != 5 && menuId != 7) {
		document.getElementById('enwHeader').style.backgroundColor = "rgb(228, 229, 236)";
    }
	else {
		document.getElementById('enwHeader').style.backgroundColor = "rgb(255, 255, 254)";
	}
	if(typeof activeMenuId != "undefined" && menuId == activeMenuId && document.getElementById('submenu_'+activeMenuId) != undefined) {
		 document.getElementById('submenu_'+activeMenuId).style.visibility="visible";
	}
	if(typeof activeMenuId != "undefined") {
		if(typeof activeMenuId != "undefined" && menuId != activeMenuId && prevMenuId != activeMenuId && document.getElementById('submenu_'+activeMenuId) != undefined) {
			if(document.getElementById('submenu_'+activeMenuId).style.visibility == "visible") {
				document.getElementById('submenu_'+activeMenuId).style.visibility="hidden";
			}
		}
	    document.getElementById('lgLink'+activeMenuId).style.borderBottom = '4px solid rgb(94, 51, 191)';
	}
	showActiveMenu();
}
function hidePrevSubmenu(prevMenuId,menuId) {
	if(typeof activeMenuId != "undefined") {
		if(menuId != activeMenuId && prevMenuId != activeMenuId && document.getElementById('submenu_'+activeMenuId) != undefined) {
			document.getElementById('submenu_'+activeMenuId).style.visibility='hidden';
		}	     
		showCurrSubmenu(activeMenuId);
	}
}
function showCurrSubmenu(menuId) {
	if(typeof activeMenuId != "undefined" && menuId == activeMenuId) {
		document.getElementById('lgLink'+menuId).style.borderBottom = '4px solid rgb(94, 51, 191)';
		var tab = document.getElementById('tab'+menuId);
		showActiveMenu();
	}
}
function noHide() {
	document.getElementById('enwHeader').style.backgroundColor = "rgb(228, 229, 236)";
	if (self.tm) clearTimeout(tm);
}
function doHide() {	
	document.getElementById('enwHeader').style.backgroundColor = "rgb(255, 255, 255)";
	tm=setTimeout("showActiveMenu(activeMenuId)", 1000);	
}
function showActiveMenu() {
	if(document.getElementById('enwHeader').style.backgroundColor != "rgb(228, 229, 236)" && document.getElementById('enwHeader').style.backgroundColor != "rgb(255, 255, 254)") {
		var tab = document.getElementById('tab'+activeMenuId);
		if(tab && !tab.className.match('open')) {
			tab.className=tab.className + " open";
		}
		if(typeof activeMenuId != "undefined" && document.getElementById('submenu_'+activeMenuId) != undefined && document.getElementById('submenu_'+activeMenuId).style.visibility == "hidden") {
			document.getElementById('submenu_'+activeMenuId).style.visibility="visible";
			document.getElementById('enwHeader').style.backgroundColor = "rgb(255, 255, 255)";
		}
	}
}
if (document.addEventListener) {
   document.addEventListener("contextmenu", openLink);
}
else if(document.attachEvent) {
	document.attachEvent('on' + "contextmenu", openLink);
}
function openLink(ev) {  
	if (typeof ev.target != 'undefined') {
		element = ev.target;
	}
	else {
		element = ev.srcElement;
	}		
    if(element.parentNode.href!=undefined&&element.parentNode.href.match(/javascript\s*\:/))
		element = element.parentNode;
    if( element.href != undefined && element.href.match(/javascript\s*\:/)) {
		var urlLink = element.getAttribute("onclick");
		if(urlLink != undefined && urlLink.match(/openUrl_location\(\'(.*)\'\,/)) {
			var param = urlLink.match(/openUrl_location\(\'(.*)\'\,/);
			element.href = param[1];
			setTimeout(function(){ element.href="javascript:void()"; }, 100);
		}
		else {
			if(urlLink != undefined && urlLink.match(/goToSignUp/)){
				goToSignUp();	
			}
			else if(element.id == "feedbk") {
				window.open('EndNoteWeb.html?func=feedBack&','','status=yes,menubar=yes,scrollbars=yes,resizable=yes,width=800,height=600');
			}
			else if(element.href.match(/javascript\:chgLanguage/)) {
				var param = element.href.match(/\(\'(.*)\'\)/);				
				chgLanguage(param[1]);
			}
			else if(urlLink != undefined && urlLink.match(/javascript\:setGettingStartedGuide/)) {
					var param = urlLink.match(/\(\"(.*)\"\)/);	
					setGettingStartedGuide(param[1]);
			}
			if(ev.preventDefault())
				ev.preventDefault();
			else if(ev.stopPropagation != undefined)
				ev.stopPropagation();
			else
			    ev.cancelBubble = true;
			}
			return false;
	}
}
function openUrlWindow(theURL,winName,features) {
    if(winName=="window"){
        newWindow = window.open(theURL,winName,features);		
		newWindow.focus();
	}
	else if(winName=="tab"){
             newWindow = window.open(theURL,"_target");
			 newWindow.focus();
	}
	else if(winName=="self"){
	window.location=theURL;
	}
        return false;
}
function openUrl_location(theURL,winName,features) {
    if(winName.length){
        return openUrlWindow(theURL,winName,features);
    }else{
        return true;
    }
}	
window.onload = init;
function init() {
	var elem = '<span><br><div class="wui-content-title--small">We get it. Research is a process. </div><div class="wui-content-body--small">We are exploring new ways to help you discover, discuss and connect around research. Take a look.</div><button data-dismiss="popover" onclick="setNeonOnboardingMessage()" class="close wui-btn wui-btn--primary pull-right">Got it </button></span>';
	var toolTip = window.name || "";
	if(typeof activeMenuId != "undefined" && activeMenuId == 1) {
		$('[data-toggle="popover"]').popover({animation:true,  content:elem, html:true});
		$('[data-toggle="popover"]').popover('show');
	}
	$(document).on("click", ".popover .close" , function() {
		$(this).parents(".popover").popover('hide');
    });
	$('html').on("click touchstart",function(e) {
		$('.popover').popover('hide');
	});
}
function setNeonOnboardingMessage() {
	var flag = "yes";
	dojo.xhrGet({
				  url          : "EndNoteWeb.html?func=setNeonOnboardMsg&userGotNeonMsg="+flag,
				  preventCache : true,
				  load         : function (data) {
								 },
				  error        : function(response, ioArgs) { 
										console.error(response);
								}
			   });
}
//-->
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-59903427-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>




<table width="100%" id="summaryOuterTable" border="0" cellspacing="0" cellpadding="0">
<tbody><tr><td colspan="3">
<nav id="enwHeader" class="ne-nav ng-scope">
    <div class="ne-main-nav-wrapper">
      <div class="container-fluid">
	 	<div class="ne-main-nav">
          <h1 class="ne-nav-logo">
            <a onclick="ga('send', 'event', 'Clarivate Analytics Logo','Link','Clarivate Logo');return openUrl_location('/','self');" href="javascript:void(0);" alt="Clarivate Analytics" title="Clarivate Analytics" "="">
              <span class="ne-nav-logo__text ne-nav-logo__text--tr"><img src="/images/en_us/clarivate_analytics_endnote2.png" alt="Clarivate Analytics" title="Clarivate Analytics"></span>
<!--
              <span class="ne-nav-logo__text ne-nav-logo__text--tr"><img id="trlogo" class="trlogo" name="Clarivate" src="/images/en_us/clarivate.png" alt="Clarivate Analytics" title="Clarivate Analytics" ></span>
-->

              <span class="ne-nav-logo__text ne-nav-logo__text--ne invisible">Project Neon </span>
            </a>
          </h1>
         <div class="profile_apps">
		   <span class="dropdown ng-scope">
			 <a aria-expanded="true" href="" class="dropdown-toggle" data-toggle="dropdown" alt="Apps " title="Apps ">
   	 		    <i style="padding-right: 10px;" class="wui-icon wui-icon--app"></i>
			    <span class="hide">Apps </span>
			 </a>
             <ul class="neapps dropdown-menu dropdown-menu--with-caret dropdown-menu-right">
			   <li class="dropdown-header wui-super-header">MY APPS</li>
   			   <li class="divider"></li>
   			   <li id="rid">
			     <a onclick="ga('send', 'event', 'Apps link - Researcher ID','Link','RID URL');return openUrl_location('http://www.researcherid.com/','tab');" href="javascript:void(0);" alt="ResearcherID" title="ResearcherID" rel="noopener">ResearcherID</a></li>
			   <li class="divider"></li>
   			   <li id="pr">
			     <a onclick="ga('send', 'event', 'Apps link - Publon','Link','Publon URL');return openUrl_location('https://publons.com/clarivate/?utm_source=clarivate&amp;utm_medium=endnoteweb_header','tab');" href="javascript:void(0);" alt="Publons: The home of peer review" title="Publons: The home of peer review">Publons</a></li>
<!--		   <li class="divider"></li>
   			   <li><a onclick="return openUrl_location('' ,'tab');" href="javascript:void(0);">InCites</a></li>
			   <li class="divider"></li>
   			   <li><a onclick="return openUrl_location('','tab');" href="javascript:void(0);">ScholarOne Abstracts</a></li>
			   <li class="divider"></li>
   			   <li><a onclick="return openUrl_location('','tab');" href="javascript:void(0);">ScholarOne Manuscripts</a></li>
			   <li class="divider"></li>
   			   <li><a class="brand" onclick="return openUrl_location('https://access.clarivate.com/#/home?app=endnote','tab');" href="javascript:void(0);">Project Neon</a></li> -->
   			   <li class="divider"></li>
            </ul>
          </span>

	 	  <span class="dropdown">
			 <a href="" class="dropdown-toggle" data-toggle="dropdown" alt="AAA AAA" title="AAA AAA">
   	 	      <img class="img-circle" id="proSmallImg" src="images/profile2.jpg" alt="">
			 </a>
             <ul id="profile" class="dropdown-menu dropdown-menu--with-caret dropdown-menu-right">
	 		   <li class="dropdown-header">
		<!--		<a onclick="ga('send', 'event', 'Profile link - User Info','Link','Profile'); return openUrl_location('https://access.clarivate.com/#/profile?app=endnote','self');" href="javascript:void(0);" alt="AAA AAA" title="AAA AAA" class="inactiveLink"> -->
			<a onclick="ga('send', 'event', 'Profile link - User Info','Link','Profile'); return openUrl_location('https://access.clarivate.com/#/profile?app=endnote','self');" href="javascript:void(0);" class="inactiveLink">
			   <img alt="AAA AAA" title="AAA AAA" class="img-circle" id="proImg" src="images/profile2.jpg">			   
			      <p>
				   <span class="profile_title">AAA AAA</span><br>
				    <span class="profile_description_empty"></span><br>
<!--					   <span style="color:#288cb6;font-size:13px;text-decoration:none" class="invisible" alt="" title=""></span> -->
				  </p>
               </a>
              </li>			
			  <li class="profilelinks">
				  <ul class="row1 list-inline ">
				      <li class="pull-left">
				<a onclick="ga('send', 'event', 'Profile link - User Account','Link','Account'); return openUrl_location('./EndNoteWeb.html?func=chgpasswd&amp;', 'self');" href="javascript:void(0);">
					      <span class="fa fa-cog profile_account_link"></span>Account
					    </a>
				      </li>
					  <li class="pull-right" style="padding-right:3px">

					    <a target="_self" onclick="ga('send', 'event', 'Profile link - Sign out','Link','Sign out ');" href="./EndNoteWeb.html?func=logout&amp;locale=en_us&amp;">Sign out 
						    <span class="fa fa-sign-out profile_signout_link"></span>
					    </a>
	
					  </li>
                  </ul><br>
				  <div class="seperator"></div>
				  <ul class="row2 list-inline" style="text-align: center;">
					<li><a onclick="ga('send', 'event', 'Profile link - Privacy','Link','Privacy'); return openUrl_location('https://access.clarivate.com/#/privacy-statement-app?app=endnote', 'tab');" href="javascript:void(0);" rel="noopener">Privacy</a></li><li class="divider-vertical"></li>
					<li><a onclick="ga('send', 'event', 'Profile link - Neon AcceptableUse','Link','AcceptableUse'); return openUrl_location('https://access.clarivate.com/#/terms-of-use-app?app=endnote', 'tab');" href="javascript:void(0);">Terms of use</a></li><li class="divider-vertical"></li>
					<li><a onclick="ga('send', 'event', 'Profile link - EN Help','Link','Help');return openUrl_location('/help/en_us/ENW/help.htm','tab');" href="javascript:void(0);" rel="noopener">Help</a></li>
					<li class="divider-vertical"></li>
					<li><a onclick="ga('send', 'event', 'Profile link - Neon Feedback','Link','Feedback'); return openUrl_location('EndNoteWeb.html?func=feedBack&amp;','window','status=yes,menubar=yes,scrollbars=yes,resizable=yes,width=800,height=600');" href="javascript:void(0);">Feedback</a></li>
					
					
				  </ul>
			</li>
		</ul>
	  <span>
   </span></span></div>
  </div>
 </div>
</div>
  
<!-- end: MasterBegin -->

<!-- begin: Tab -->
<!--[if (IE 9)|(IE 8)]>
<style type="text/css" >
.nav > li > a {
	padding:10px 0px;
	line-height: 42px;
}
</style>	
<![endif]-->
	<div class="navbar navbar-default">
<!--
	 <div class="navbar-header">
       <a class="navbar-brand h3" onclick="ga('send','event', 'EndNote Logo','Click','EN Logo'); return openUrl_location('/','self');" alt="EndNote logo" title="EndNote logo">EndNote<sup>TM</sup><span>basic</span></a>
	 </div>
-->
     <div class="navbar-collapse collapse" style="height:auto">
	   <ul class="nav navbar-nav navbar-middle">

		 <li class="ne-subnav-link-wrapper open" id="tab1">
			<a id="lgLink1" href="./EndNoteWeb.html?cat=myrefs&amp;" border="0" onmouseover="this.style.color='#000000';showMenu(1); return true" onmouseout="this.style.color='#000000';doHide(); return true" alt="View your references" title="View your references" style="border-bottom: 4px solid rgb(94, 51, 191);">My&nbsp;References</a>
		 
		 </li><li class="dropdown ne-subnav-link-wrapper" id="tab2">
			<a id="lgLink2" href="./EndNoteWeb.html?func=remoteSearchConnections&amp;cat=collect&amp;" border="0" onmouseover="this.style.color='#000000';showMenu(2); return true" onmouseout="this.style.color='#000000';doHide();return true" alt="Collect references" title="Collect references">Collect</a>
		
			 <ul class="dropdown-menu submenus" id="submenu_2">
				 <li class="contnavtext"><a href="EndNoteWeb.html?func=remoteSearchConnections&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Online Search</a></li>
                 <li class="contnavtext"><a href="EndNoteWeb.html?func=new&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">New Reference</a></li>
                 <li class="contnavtext"><a href="./EndNoteWeb.html?func=import%20citations&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Import References</a></li>
             </ul>
		 
		 </li><li class="dropdown ne-subnav-link-wrapper" id="tab3">
            <a id="lgLink3" href="./EndNoteWeb.html?func=folderOptions&amp;cat=organize&amp;" alt="Organize references" title="Organize references" border="0" onmouseover="this.style.color='#000000';showMenu(3); return true" onmouseout="this.style.color='#000000';doHide(); return true">Organize</a> 
		
			<ul class="dropdown-menu submenus" id="submenu_3">
				<li class="contnavtext"><a href="./EndNoteWeb.html?func=folderOptions&amp;page=manageFolders&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Manage My Groups</a></li>
				<li class="contnavtext "><a href="./EndNoteWeb.html?func=othersList&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Others' Groups</a></li>
				<li class="contnavtext"><a href="./EndNoteWeb.html?func=findDuplicates&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Find Duplicates</a></li>
				<li class="contnavtext"><a href="./EndNoteWeb.html?func=manageAttachments&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Manage Attachments</a></li>
			</ul>
          
		  </li><li class="dropdown ne-subnav-link-wrapper" id="tab4">
            <a id="lgLink4" href="./EndNoteWeb.html?func=bibliography&amp;cat=format&amp;" border="0" alt="Format references" title="Format references" onmouseover="this.style.color='#000000';showMenu(4); return true" onmouseout="this.style.color='#000000';doHide(); return true">Format</a>
     
			 <ul class="dropdown-menu submenus" id="submenu_4">
				<li class="contnavtext"><a href="./EndNoteWeb.html?func=bibliography&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Bibliography</a></li>
				<li class="contnavtext"><a href="./EndNoteWeb.html?func=showcwyw&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Cite While You Writeâ„¢ Plug-In</a></li>
				<li class="contnavtext"><a href="./EndNoteWeb.html?func=scan%20paper&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Format Paper</a></li>
				<li class="contnavtext"><a href="./EndNoteWeb.html?func=export%20citations&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Export References</a></li>
			</ul>              

		 </li><li class="ne-subnav-link-wrapper" id="tab5">
  			 <a id="lgLink5" href="./EndNoteWeb.html?func=journalDetails&amp;cat=details&amp;" border="0" alt="Match" title="Match" onmouseover="this.style.color='#000000';showMenu(5); return true" onmouseout="this.style.color='#000000';doHide(); return true">Match</a>

		 </li><li class="dropdown ne-subnav-link-wrapper" id="tab6">
             <a id="lgLink6" href="./EndNoteWeb.html?func=chgpasswd&amp;cat=options&amp;" border="0" alt="Options" title="Options" onmouseover="this.style.color='#000000';showMenu(6); return true" onmouseout="this.style.color='#000000';doHide(); return true">Options</a>

			<ul class="dropdown-menu submenus" id="submenu_6">
            <li class="contnavtext"><a href="./EndNoteWeb.html?func=chgpasswd&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Password</a></li>
            <li class="contnavtext"><a href="./EndNoteWeb.html?func=chgusername&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">E-mail Address</a></li>
            <li class="contnavtext"><a href="./EndNoteWeb.html?func=chgprofile&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Profile Information</a></li>
				<li class="contnavtext"><a href="./EndNoteWeb.html?func=chglanguage&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Language</a></li>
				<li class="contnavtext"><a href="./EndNoteWeb.html?func=accountInformation&amp;" onmouseover="noHide();  return true;" onmouseout="doHide(); return true">Subscription </a></li>
			</ul>
         
		 </li><li class="ne-subnav-link-wrapper" id="tab7">
        	 <a id="lgLink7" href="./EndNoteWeb.html?func=downloadInstallers&amp;cat=download&amp;" border="0" alt="Downloads" title="Downloads" onmouseover="this.style.color='#000000';showMenu(7); return true" onmouseout="this.style.color='#000000';doHide(); return true">Downloads</a>

	     </li>
      </ul>

	</div>
  </div>
</nav>

</td></tr>

<tr><td colspan="3">

<!-- begin: SubMenu -->
</td></tr><tr>
    <td colspan="3" class="contnav" style="padding-top:0px" valign="top">
        <table border="0" width="100%" cellspacing="0" cellpadding="0">
            <tbody><tr></tr>
            <tr>
              <td>
                  <table width="100%" border="0" cellpadding="0" cellspacing="0" id="searchTabsTable">
                    <tbody><tr><td>
                      <div id="idGuideLink" class="guideLink"><a href="javascript:void(0);" onclick="javascript:setGettingStartedGuide(&quot;show&quot;)" title="Show Getting Started Guide" alt="Show Getting Started Guide">Show Getting Started Guide</a></div></td></tr>
                  </tbody></table>
              </td>
            </tr>
            <tr>
                <td valign="top">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0">
                        <tbody><tr>
                            <td colspan="3">
							</td>
                        </tr>

                        <tr>
                            <td></td><td colspan="3" class="dothorz"></td>
                        </tr>
                        <tr>

						<td id="onlineSideBar" width="29px" style="width: 29px;">
                           </td><td width="1" class="dotvert"><img src="/images/en_us/spacer.gif" alt=""></td>
                           <td class="summary_TopBox"></td>
                           <td width="1" class="dotvert"><img src="/images/en_us/spacer.gif" alt=""></td><td width="5">&nbsp;</td>
                        </tr>
                    </tbody></table>
               </td>
            </tr>
         </tbody></table></td>
    </tr>
<tr>
<!-- end: SubMenu -->


<script>
activeMenuId = 1;
prevMenuId = activeMenuId;
showCurrSubmenu(activeMenuId);
</script>
<!-- end: Tab -->


<!-- begin: LeftNav -->

<script>
    function togglePanel(e) {
        if(document.hideshowpanel.hideorshow.value == "hide") {
            document.hideshowpanel.hideorshow.value = "show";
            dojo.byId("sidepanel").style.display = 'none';
            dojo.byId("sidepanel_hidden").style.display = '';
            dojo.byId("hidepanel_img").style.display = 'none';
            dojo.byId("showpanel_img").style.display = '';
			 dojo.byId("showpanel_img").style.width = '19px';
			setHideShowPref('hide');
        } else {
            document.hideshowpanel.hideorshow.value = "hide";
            dojo.byId("sidepanel").style.display = '';
            dojo.byId("sidepanel_hidden").style.display = 'none';
            dojo.byId("hidepanel_img").style.display = '';
			dojo.byId("hidepanel_img").style.width = '19px';
            dojo.byId("showpanel_img").style.display = 'none';
			setHideShowPref('show');
        }
    }
    function setHideShowPref(SidePanelState) {
     dojo.xhrGet({
					url:    "./EndNoteWeb.html?func=setLeftNavState&SidePanelState="+SidePanelState,
                    preventCache : true,
					error	: function(response, ioArgs) { 
									//reload page if session expires
									window.location.href = window.location.protocol+"://"+window.location.host+window.location.pathname;
							}
                 });
    }
    function initAjax() {
        dojo.connect(dojo.byId("hidepanel_img"), "onclick", "togglePanel");
        dojo.connect(dojo.byId("showpanel_img"), "onclick", "togglePanel");
		if(0 == 1){
			document.getElementById("emptyTrash").alt = "Empty the Trash (disabled)";
			document.getElementById("emptyTrash").title = "Empty the Trash (disabled)";
			document.getElementById("emptyTrash").src = "/images/en_us/empty_disabled.gif";
			document.getElementById("emptyTrash").style.cursor = 'default';
		}
    }
	dojo.addOnLoad(initAjax);
</script>

    <td colspan="2">
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
            <tbody><tr>
                <td valign="top"><table border="0" width="100%" cellspacing="0" cellpadding="0" class="contnav_lower">
                    <tbody><tr>
                        <td valign="top">
			
			<div style="width:100%">
			<table height="350" border="0" cellpadding="0" cellspacing="0" id="summaryDisplayTable">
                                <tbody><tr>

    <td width="19" valign="top" rowspan="2">
        <div class="refinePadTop"></div>
        <form name="hideshowpanel">
        <input type="hidden" name="hideorshow" value="show">
<!--[if IE 8 ]> 
<style type="text/css" >
.pannel {
	background-color: #505050;
	color: #fff; 
	cursor: pointer;	
	border: 0;
	width: 141px; height: 22px; 
	font-family: arial; 
	font-size: 12px; 
	margin-left:0px;
	margin-top:0px;
	filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
}
</style>
 <![endif]-->
        <div id="hidepanel_img" style="display: none;"><a href="javascript:void(0);" target="_top">
			<input type="button" class="pannel" value="Hide panel" alt="Hide panel" title="Hide panel"></a>
		
			</div>
        <div id="showpanel_img" style="width: 19px"><a href="javascript:void(0);" target="_top">
			<input type="button" class="pannel" alt="Show panel" value="Show panel" title="Show panel"></a>
			</div>
        </form>
    </td>


                                    <td height="400" id="sidepanel_hidden" style="" class="sideBarCol" valign="top">
<table id="SubjectAreas" width="100%" height="100%" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td width="17" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;</td></tr></tbody></table>
                                    </td>
                 <td id="sidepanel" height="400" class="sideBarCol" style="display:none" valign="top">
                                    <div class="refinePadTop"></div>
                                    <script language="JavaScript">
function NoEmptySearchTerm(form){
    if (form.searchItem.value.length == 0){
	           alert('The search term you entered was empty. Please try again.');
			   return false;
    }else{
		var func= 'apisso';
		if (func == 'findDuplicates' || func =='new' || func == 'remoteSearchConnections') {
			document.citationSearchForm.searchFlag.value = 1;
			return true;
		}else{
			if(document.getElementById('sort_By') != undefined ){
			    document.getElementById('sort_By').selectedIndex = 0 ;
			}
                form.search_item.value = form.searchItem.value;
		        document.citationSearchForm.authorflag.value = 0;
				document.getElementById("idSortField").value = "";
				document.getElementById("idSortOrder").value = "";
				noPerPage = document.summarypage.TopRecordsPerSummary.value;				
				var folderid = form.selectedFolderId.value;
				if(folderid.match(/cguid_/)) {
					folderid = folderid.replace(/cguid_/,"");
				}
				if(folderid.match(/pguid_/)) {
					folderid = folderid.replace(/pguid_/,"pguid-");
				}
				loadCitations(1, noPerPage, folderid);
		}
    }
	form.searchItem.value="";
	form.searchItem.placeholder = "Search for";

	return false;
}

</script>

<form action="./EndNoteWeb.html" method="post" name="citationSearchForm" onsubmit="return NoEmptySearchTerm(this);">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="rightbggrey greyLeft" style="border-top:1px solid #bababa;"><div class="sideHead" style="color:#000000">Quick Search</div></td>
</tr>
</tbody></table>
<table width="100%" border="0" cellpadding="0" cellspacing="0" id="searchWithinTable">
<tbody><tr>
<td class="rightbggrey greyLeft">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tbody><tr>
<td>&nbsp;</td>
<td align="left">
<label for="searchItem"></label>
<input class="formBoxesSidePanel" placeholder="Search for" type="text" name="searchItem" id="searchItem" size="21" maxlength="120">
</td>
</tr>
<tr>
<td><div class="quickSearchText" align="right">in</div></td>
<td>
<select id="idQuickSearchGroups" name="selectedFolderId" class="formBoxesSave" onchange="if(options[selectedIndex].disabled)
	    {
		options[0].selected=true;
	    }">
<option value="0" "selected"="">All My References</option>

  
	<option value="1">[Unfiled]</option>     
     <option value="-1">Trash</option>





</select>
</td>
</tr>
<tr>
<td nowrap="">&nbsp;</td>
<td nowrap="">
<input type="submit" class="grey_btn" value="Search" id="search" name="search" alt="Search" title="Search" hspace="2" vspace="4">
<input type="hidden" name="searchField" value="all">
<input type="hidden" name="search_item" value="">
<input type="hidden" name="authorflag" value="">
<input type="hidden" name="selectedAuthor" value="">
<input type="hidden" name="searchFlag" value="0">
</td>
</tr>
</tbody></table>


 


                                    </td>

                        </tr>
                      </tbody></table>
		      
                      <table id="SubjectAreas" width="100%" border="0" cellpadding="0" cellspacing="0">
                        <tbody><tr>
                          <td class="rightbggrey greyBottom greyLeft">                 
                          <div class="dothorz greyBottom"></div>
            <form name="leftnavform" id="parent_form" action="./EndNoteWeb.html" method="get" onsubmit="return false;">
            <input type="hidden" name="currentFolderName" value="">
<div class="sideHead">My References</div>
<!--
<div class="betweenGroups"></div>
<div class="createGroup"><img src="/images/en_us/sp_group.gif" alt="Create a new group" title="Create a new group" onclick="return showNewFolder('','0')" id="idCreateGroup"></div>
-->
<div class="sideL1Active" id="idFolderLink_0"><a href="javascript:void(0)" onclick="javascript:changeFolderNavigation(0)" title="View all my references">All My References (0)</a>
</div>

		<div class="folder" id="idFolderLink_1"><a href="javascript:void(0)" onclick="javascript:changeFolderNavigation(1)" title="View references not in a group" alt="View references not in a group">[Unfiled] (0)</a>
		<input type="hidden" name="folderList" value="Unfiled">
		<input type="hidden" name="group_time_ms" value="18">
		</div>



<div id="idFolderLink_EL" class="folder">
	<a href="javascript:void(0)" onclick="javascript:changeFolderNavigation('EL')" title="View references in Quick List">Quick List (0)</a></div>

<div id="idFolderLink_-1" class="sideL1"><a style="color:#005a84;" href="javascript:void(0)" onclick="javascript:changeFolderNavigation(-1)" alt="View references in the Trash" title="View references in the Trash">Trash (0)</a> 
		<div id="emptyTrashId" style="display:none">
			<a href="javascript:void(0)" onclick="javascript:emptyTrash()" id="idEmptyTrash" style="text-decoration:none">
			<input type="button" class="grey_btn" style="padding: 0 4px;height: 17px;" value="Empty" id="emptyTrash" alt="Empty the Trash" align="absbottom" title="Empty the Trash">
		</a>
		</div>
        <div id="idTrashFolderLinkDeleteProgress" style="display:none"><img src="/images/en_us/progress_indicator_spinning.gif">&nbsp;&nbsp;Deleting records...</div>
</div>

<script type="text/javascript">
    function toggleGroupSet() {
        if(document.leftnavform.groupsettoggle.value == "hide") {
            dojo.byId("default_group_set").style.display = "none";
            document.leftnavform.groupsettoggle.value = "show";
            dojo.byId("collapse_down_img").style.display = "none";
            dojo.byId("collapse_right_img").style.display = '';
        } else {
            dojo.byId("default_group_set").style.display = '';
            document.leftnavform.groupsettoggle.value = "hide";
            dojo.byId("collapse_down_img").style.display = '';
            dojo.byId("collapse_right_img").style.display = 'none';
        }
    }
	 function toggleGroupSets(id) {		 
		 var isCollapsed="";
        if(document.getElementById("groupsetstoggle"+id).value == "hide") {		
			document.getElementById("count"+id).style.display = "none";
            dojo.byId("default_group_set"+id).style.display = '';            
			document.getElementById("groupsetstoggle"+id).value = "show";
			dojo.byId("collapse_down_image"+id).style.display = '';
            dojo.byId("collapse_right_image"+id).style.display = "none";
			isCollapsed = 0;
        } else {	
			document.getElementById("count"+id).style.display = '';
            dojo.byId("default_group_set"+id).style.display = "none";			
            document.getElementById("groupsetstoggle"+id).value = "hide";
            dojo.byId("collapse_down_image"+id).style.display = "none";
            dojo.byId("collapse_right_image"+id).style.display = '';
			isCollapsed = 1;
        }
		 var url = "./EndNoteWeb.html?func=setGroupSetState&setGroupSetState="+isCollapsed+"&groupsetId="+id;

		 dojo.xhrGet({
                    url			 : url,
                    preventCache : true,
						  load   : function (data){						 
					},
					error	     : function(response, ioArgs) { 
						 			 console.error(response);
							       }
                    });
    }
	function toggleRIDGroupSet(id) {
		var isCollapsed="";
        if(document.leftnavform.ridgroupsettoggle.value == "hide") {
            dojo.byId("rid_group_set").style.display = "none";
            document.leftnavform.ridgroupsettoggle.value = "show";
            dojo.byId("ridcollapse_down_img").style.display = "none";
            dojo.byId("ridcollapse_right_img").style.display = '';
			isCollapsed = 1;
        } else {
            dojo.byId("rid_group_set").style.display = '';
            document.leftnavform.ridgroupsettoggle.value = "hide";
            dojo.byId("ridcollapse_down_img").style.display = '';
            dojo.byId("ridcollapse_right_img").style.display = 'none';
			isCollapsed = 0;
        }
		var url = "./EndNoteWeb.html?func=setGroupSetState&setGroupSetState="+isCollapsed+"&groupsetId="+id;

		 dojo.xhrGet({
                    url			 : url,
                    preventCache : true,
						  load   : function (data){						 
					},
					error	     : function(response, ioArgs) { 
						 			 console.error(response);
							       }
                    });

    }

	function togglesharedGroupSet() {
        if(document.leftnavform.sharedgroupsettoggle.value == "hide") {
            dojo.byId("sharedDivs").style.display = "none";
            document.leftnavform.sharedgroupsettoggle.value = "show";
            dojo.byId("sharedcollapse_down_img").style.display = "none";
            dojo.byId("sharedcollapse_right_img").style.display = '';
        } else {
            dojo.byId("sharedDivs").style.display = '';
            document.leftnavform.sharedgroupsettoggle.value = "hide";
            dojo.byId("sharedcollapse_down_img").style.display = '';
            dojo.byId("sharedcollapse_right_img").style.display = 'none';
        }
    }
	function initFunction(){
		if(0 == 1){
			if(document.getElementsByName("sharedIndicator")){
				var sharedIndicators = document.getElementsByName("sharedIndicator");
				for(i=0;i<sharedIndicators.length;i++){
					sharedIndicators[i].parentNode.href = "javascript:void(0)";
					sharedIndicators[i].alt = "This group is shared to other EndNote users. Go to manage sharing for this group. (disabled)";
					sharedIndicators[i].title = "This group is shared to other EndNote users. Go to manage sharing for this group. (disabled)";
					sharedIndicators[i].style.cursor = 'default';
				}
			}
		}
	}
	dojo.addOnLoad(initFunction);
</script>
<input type="hidden" name="groupsettoggle" value="hide">
<div class="sideL1 myGroups"><a style="text-decoration: none" href="javascript:void(0)" onclick="toggleGroupSet()">
<img id="collapse_right_img" style="display:none" src="/images/en_us/arrow_right.gif" alt="Click to expand" title="Click to expand">
<img id="collapse_down_img" src="/images/en_us/arrow_down.gif" alt="Click to collapse" title="Click to collapse">
</a>My Groups</div>
<div id="default_group_set"></div>







			<div id="sharedDivs"></div>
<input type="hidden" name="shared_group_time_ms" value="8">
 

<table width="100%" cellspacing="0" cellpadding="0" border="0">
	<tbody><tr>
	<td><a onclick="ga('send', 'event', 'Publons Ad Banner','Click','Publons_Ad');" href="https://publons.com/in/reviewer/?utm_source=EndNote_Online&amp;utm_medium=Nav_promo&amp;utm_campaign=phase_1" target="_blank" rel="noopener"><img width="188" class="sideRID" src="/images/en_us/publons_ad.png" alt="Learn more about Publons " title="Learn more about Publons "></a></td>
	</tr>
</tbody></table>

</form></td>
                        </tr>
                      </tbody></table>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td class="rightbggrey">
	<input type="hidden" name="noOfGroups" value="">

</td>
  </tr>
</tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tbody><tr>
<td align="right"><img src="/images/en_us/spacer.gif" width="11" height="16"></td>
</tr>

</tbody></table>
</form></td>
<!-- end: LeftNav -->
 


<script language="JAVASCRIPT">
var showGettingStartedGuide;
if('0' == '1') {
	showGettingStartedGuide = '';
}
else {
	showGettingStartedGuide = 'show';
}
var showEndnoteState = '1';
dojo.require("dijit._Widget");
dojo.require("dojox.image.Lightbox");
// Displaying the attached files in the dialog box
function changeURL(url,citId,attachFileId){

	this.href= url;
	var index  = (this.href).lastIndexOf('=');
	var type = (this.href).substring(index+1);
	this.target="new_dialog";
	if(type=="file"){
	openFileUploadDialog(url,citId,attachFileId);
	}
	else{
	openFigureUploadDialog(url,citId,attachFileId);
	}
   	return;
}
function  getAttachedFiles(citId, attachFileId){
	document.onselectstart = function() { return false; };
	var currentFolderID = document.summarypage.current_folder_id.value ;
	var dontCreateNew = arguments[2] || 0;
	var userId = "Xk0MeArsC7QAAHnXR0o";
	dojo.xhrGet({
                                url      : "EndNoteWeb.html?func=getAttachmentNames&citId="+citId+"&page=ListView&",
                                handleAs : "json",
								preventCache : true,
                                load     : function (data){
								    var enwebURL = encodeURIComponent("https://www.myendnoteweb.com:443/EndNoteWeb.html?func=cancelUploadDialog");
									var encodeURL = "https://services.myendnoteweb.com/enwservices/fileattachment/multiUploader.jsp?userId="+userId+"&refId="+citId+"&lang=en_us&enweburi="+enwebURL+"&type=file";

										var fileAttachDialogId = "FileAttachmentDlg_"+citId;
										var dispData = ShowAttachedFiles(data,citId,attachFileId);
										var fileAttachmentDialog;
										var node = document.createElement("div");
										dojo.body().appendChild(node);                                     
										var attachFileAnchor = document.createElement("a");
											if(data.usedSpacePercentage >= 100){
												attachFileAnchor.setAttribute("href", "javascript:void(0)");
												attachFileAnchor.setAttribute("disabled", "disabled");
												attachFileAnchor.innerHTML='&nbsp;Attach files';
											}else{
												attachFileAnchor.setAttribute("href", "javascript:void(0)");
												attachFileAnchor.setAttribute("target", "new_dialog");
																						
												attachFileAnchor.onclick = new Function("changeURL('"+ encodeURL+"','"+citId+"','"+attachFileId+"')");
												var last_updated_id="last_updated_"+citId;
												document.getElementById(last_updated_id).innerHTML=" "+data.LAST_UPDATED_DATE;
											}
											attachFileAnchor.setAttribute("alt", 'Click to attach files');
											attachFileAnchor.setAttribute("title", 'Click to attach files');
											attachFileAnchor.innerHTML='&nbsp;Attach files';
										if(dijit.byId(fileAttachDialogId))
										{
											if(dojo.byId("idAttachFiles")){
												    title = "File Attachments ";
													if(currentFolderID == "-1"){

														title = title+"&nbsp;<span id ='idAttachFiles'></span>";

													} else {
                                                    title = title+"&nbsp;<span id ='idAttachFiles' class='folder'><img  src=\"/images/en_us/file_attachment.gif\"/><a href=\"javascript:void(0)\" target=\"new_dialog\" onclick=\"changeURL('"+ encodeURL+"','"+citId+"','"+attachFileId+"')\">Attach files</a></span>";
													}
													dijit.byId(fileAttachDialogId).titleNode.title = "Click to attach files";
													dijit.byId(fileAttachDialogId).titleNode.innerHTML = title;
																			 
											}
											else{
											        title = "File Attachments ";
													if(currentFolderID == "-1"){

														title = title+"&nbsp;<span id ='idAttachFiles'></span>";

													} else {
                                                    title = title+"&nbsp;<span id ='idAttachFiles' class='folder'><img  src=\"/images/en_us/file_attachment.gif\"/><a href=\"javascript:void(0)\" target=\"new_dialog\" onclick=\"changeURL('"+ encodeURL+"','"+citId+"','"+attachFileId+"')\">Attach files</a></span>";
													}
													dijit.byId(fileAttachDialogId).titleNode.title = "Click to attach files";
													dijit.byId(fileAttachDialogId).titleNode.innerHTML = title;
											}
											dispData = '<div style="padding-left: 10px;width: 375px; height: 115px; overflow: auto;">'+ dispData + '</div>';
											dijit.byId(fileAttachDialogId).attr('content',dispData);
											if(dontCreateNew == 0){
											     dijit.byId(fileAttachDialogId).show();
											}
											//dijit.focus(dijit.byId(attachDialogId).domNode);	
											dijit.focus(dojo.byId(fileAttachDialogId));	
											var leftPos = 0, topPos = 0;
											var cords = getPositionCords(attachFileId, fileAttachDialogId);
											leftPos = cords[0];
											topPos = cords[1];
											dojo.style(dijit.byId(fileAttachDialogId).domNode,{left:leftPos+"px",top:topPos+"px"});
											return;
										}else{
											fileAttachmentDialog = new dijit.Dialog({
												title: "File Attachments ",
												style: "background: white;border: 1px dotted black",
												autofocus: false,
												id: fileAttachDialogId,
												onFocus:function(){ fileAttachmentDialog.show(); },
												onBlur:function(){ document.onselectstart = function() { return true; };
												fileAttachmentDialog.hide(); }
											},node);
											//Code to set the title of the closeIcon to "Close"
											if(document.getElementsByClassName){
												var closeIconElements = document.getElementsByClassName("dijitDialogCloseIcon");
												for(i=0;i<closeIconElements.length;i++){
													closeIconElements[i].title = "Close";
												}
											}else{
												var elements = document.getElementsByTagName("span");
												for(i=0;i<elements.length;i++){
													if(elements[i].className == "dijitDialogCloseIcon"){
														elements[i].title = "Close";
													}
												}
											}
											
											var title = fileAttachmentDialog.attr("title");
											if(0 != 1){	
												if(data.usedSpacePercentage >= 100){
													
												}else{
													if(currentFolderID == "-1"){

														title = title+"&nbsp;<span id ='idAttachFiles'></span>";

													} else {
													title = title+"&nbsp;<span id ='idAttachFiles' class='folder'><img  src=\"/images/en_us/file_attachment.gif\"/><a href=\"javascript:void(0)\" target=\"new_dialog\" onclick=\"changeURL('"+ encodeURL+"','"+citId+"','"+attachFileId+"')\">Attach files</a></span>";
													}
													dijit.byId(fileAttachDialogId).titleNode.title = "Click to attach files";
												}
											}else{
												title = title;
											}
											dijit.byId(fileAttachDialogId).titleNode.innerHTML = title;

											dispData = '<div style="padding-left: 10px;width: 375px; height: 115px; overflow: auto;">'+ dispData + '</div>';
											
											fileAttachmentDialog.attr("class","tundra");				fileAttachmentDialog.attr("content", dispData);				
											if(dontCreateNew == 0){
											        fileAttachmentDialog.show();
											}
											dijit.focus(dojo.byId(fileAttachDialogId));	

											var leftPos = 0, topPos = 0;
											var cords = getPositionCords(attachFileId, fileAttachDialogId);
											leftPos = cords[0];
											topPos = cords[1];
											dojo.style(fileAttachmentDialog.domNode,{left:leftPos+"px",top:topPos+"px"});
										}
										var underlayId = fileAttachDialogId+"_underlay";
										if(dontCreateNew == 0){
										if(dojo.isIE){
											var opacity = "0.0";
											document.getElementById(underlayId).style.filter = "alpha(opacity:"+opacity+")";
										}else{
											document.getElementById(underlayId).style.opacity = "0.0";
										}
										}

										if(dijit.byId(fileAttachDialogId)){
											if(!dojo.isIE){
												require(["dojo/_base/connect","dojo/keys","dojo/_base/event"],
													function(connect,keys,event){
														connect.connect(dojo.body(),"onkeypress",this,
															function(e){   
																if (e.charOrCode == keys.ESCAPE){																	
																		fileAttachmentDialog.hide();
																		event.stop(e);
																}
															});
													});
											}
										}
										
								},
                                error      : function(response, ioArgs) {
									window.location.reload(true);
								}
                });

}

function encodedownloadURL(thisTag,downloadURL){
	thisTag.href=downloadURL;
	thisTag.click;
	return true;

}

function ShowAttachedFiles(Data,citId, attachFileId){
		var fileString = "<table >";
		var userId = 'Xk0MeArsC7QAAHnXR0o';
		var removeFileId, fileId, shortFileName;
		var currentFolderID = document.summarypage.current_folder_id.value ;
		
		if (Data.fileNames.length > 0) {
				for (var i=0;i<Data.fileNames.length;i++){
			
					var downloadURL="https://services.myendnoteweb.com/enwservices/fileattachment/downloadAttachment.jsp?guid="+encodeURIComponent(Data.fileNames[i].GUID)+"&fileName="+encodeURIComponent(Data.fileNames[i].fileName)+"&userId="+userId+"&refId="+citId+"&fileNamePlain="+Data.fileNames[i].fileName+"&";
		
					removeFileId = "removeFile_"+i+"_"+citId;
					fileId = "file_"+i+"_"+citId;
					fileString = fileString + "<tr id=\""+fileId+"\" OnMouseOver=\"highlightRow('"+fileId+"','"+removeFileId+"')\" OnMouseOut=\"fadeOutRow('"+fileId+"','"+removeFileId+"')\" onFocus=\"highlightRow('"+fileId+"','"+removeFileId+"')\" onBlur=\"fadeOutRow('"+fileId+"','"+removeFileId+"')\" style=\"margin: 0px; position: static; visibility: visible; display: block;width:100%\"><td><span class='folder'><a href='javascript:void(0)' alt='"+Data.fileNames[i].fileName+"' title='"+Data.fileNames[i].fileName+"' onClick='encodedownloadURL(this,\""+downloadURL+"\");'>"+Data.fileNames[i].shortFileName+"</a></span></td><td>";
					if(0 == 1){
                    fileString +="<span id=\""+removeFileId+"\" style=\"display:none\" class='folder'></span>";
                    }
                    else {                    
                    fileString += "<span id=\""+removeFileId+"\" style=\"display:none\" class='folder'><a href='javascript:void(0)' onclick='return  removeAttachment(\""+Data.fileNames[i].id+"\","+citId+",\""+attachFileId+"\",\"file\");'><img src=\"/images/en_us/remove_file.gif\" alt=\"Delete File\" title=\"Delete File\"/></a></span>";
                  }

                    fileString += "</td></tr>";
			}
			
			var attachFileId = document.getElementById("fileAttach_"+citId);

			attachFileId.setAttribute("src", '/images/en_us'+'/file_attachment.gif');

		}else{
			fileString = "<tr><td colspan='2'><span class='folder'>No Files Attached</span></td></tr>"

			var attachFileId = document.getElementById("fileAttach_"+citId);

			attachFileId.setAttribute("src", '/images/en_us'+'/file_attachment_empty.gif');

		}
		fileString = fileString+"</table>";
		return fileString;
}

function highlightRow(fileId, removeDivId, previewFigureId){
	if(document.getElementById(fileId)){
		document.getElementById(fileId).style.backgroundColor = '#e2ebf2';
	}
	if(document.getElementById(removeDivId)){
		document.getElementById(removeDivId).style.display = "inline";
	}
	if(document.getElementById(previewFigureId)){
		document.getElementById(previewFigureId).style.display = "inline";
	}
}

function fadeOutRow(fileId, removeDivId, previewFigureId){
    if(document.getElementById(fileId)){
		document.getElementById(fileId).style.backgroundColor = '#FFFFFF';
	}
	if(document.getElementById(removeDivId)){
		/*setTimeout(function(){
			document.getElementById(removeDivId).style.display = "none";}
			,1000);*/
		document.getElementById(removeDivId).style.display = "none";
	}
	if(document.getElementById(previewFigureId)){
		document.getElementById(previewFigureId).style.display = "none";
	}
}



function removeAttachment(metaDataId,citId, attachId,attachmentType){
		
	var message;
	if(attachmentType=="file"){
		message = "Are you sure you want to permanently delete the file attachment?\n\nDeleting the file attachment will permanently remove it from your \nlibrary. It will not appear in the trash.\n\nThis action cannot be undone.";
	}else{ 
		message = "Are you sure you want to permanently delete the figure attachment?\n\nDeleting the figure attachment will permanently remove it from your library. It will not appear in the trash.\n\nThis action cannot be undone.";
	}
	if(confirm(message)){
		dojo.xhrGet({
			url      : "EndNoteWeb.html?func=deleteAttachments&ids="+metaDataId+"&",
			handleAs : "json",
		    preventCache : true,
			load     : function (data){
							if (data.isError) {
								alert(data.errorMessage);
							}else{
								if(attachmentType=="file"){
									getAttachedFiles(citId, attachId);
								}else{
									getAttachedFigure(citId, attachId);
								}
							}
						},
			error	: function(response, ioArgs) { 
						   //alert(response);
						   window.location.reload(true);
						}
		});
	}else{
		return false;
	}
}

var fileUploadDlg;
function createFileUploadDialog(url,citId, attachFileId) {
	var node = document.createElement("div");
	dojo.body().appendChild(node);
	fileUploadDlg = new dijit.Dialog({
		id: "fileUploadDialog",
		title: "Upload File Attachments",
		style: "background: white;border: 1px dotted black",
		onHide: dojo.hitch(this, function(){
			        dijit.byId("fileUploadDialog").destroyRecursive();
					if(citId == undefined){
					  getAttachmentNames();
					}else{
					  var dontCreateNew = 1;
					  getAttachedFiles(citId, attachFileId, dontCreateNew);
					}
				}),
		content: "<iframe  name='new_dialog' style='width:600px; height:450px;'src='"+url+"' ></iframe>",
		draggable:false
	}, node);
	fileUploadDlg.attr("class","tundra");
	//Escape Key handler for Safari browser
    if(dojo.isSafari){
	dojo.connect(dojo.byId('fileUploadDialog'), "onkeydown", this, function(evt){
		if(evt.keyCode == dojo.keys.ESCAPE){
			fileUploadDlg.hide();
			dojo.stopEvent(evt);
		}
	});
    }

}

function closeUploadDialog(fileType){
   
   if(fileType == 'file'){
      dijit.byId("fileUploadDialog").hide(); 
   }else{
      dijit.byId("figureUploadDialog").hide(); 
   }
}

function openFileUploadDialog(url,citId, attachFileId){
	createFileUploadDialog(url,citId, attachFileId);
	fileUploadDlg.show();
	document.getElementById("fileUploadDialog_underlay").style.opacity = 0.3;
	document.getElementById("fileUploadDialog_underlay").style.background = "#333";

}



// Displaying the attached figures in the dialog box
function  getAttachedFigure(citId, attachFigureId){
	document.onselectstart = function() { return false; };
	var dontCreateNew = arguments[2] || 0;
	var currentFolderID = document.summarypage.current_folder_id.value ;
	var userId = "Xk0MeArsC7QAAHnXR0o";
	dojo.xhrGet({
                                url      : "EndNoteWeb.html?func=getAttachmentNames&citId="+citId+"&page=ListView&",
                                handleAs : "json",
								preventCache : true,
                                load     : function (data){
					 				  var enwebURL = encodeURIComponent("https://www.myendnoteweb.com:443/EndNoteWeb.html?func=cancelUploadDialog");
                                      var encodeURL = "https://services.myendnoteweb.com/enwservices/fileattachment/multiUploader.jsp?userId="+userId+"&refId="+citId+"&lang=en_us&enweburi="+enwebURL+"&type=figure";
										var figureAttachDialogId = "FigureAttachmentDlg_"+citId;
										var dispData = ShowAttachedFigure(data,citId,attachFigureId);
										var figureAttachmentDialog;
										var node = document.createElement("div");
										dojo.body().appendChild(node);
										var attachFigureAnchor = document.createElement("a");
										  if(data.usedSpacePercentage >= 100){
											attachFigureAnchor.setAttribute("href", "javascript:void(0)");
											attachFigureAnchor.setAttribute("disabled", "disabled");
											attachFigureAnchor.innerHTML='&nbsp;Attach figure';
										  }else{
											attachFigureAnchor.setAttribute("href", "javascript:void(0)");
											attachFigureAnchor.setAttribute("target", "new_dialog");
											attachFigureAnchor.onclick = new Function("changeURL('"+ encodeURL+"','"+citId+"','"+attachFigureId+"')");
											var last_updated_id="last_updated_"+citId;
											document.getElementById(last_updated_id).innerHTML=" "+data.LAST_UPDATED_DATE;											
										  }
										  attachFigureAnchor.setAttribute("alt", 'Click to attach figure');
										  attachFigureAnchor.setAttribute("title", 'Click to attach figure');
										  attachFigureAnchor.innerHTML='&nbsp;Attach figure';
										if(dijit.byId(figureAttachDialogId))
										{
											if(dojo.byId("idAttachFigures")){
												  title = "Figure Attachment";
												if(currentFolderID == "-1"){

														title = title+"&nbsp;<span id ='idAttachFigures'></span>";

													} else {
                                                  title = title+"&nbsp;<span id='idAttachFigures' class='folder'><img  src=\"/images/en_us/figure_attachment.gif\"/><a href=\"javascript:void(0)\" target=\"new_dialog\" onclick=\"changeURL('"+ encodeURL+"','"+citId+"','"+attachFigureId+"')\">&nbsp;Attach figure</a></span>";
													}			
												  dijit.byId(figureAttachDialogId).titleNode.title = "Click to attach figure";
												 dijit.byId(figureAttachDialogId).titleNode.innerHTML = title;								 
											  
											}
											else{
												    title = "Figure Attachment";
													if(currentFolderID == "-1"){

														title = title+"&nbsp;<span id ='idAttachFigures'></span>";

													} else {
                                                    title = title+"&nbsp;<span id='idAttachFigures' class='folder'><img  src=\"/images/en_us/figure_attachment.gif\"/><a href=\"javascript:void(0)\" target=\"new_dialog\" onclick=\"changeURL('"+ encodeURL+"','"+citId+"','"+attachFigureId+"')\">&nbsp;Attach figure</a></span>";
													}
													dijit.byId(figureAttachDialogId).titleNode.title =  "Click to attach figure";
													dijit.byId(figureAttachDialogId).titleNode.innerHTML = title;
											}
											dispData = '<div style="padding-left: 10px;width: 510px; height: 115px; overflow: auto;">'+ dispData + '</div>';
											try{
												dojo.parser.parse(dispData);
											}catch(e){
												//alert(e);
											};
											
											dijit.byId(figureAttachDialogId).attr('content',dispData);	if(dontCreateNew == 0){
											   dijit.byId(figureAttachDialogId).show();
											}
											dijit.focus(dojo.byId(figureAttachDialogId));	

											var leftPos = 0, topPos = 0;
											var cords = getPositionCords(attachFigureId, figureAttachDialogId);									leftPos = cords[0];
											topPos = cords[1];
											dojo.style(dijit.byId(figureAttachDialogId).domNode,{left:leftPos+"px",top:topPos+"px"});
											return;
										}else{
											figureAttachmentDialog = new dijit.Dialog({
												title: "Figure Attachment",
												style: "background: white;border: 1px dotted black",
												autofocus: false,
												id: figureAttachDialogId,
												onFocus:function(){ figureAttachmentDialog.show(); },
												onBlur:function(){ document.onselectstart = function() { return true; };
												figureAttachmentDialog.hide(); }
											},node);

											//Code to set the title of the closeIcon to "Close"
											if(document.getElementsByClassName){
												var closeIconElements = document.getElementsByClassName("dijitDialogCloseIcon");
												for(i=0;i<closeIconElements.length;i++){
													closeIconElements[i].title = "Close";
												}
											}else{
												var elements = document.getElementsByTagName("span");
												for(i=0;i<elements.length;i++){
													if(elements[i].className == "dijitDialogCloseIcon"){
														elements[i].title = "Close";
													}
												}
											}
											
											var title = figureAttachmentDialog.attr("title");
											if(0 != 1){	
												if(data.usedSpacePercentage >= 100){
												
												}else{
													if(currentFolderID == "-1"){

														title = title+"&nbsp;<span id ='idAttachFigures'></span>";

													} else {
													title = title+"&nbsp;<span id='idAttachFigures' class='folder'><img  src=\"/images/en_us/figure_attachment.gif\"/><a href=\"javascript:void(0)\" target=\"new_dialog\" onclick=\"changeURL('"+ encodeURL+"','"+citId+"','"+attachFigureId+"')\">&nbsp;Attach figure</a></span>";
													}
													dijit.byId(figureAttachDialogId).titleNode.title = "Click to attach figure";
												}
											}else{
												title = title;
											}
											//figureAttachmentDialog.attr("title",title);	
											
											dijit.byId(figureAttachDialogId).titleNode.innerHTML = title;
											
											dispData = '<div style="padding-left: 10px;width: 510px; height: 115px; overflow: auto;">'+ dispData + '</div>';

											try{
												dojo.parser.parse(dispData);
											}catch(e){
											//	alert(e);
											};
											
											figureAttachmentDialog.attr("class","tundra");
											figureAttachmentDialog.attr("content", dispData);
											if(dontCreateNew == 0){
											     figureAttachmentDialog.show();
											}
											dijit.focus(dojo.byId(figureAttachDialogId));	

											var leftPos = 0, topPos = 0;
											var cords = getPositionCords(attachFigureId, figureAttachDialogId);
											leftPos = cords[0];
											topPos = cords[1];
											dojo.style(figureAttachmentDialog.domNode,{left:leftPos+"px",top:topPos+"px"});
										}
										var underlayId = figureAttachDialogId+"_underlay";
										if(dontCreateNew == 0){
										if(dojo.isIE){
											var opacity = "0.0";
											document.getElementById(underlayId).style.filter = "alpha(opacity:"+opacity+")";
										}else{
											document.getElementById(underlayId).style.opacity = "0.0";
										}
										}

										if(dijit.byId(figureAttachDialogId)){
												if(!dojo.isIE){
												require(["dojo/_base/connect","dojo/keys","dojo/_base/event"],
													function(connect,keys,event){
														connect.connect(dojo.body(),"onkeypress",this,
															function(e){   
																if (e.charOrCode == keys.ESCAPE){																	
																		figureAttachmentDialog.hide();
																		event.stop(e);
																}
															});
													});
											}
										}

										//Set the height and width of the figure preview pop-up
										if(dijit.byId(figureAttachDialogId)){
											if(dijit.byId("dojoxLightboxDialog")){
												if(document.getElementsByClassName){
													var lightBoxElements = document.getElementsByClassName("dojoxLightboxImage");
													for(i=0;i<lightBoxElements.length;i++){
														lightBoxElements[i].height=450;
														lightBoxElements[i].width=450;
													}
												}else{
													var lightBoxElements = document.getElementsByTagName("img");
													for(i=0;i<lightBoxElements.length;i++){
														if(lightBoxElements[i].className == "dojoxLightboxImage"){
															lightBoxElements[i].height=450;
															lightBoxElements[i].width=450;
														}
													}
												}
											}			
										}
								},
                                error      : function(response, ioArgs) {
									window.location.reload(true);
								}
                });

}

function ShowAttachedFigure(Data,citId, attachFigureId){
		var figureString = "<table >";
		var userId = 'Xk0MeArsC7QAAHnXR0o';
		var removeFigureId, figureId, previewFigureId;
		var currentFolderID = document.summarypage.current_folder_id.value ; 
		
		if (Data.figureNames.length > 0) {
			for (var i=0;i<Data.figureNames.length;i++){
				var downloadURL="https://services.myendnoteweb.com/enwservices/fileattachment/downloadAttachment.jsp?guid="+encodeURIComponent(Data.figureNames[i].GUID)+"&fileName="+encodeURIComponent(	Data.figureNames[i].fileName)+"&userId="+userId+"&refId="+citId+"&fileNamePlain="+Data.figureNames[i].fileName+"&";
				removeFigureId = "removeFigure_"+i+"_"+citId;
				figureId = "figure_"+i+"_"+citId;
				previewFigureId = "preview_"+i+"_"+citId;
				figureString = figureString + "<tr id=\""+figureId+"\" OnMouseOver=\"highlightRow('"+figureId+"','"+removeFigureId+"','"+previewFigureId+"')\" OnMouseOut=\"fadeOutRow('"+figureId+"','"+removeFigureId+"','"+previewFigureId+"')\" onFocus=\"highlightRow('"+figureId+"','"+removeFigureId+"','"+previewFigureId+"')\" onBlur=\"fadeOutRow('"+figureId+"','"+removeFigureId+"','"+previewFigureId+"')\" style=\"margin: 0px; position: static; visibility: visible; display: block;width:100%\"><td><span class='folder'><a href='javascript:void(0)'  title='"+Data.figureNames[i].fileName+"' onClick='encodedownloadURL(this,\""+downloadURL+"\");'>"+Data.figureNames[i].shortFigureName+"</a></span></td><td><span id=\""+previewFigureId+"\" style=\"display:none\" class='folder'>";
                var patt = /\.(tiff|tif)$/;
                var fileNameStr = Data.figureNames[i].fileName;
                if(fileNameStr.match(patt)){        
                    figureString += "<a href='javascript:void(0)' onclick='alert(\"Sorry, we are unable to provide a preview for this type of image\")' title='"+Data.figureNames[i].fileName+"'><span title=\"Preview\" alt=\"Preview\">Preview</span></a>";
                }else{
                    figureString += "<a href=\"https://services.myendnoteweb.com/enwservices/fileattachment/downloadAttachment.jsp?guid="+encodeURIComponent(Data.figureNames[i].GUID)+"&fileName="+encodeURIComponent(   Data.figureNames[i].fileName)+"&userId="+userId+"&refId="+citId+"&fileNamePlain="+Data.figureNames[i].fileName+"&fileType="+Data.figureNames[i].fileType+"\"  dojoType=\"dojox.image.Lightbox\" title='"+Data.figureNames[i].fileName+"'><span title=\"Preview\" alt=\"Preview\">Preview</span></a>";
                }
                if(0 == 1) {
                   figureString += "</td><td><span id=\""+removeFigureId+"\" style=\"display:none\" class='folder'>" ;
                }
                else {
                figureString += "</span></td><td><span id=\""+removeFigureId+"\" style=\"display:none\" class='folder'><a href='javascript:void(0)' onclick='return removeAttachment(\""+Data.figureNames[i].id+"\","+citId+",\""+attachFigureId+"\",\"figure\");'><img src=\"/images/en_us/remove_file.gif\" alt=\"Delete Figure\" title=\"Delete Figure\"/></a></span>" ;
                }

                figureString += "</td></tr>";
				}
			
				var attachFigureId = document.getElementById("figureAttach_"+citId);
			
			attachFigureId.setAttribute("src", '/images/en_us'+'/figure_attachment.gif');

		}else{
			figureString = "<tr><td colspan='2'><span class='folder'>No Figure Attached</span></td></tr>"

			var attachFigureId = document.getElementById("figureAttach_"+citId);

			attachFigureId.setAttribute("src", '/images/en_us'+'/figure_attachment_empty.gif');
		}
		figureString = figureString+"</table>";
		return figureString;
}

var figureUploadDialog;
function createFigureUploadDialog(url,citId, attachFigureId) {
	
	var node = document.createElement("div");
	dojo.body().appendChild(node);
	figureUploadDialog = new dijit.Dialog({
		id: "figureUploadDialog",
		title: "Upload Figure Attachment",
		style: "background: white;border: 1px dotted black",
		onHide: dojo.hitch(this, function(){
			        dijit.byId("figureUploadDialog").destroyRecursive();
					if(citId == undefined){
						getAttachmentNames();
					}else{
						var dontCreateNew = 1;
						getAttachedFigure(citId, attachFigureId, dontCreateNew);
					}
				}),
		content: "<iframe  name='new_dialog' style='width:600px; height:270px;' src='"+url+"'></iframe>",
		draggable:false
	}, node);
	figureUploadDialog.attr("class","tundra");
	//Escape Key handler for Safari browser
    if(dojo.isSafari){
	dojo.connect(dojo.byId('figureUploadDialog'), "onkeydown", this, function(evt){
		if(evt.keyCode == dojo.keys.ESCAPE){
			figureUploadDialog.hide();
			dojo.stopEvent(evt);
		}
	});
    }

}

function openFigureUploadDialog(url,citId, attachFigureId){
	createFigureUploadDialog(url,citId, attachFigureId);
	figureUploadDialog.show();
	document.getElementById("figureUploadDialog_underlay").style.opacity = 0.3;
	document.getElementById("figureUploadDialog_underlay").style.background = "#333";
}

function  getGroupNames(citId, imageId){
	document.onselectstart = function() { return false; };
	var url = "EndNoteWeb.html?func=getGroupNames&citId="+citId;
	dojo.xhrGet({
					url      : url,
                    handleAs: 'text',
                    preventCache : true,
					sync     : true,
                    load     : function (data){
								var groupNameDialog;
								var node = document.createElement("div");
								dojo.body().appendChild(node);
								var dialogId = "grpNameDlg_"+citId;
						        //Creating the dialog to display the group names
								if(dijit.byId(dialogId)){
									data = '<div style="padding-left: 10px;width: 375px; height: 115px; overflow: auto;">'+ data + '</div>';
									dijit.byId(dialogId).attr('content',data);
									dijit.byId(dialogId).show();
									var leftPos = 0, topPos = 0;
									var cords = getPositionCords(imageId, dialogId);
									leftPos = cords[0];
									topPos = cords[1];
									dojo.style(dijit.byId(dialogId).domNode,{left:leftPos+"px",top:topPos+"px"});
									return;
								}else{
									groupNameDialog = new dijit.Dialog({
										title: "Group Names",
								        style: "background: white;border: 1px dotted black",
										id: dialogId,
										onFocus:function(){ groupNameDialog.show(); },
										onBlur:function(){ document.onselectstart = function() { return true; };
										groupNameDialog.hide(); }
									},node);

									//Code to set the title of the closeIcon to "Close"
									if(document.getElementsByClassName){
										var closeIconElements = document.getElementsByClassName("dijitDialogCloseIcon");
										for(i=0;i<closeIconElements.length;i++){
											closeIconElements[i].title = "Close";
										}
									}else{
										var elements = document.getElementsByTagName("span");
										for(i=0;i<elements.length;i++){
											if(elements[i].className == "dijitDialogCloseIcon"){
												elements[i].title = "Close";
											}
										}
									}

									data = '<div style="padding-left: 10px;width: 375px; height: 115px; overflow: auto;">'+ data + '</div>';
								    //Set the group names as the content of the dialog
									groupNameDialog.attr("class","tundra");
									groupNameDialog.attr("content", data);
									groupNameDialog.show();
									var leftPos = 0, topPos = 0;
									var cords = getPositionCords(imageId, dialogId);
									leftPos = cords[0];
									topPos = cords[1];
									dojo.style(groupNameDialog.domNode,{left:leftPos+"px",top:topPos+"px"});
								}
								var underlayId = dialogId+"_underlay";
								if(dojo.isIE){
									var opacity = "0.0";
									document.getElementById(underlayId).style.filter = "alpha(opacity:"+opacity+")";
								}else{
									document.getElementById(underlayId).style.opacity = "0.0";
								}

								if(dojo.isSafari){
									dojo.connect(dojo.byId(groupNameDialog.attr("id")), "onkeydown", this, function(evt){
									if(evt.keyCode == dojo.keys.ESCAPE){
										groupNameDialog.hide();
										dojo.stopEvent(evt);
									}
									});
								}
							   },
				error	: citationErrorHandler
			});
}

function getPositionCords(imageId, dialogId){
	var position = dojo.position(imageId,true);
	var xCor = Math.ceil(position.x);
	var yCor = Math.ceil(position.y);
	var imageCords = dojo.position(dojo.byId(imageId),false);
	var dialogCords = dojo.coords(dialogId);
	var dialogHeight = dialogCords.h;
	var clientHeight = getClientHeight();
	if( imageCords.y + dialogHeight >= clientHeight){
		yCor = yCor - dialogHeight;
	}else{
		yCor = yCor + 15;
	}
	var coords = new Array();
	coords[0] = xCor;
	coords[1] = yCor;
	return coords;
}

function getClientHeight(){
	var myHeight = 0;
	if( typeof( window.innerWidth ) == 'number' ) {
		myHeight = window.innerHeight;
	} else if( document.documentElement && document.documentElement.clientHeight) {
		myHeight = document.documentElement.clientHeight;
	} else if( document.body && document.body.clientHeight) {
		myHeight = document.body.clientHeight;
	}
	return myHeight;
}

function getGettingStartedStatus()
{
	dojo.xhrGet({
		 url      : "EndNoteWeb.html?func=getGuideState",
		 preventCache : true,
		 load     : function (data){
					data = data.replace(/\s+$/g,'');	
					if(data != "")
						showGettingStartedGuide = data;
					},
		 error	: function(response, ioArgs) { 
//					alert('Error while updating data to the server! ');
//					console.error(response);
					window.location.reload(true);					
				 }
	});
}

function changeNumberPerPage(noPerPage,position){
	dojo.xhrGet({
                    url      : "EndNoteWeb.html?func=chgnumresultsperpage&RecordsPerSummary="+noPerPage+"&",
                    handleAs: 'json',
                    preventCache : true,
                    load     : function (data){
									   if (position == 'top') {
										  document.summarypage.BottomRecordsPerSummary.value=noPerPage;
									   }else{
										   document.summarypage.TopRecordsPerSummary.value=noPerPage;
									   }
									    loadCitations(1, noPerPage, document.summarypage.current_folder_id.value,document.summarypage.pguid.value);
                               },
					error	: function(response, ioArgs) { 
//									alert('Error while updating data to the server! ');
//									console.error(response);
									window.location.reload(true);
							}
					});
}
if (document.addEventListener) {
    document.addEventListener("click", setCheckedValues, false);
}
else if(document.attachEvent){
    document.attachEvent("onclick", setCheckedValues);
}
else {
	window.onload = setCheckedValues;
}


function setCheckedValues(e) {
        var element;
		if (typeof e.target != 'undefined'){
			element = e.target;
		}
		else{
			element = e.srcElement;
		}
        var ids = document.getElementsByTagName('input');		
        if (element.id === 'idCheckAllRef') {
            var state = element.checked;   
			for	(var i=0; i<ids.length; i++) {
				if(ids[i].getAttribute('type') == 'checkbox' && ids[i].getAttribute('name') == "ids") {
					ids[i].checked = state;
				}
			}
			if(state == false) {
	            document.summarypage.checkall.value = 0;
			}
			document.summarypage.CheckPage.checked = false;
		}
		else if(element.id === 'idCheckPage') {
			var state = element.checked;                 
			for	(var i=0; i<ids.length; i++) {
				if(ids[i].getAttribute('type') == 'checkbox' && ids[i].getAttribute('name') == "ids") {
					ids[i].checked = state;
				}
			}
			document.summarypage.CheckAllRef.checked = false;
			document.summarypage.checkall.value = 0;
		}
		else if(element.name === 'ids') {
			if(document.summarypage.CheckAllRef.checked == true) {
				document.summarypage.CheckAllRef.checked = false;
				document.summarypage.checkall.value =1;
			}			
			document.summarypage.CheckPage.checked = false;			
        }

}


//function checkAll(myForm,name)
// {
//	alert("in checkAll");
//  if(myForm.CheckAllRef.checked)
//  {
//	if(myForm.CheckPage.checked)
//	{
//		myForm.CheckPage.checked = false;
//	}
//  }
//
//   if (myForm.CheckAllRef.checked )
//      state = true;
//   else 
//	  state = false;
//
//    var idsArr = document.getElementsByTagName("input");
//    for(var i=0; i<idsArr.length; i++){
//        if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == name){
//            idsArr[i].checked = state;
//        }
//    }
//        
//    if(state == true)
//	 myForm.checkall.value =1;
//	 else 
//	 myForm.checkall.value=0;
//    return false; 
// }
//
//
////end of check all
//
//function checkPage(frm,name,state){
//	alert("in checkPage");
//    var i;
//    for (i=0; i < frm.elements.length; i++) {
//        if(frm.elements[i].name == name) {
//            frm.elements[i].checked = state;
//        }
//    }
//    return false;
//}
//
//function checkPagefolview(frm, name){
//	alert("in checkPagefolview");
//  	var state = false;
// 	if(frm.CheckPage.checked)
//  	{	
//		state = true;
//		if(frm.CheckAllRef.checked)
//		{
//			frm.CheckAllRef.checked = false;
//			frm.checkall.value = 1;
//			checkAll(frm,name);
//		}
//			frm.checkall.value = 0;
//  	}
//
//    var idsArr = document.getElementsByTagName("input");
//    for(var i=0; i<idsArr.length; i++){
//        if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == name){
//            idsArr[i].checked = state;
//        }
//    }
//    return false;
//}


//end of checkpage

function changeFoldersNav(currentFolderId,currentFolderName)
 {
   //var folderName=currentFolderName.replace(/^(.*?)[\-\*]\s+(.+)$/,"$2");
  document.leftnavform.action = document.leftnavform.action + "?func=changeFoldersNav&currentFolderId=" + currentFolderId + "&searchItem=&";
   document.leftnavform.method = "post";
   //document.leftnavform.currentFolderName.value=folderName;
   document.leftnavform.submit();
 }

function listSharedGroup(currentFolderId)
{
   	document.leftnavform.action = document.leftnavform.action + "?func=listSharedGroup&currentFolderId=" + currentFolderId + "&searchItem=&";
	document.leftnavform.method = "post";
   	document.leftnavform.submit();
}

 //end of changefolders
function confirmDeleteForTrash(myForm,type,chkIdStr){
	var currentFolderId=document.summarypage.current_folder_id.value;
	var idsArr = document.getElementsByTagName("input");
	var flag =0;
	if (currentFolderId == -1) {
		if(chkIdStr == undefined)
		{
			if (myForm.CheckAllRef.checked || myForm.idCheckPage.checked ) {
				if(parseInt(document.getElementById('idPageCount').innerHTML) == 1 || myForm.idCheckPage.checked ) {
						if(type=='restore') {
							  if(confirm("Are you sure you want to permanently restore the selected reference(s)? ")){
										changeFolders(myForm,chkIdStr);
							   }else{
									   return false;
							   }
						}else{
							   if(confirm("Are you sure you want to permanently delete the selected reference(s)? ")){
										passFolderId(myForm,type,chkIdStr);
							   }else{
									   return false;
							   }
						}

					}else{
						 if(type=='restore') {
							  if(confirm("WARNING: References are selected on other pages in this group. Are you sure you want to permanently restore the selected reference(s)?")){
									 changeFolders(myForm,chkIdStr);
							   }else{
									 return false;
							   }
						 }else{
							    if(confirm("WARNING: References are selected on other pages in this group. Are you sure you want to permanently delete the selected reference(s)?")){
									  passFolderId(myForm,type,chkIdStr);
							   }else{
									  return false;
							   }
						  }
					}
					}else{

					for(var i=0; i<idsArr.length; i++){
						if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
							if(idsArr[i].checked){
								flag=1;
							}
						}
					}
					if(flag == 0)
						{
						     if(type=='restore')
							   {
								alert("Please check one or more references then click 'Restore'.");
									return false; 
                               } else {
								alert("Please check one or more references then click 'Delete'.");
									return false; 
                               }
						}
					if(flag == 1){
						     if(type=='restore')
							   {
								  if(confirm("Are you sure you want to permanently restore the selected reference(s)? ")){
										   changeFolders(myForm,chkIdStr);
									   }else{
											   return false;
									   }
					   }else
					   {
								if(confirm("Are you sure you want to permanently delete the selected reference(s)? ")){
										passFolderId(myForm,type,chkIdStr);
								}else{
										return false;
								}
					   }

					}else{	
							 if(type=='restore')
						  {
								   changeFolders(myForm,chkIdStr);
						   }else
						   {
								   passFolderId(myForm,type,chkIdStr);
						  }

					}
			}
		}else{
					passFolderId(myForm,type,chkIdStr);
		}
	}else{
		if(chkIdStr == undefined)
		{
			if (myForm.CheckAllRef.checked) {
				if(parseInt(document.getElementById('idPageCount').innerHTML) == 1) {
						 if(confirm("Are you sure you want to delete the selected reference(s)? ")){
								passFolderId(myForm,type,chkIdStr);
						 }else{
								return false;
					 }			
				}else{
						 if(confirm("WARNING: References are selected on other pages in this group. Are you sure you want to delete the selected reference(s)?")){
								passFolderId(myForm,type,chkIdStr);
						 }else{
								return false;
						 }
			  }
			}else{
				passFolderId(myForm,type,chkIdStr);
			}
		}else
		{
			passFolderId(myForm,type,chkIdStr);
		}
    }
	
 }
 function passFolderId(myForm,type,chkIdStr)
 {
	 if(type!='restore')
	{
	  document.getElementById('delete_progress_indicator_container').style.display = "inline";
	}
	var checkedAll =0;
	var isQuickSearch = 0;
	var allChkIdStr='';
	var QuickSearch = document.citationSearchForm.search_item;
	if ((QuickSearch != null) && (QuickSearch.value.length >0)) {
			isQuickSearch = 1;
	}
 if (chkIdStr == undefined || chkIdStr == "") {
	if((myForm.CheckAllRef.checked || myForm.checkall.value == 1) ||(myForm.CheckPage.checked && '0' == '1' && currentFolderId != 'EL')) {
		if(myForm.CheckAllRef.checked || myForm.checkall.value == 1 ) {
			checkedAll=1;
		}
		if (isQuickSearch && ('0' == '0')) {
			allChkIdStr = document.summarypage.citation_ids.value;
			checkedAll = 0;
		}
		var allChkIdStr;
		var allIds;
		if('0' == '0') {
			allChkIdStr = document.summarypage.citation_ids.value;
			allIds = allChkIdStr.split(" ");
		}
   		var idsArr = document.getElementsByTagName("input");
   		var unchkIds = new Array();
		for(var i=0; i<idsArr.length; i++){
			if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
				if(!idsArr[i].checked){
				unchkIds.push(idsArr[i].getAttribute("value"));
				}	
			}
		}
		if (isQuickSearch && '0' == '0') {
			if (unchkIds.length > 0) {
				var newres = new Array();
				var allIds = allChkIdStr.split(" ");
				var matched =0;
				for (var i=0; i <allIds.length ; i++){
					matched =0;
					for( var j=0; j< unchkIds.length; j++){
						if (allIds[i] == unchkIds[j]){
							matched = 1;
							break;
						}
					}
					if (matched ==0) {
						newres.push(allIds[i]);
					}
				}
				chkIdStr = newres.join(' ');
			}else{
			chkIdStr = allChkIdStr;
			}
		}else{
		chkIdStr = unchkIds.join(' ');
		}
	}else{
		var idsArr = document.getElementsByTagName("input");
		var chkIds = new Array();
		for(var i=0; i<idsArr.length; i++){
			if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
				if(idsArr[i].checked){
					chkIds.push(idsArr[i].getAttribute("value"));
				}	
			}
		}
		chkIdStr = chkIds.join(' '); 
		if ('0' == '1' && chkIdStr == '') {
				document.getElementById('delete_progress_indicator_container').style.display = "none";
				alert("Please check one or more references then click 'Delete'.");
				return false;
			}
	}
	if (chkIdStr == '' && checkedAll !=1 && '0' == '0') {
					document.getElementById('delete_progress_indicator_container').style.display = "none";
					alert("Please check one or more references then click 'Delete'.");
							return false;		 
				  
	}
 }

	var currentFolderId=document.summarypage.current_folder_id.value;
 	if (currentFolderId == -1 && chkIdStr == undefined){
		if(!myForm.CheckAllRef.checked ) {
			if(!confirm("Are you sure you want to permanently delete the selected reference(s)? ")) {
				return false;
			}
		}
	}
	//currentFolderId = currentFolderId.replace(/_/g,":");
	currentFolderId = currentFolderId.replace(/_([^_]*)$/, ":" + "$1");
	var dojoUrl;
	if (type == 'fromGroup') {
		dojoUrl="EndNoteWeb.html?func=removefromgroup&currentFolderId=" + currentFolderId;
	}else{
		dojoUrl="EndNoteWeb.html?func=MoveToTrash&currentFolderId=" + currentFolderId;
	}
    if('0' == '1') {
		var pguid=document.summarypage.pguid.value;
		dojoUrl += "&pguid="+pguid;
		if (isQuickSearch) {
			dojoUrl += "&QuickSearch=1&string="+QuickSearch.value;
		}
		if(myForm.CheckPage != undefined && myForm.CheckPage.checked && currentFolderId != 'EL') {
			var page_no = document.summarypage.PageNum.value;
			if(document.getElementById("idSortField").value) {
				dojoUrl += "&sortField="+document.getElementById("idSortField").value+"&sortOrder="+document.getElementById("idSortOrder").value;
			}
			dojoUrl += "&checkedPage=1&page="+page_no;			
		} 
	}
	
	if(checkedAll ==  1) {
		dojoUrl +="&checkedAll="+checkedAll;
		document.summarypage.checkall.value = 0;
	}
	dojo.xhrPost({
                    url      : dojoUrl,
                    handleAs: 'json',
                    preventCache : true,
                    load     : function (data){
						if(data.errcode){
											if(data.errcode == -1){

											document.getElementById("displayErrorMsg").childNodes[0].innerHTML=data.errtext;
											document.getElementById("displayErrorMsg").style.display = "inline";	document.getElementById('delete_progress_indicator_container').style.display = "none";

											}
										}
										else{
										if (!isQuickSearch && currentFolderId != 'EL') {											
											if (document.getElementById("count"+currentFolderId)) {
											document.getElementById("count"+currentFolderId).innerHTML = data;
											}
											
										}
										noPerPage = document.summarypage.TopRecordsPerSummary.value;
										loadCitations(1, noPerPage, currentFolderId,pguid);			
										}	
                               },
                    content: {'ids':chkIdStr},
					error	: function(response, ioArgs) { 
//										alert('Error while updating data to the server! ');
//										console.error(response);
										window.location.reload(true);
								}
					});
	var divId = "idAddToGroup_listView";
	if(document.getElementById('idViewCitation').style.display == "inline")
		divId = "idAddToGroup_view";
   
 	var thisSelect = document.getElementById(divId);
	if(thisSelect != null)
		thisSelect.options[0].selected=true;
		return false;
 }

function verifyCheckedAllDelete(frm)
{
   var success = false;
   var pageCount = 1
                         if(frm != null){
                          if(frm.checkall.value != 1 || (frm.checkall.value == 1 && pageCount == 1))
                                   {
          //document.getElementById('progress_indicator_image').style.display = "inline";
          document.getElementById('delete_progress_indicator_container').style.display = "inline";
                                                   success = true;
                                            
                                                                                 
                                         
                                   }
                                   else{
                                           if(confirm("WARNING: References are selected on other pages in this group. Are you sure you want to delete the selected reference(s)?"))
                                           {
          //document.getElementById('progress_indicator_image').style.display = "inline";
          document.getElementById('delete_progress_indicator_container').style.display = "inline";
                                                   success = true;
                                           } else {
                                           success = false;
                                           }
                                   }
                          }
    return success;
}

function verifyCheckedAllRemove(frm){ 
    var success = false; 
    if(frm != null) {
        if(confirm("Are you sure you want to remove the selected reference(s) from this group?")) {
            success = true;
        } else {
            success = false;
        }
    }
    return success;
}

function verifyCheckedAll(frm,name){
	var i;
    var success = false;

				for (i=0; i < frm.elements.length; i++) {
					if(frm.elements[i].name == name) {
					if(frm.elements[i].checked) {
						  success = true;
					}
					}
				 }		

		if (success == false) {
			   alert("Please check one or more references then click 'Delete'.");
			 }
    return success;
}

 function verifyCheckedAllforremove(myForm,name,type){
    var success = false;
	var chkIdStr;
	if(myForm.CheckAllRef.checked) {
		success = true;
    }else{
		var idsArr = document.getElementsByTagName("input");
		for(var i=0; i<idsArr.length; i++){
			if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == name){
				if(idsArr[i].checked){
					success = true;
				}	
			}
		}
	}
	if (success == false) {
		if(type=='group'){
		   alert("Please check one or more references then click 'Remove from Group'.");
		}else{
		   alert("Please check one or more references then click 'Remove from List'.");
		}
	 }
    return success;
}
 
function ValidateFolderName(enteredFolderName)
{
	ch = enteredFolderName.substring(0, 1);
	while (ch == ' ')
	{
		enteredFolderName = enteredFolderName.substring(1, enteredFolderName.length);
		if (enteredFolderName.length == 0) break;
		ch = enteredFolderName.substring(0, 1);
	}
	ch = enteredFolderName.substring(enteredFolderName.length-1, enteredFolderName.length);
	while (ch == ' ')
	{
		enteredFolderName = enteredFolderName.substring(0, enteredFolderName.length-1);
		ch = enteredFolderName.substring(enteredFolderName.length-1, enteredFolderName.length);
	}
	if (enteredFolderName.length == 0)
	{
		alert("The group name you just entered is empty. Please enter again.");
		return false;
	}
	if (enteredFolderName.length > 255) 
	{
		alert("The group name should not be more than 255 characters. Please enter again.");
		return false;
	}
	return enteredFolderName;
}

function createFolder_addRefGS(myForm,selectedFolderId,chkIdStr,cnt,newgroupname,groupsetguid,groupsetname,currentFolderName)
{
       	var ret=newgroupname;
		document.getElementById("displayErrorMsg").style.display="none";
		//ret = prompt("Enter a New Group name and click 'OK'");
		var divId = "idAddToGroup_listView";
		
		if(document.getElementById('idViewCitation').style.display == "inline")
			divId = "idAddToGroup_view";
        
		var thisSelect = document.getElementById(divId);

		if(ret == null)
		{
		  if(thisSelect != null)
		     thisSelect.options[0].selected=true;		
		}else
        {
            if(ValidateFolderName(ret)) {
                    ret=encodeURIComponent(ret);
					changeFoldersGs(myForm,selectedFolderId,ret,groupsetguid,chkIdStr,cnt,currentFolderName);
            }else
            {
                createFolder_addRef(myForm,selectedFolderId,chkIdStr,cnt,groupsetguid);
            }
        }
 }

function createFolder_addRef(myForm,selectedFolderId,chkIdStr,cnt)
{
       	var ret;
		document.getElementById("displayErrorMsg").style.display="none";
		if(dojo.isSafari >=5 ) {			
			ret = prompt("Enter a New Group name and click 'OK'","New Group");			
		}
		else {
			ret = prompt("Enter a New Group name and click 'OK'","New Group");
		}
		var divId = "idAddToGroup_listView";
		
		if(document.getElementById('idViewCitation').style.display == "inline")
			divId = "idAddToGroup_view";
        
		var thisSelect = document.getElementById(divId);

		if(((ret == null || ret == '') && dojo.isSafari >= 5 && ret.length == 0)||(ret == null) )
		{
		  if(thisSelect != null)
		     thisSelect.options[0].selected=true;		
		}else
        {
            if(ValidateFolderName(ret)) {
                    ret=encodeURIComponent(ret);
               		changeFolders(myForm,selectedFolderId,ret,chkIdStr,cnt);
            }else
            {
                createFolder_addRef(myForm,selectedFolderId,chkIdStr,cnt);
            }
        }
 }

 function copyToExportList(myForm)
 {
    document.getElementById('progress_indicator_image').style.display = "inline";
    document.getElementById('copy_to_export_progress_indicator_container').style.display = "inline";

 	myForm.action = myForm.action + "func=mark&";
	myForm.method = "post";
	myForm.submit();
 } 

//need to verify fun call-i.e reqd in showcitation or not

function verifyCheckforSaveCopy(frm, name, functype) {
	var i;
  	var success = false;
  	if(0 != 0) {
    	if(frm.checkall.value == 0) {
    		var idsArr = document.getElementsByTagName("input");
   			for(var i=0; i<idsArr.length; i++){
       			if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == name){
           			if(idsArr[i].checked){
           				success = true;
           			}	
       			}
   			}
     	} 
    	else if(frm.checkall.value == 1) {	
        	success = true;
     	}
	} else {
    	var idsArr = document.getElementsByTagName("input");
   		for(var i=0; i<idsArr.length; i++){
       		if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == name){
        		if(idsArr[i].checked){
        			success = true;
        		}	
       		}
   		}	 		
  	} 
    if (success == false) {
    	if(functype == 'SaveCopy') {
			if((frm.folder_id.value == 'SharedGroupsLine') || (frm.folder_id.value == 'SharedGroupsHeading') || (frm.folder_id.value == 'RIDGroupsLine') || (frm.folder_id.value == 'RIDGroupsHeading') || (frm.folder_id.value == '')){
				alert("Please select references.");
			}else{
	      		alert("Please check one or more references then select a group.");
			}
        } 
        else if(functype == 'CopyExport') {
	  		alert("Please check one or more references then click 'Copy to Quick List'.");
       	}
    }else if(success == true){
		if((frm.folder_id.value == 'SharedGroupsLine') || (frm.folder_id.value == 'SharedGroupsHeading') || (frm.folder_id.value == 'RIDGroupsLine') || (frm.folder_id.value == 'RIDGroupsHeading') || (frm.folder_id.value == '')){
				alert("Please select references.");
				return false;
		}
	}
	return success;
}

function set_new_window_props() {
    var winprops;

    var win_w = parseInt(screen.width * .85);
    var win_h = parseInt(screen.height * .70);

    winprops = 'height='+ win_h +',width='+ win_w +',top=70,left=60,toolbar=yes,menubar=yes,'+
               'resizable=yes,scrollbars=yes,status=no';

    return winprops;
}

//Open new browser window
function openBrWindow(theURL,winName,features) {
        if(typeof features !='object'){
            features=set_new_window_props();
        }

        newWindow = window.open(theURL,winName,features);
        newWindow.focus();

        return false;
}

function open_location(theURL,winName,features) {
    if(winName.length){
        return openBrWindow(theURL,winName,'');
    }else{
        return true;
    }
}

function citationErrorHandler(response, ioArgs) {
    if(response.dojoType == "timeout"){
//        alert('Connection Timed out! Hit Enter to force Page Refresh.');
        window.location.reload(true);
    }else if(response.dojoType == "cancel" || response.status == 0){
        return;
    }else if(ioArgs.xhr.status == 302 || ioArgs.xhr.status == 0 ){
 //       alert('Your session has expired. Please close the dialog and log in again.');
        window.location.reload(true)
    }else{
//        alert('Error when retrieving data from the server!');
        window.location.reload(true);
    }
    console.error(response);
}

function clearReferences(myForm,chkIdStr,show)
 {
document.getElementById('delete_progress_indicator_container').style.display = "inline";
  	var checkedAll =0;
 if (chkIdStr == undefined) {
if(myForm.CheckAllRef.checked ||  myForm.checkall.value == 1 ) {
		checkedAll=1;
		var allChkIdStr = document.summarypage.citation_ids.value;
   		var idsArr = document.getElementsByTagName("input");
		var allIds = allChkIdStr.split(" ");
   		var unchkIds = new Array();
		for(var i=0; i<idsArr.length; i++){
			if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
				if(!idsArr[i].checked){
				unchkIds.push(idsArr[i].getAttribute("value"));
				}	
			}
		}
		chkIdStr = unchkIds.join(' ');
	}else{
		var idsArr = document.getElementsByTagName("input");
		var chkIds = new Array();
		for(var i=0; i<idsArr.length; i++){
			if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
				if(idsArr[i].checked){
					chkIds.push(idsArr[i].getAttribute("value"));
				}	
			}
		}
		chkIdStr = chkIds.join(' ');   
	}
  }
	var currentFolderId=document.summarypage.current_folder_id.value;
	var dojoURL=  "EndNoteWeb.html?func=removeCitationsFromQuickList&ids="+chkIdStr;
	if(checkedAll ==1) {
		dojoURL= dojoURL+"&checkedAll="+checkedAll+"&currentFolderId="+currentFolderId;
		checkedAll=0;
		document.summarypage.checkall.value = 0;
	}

	dojo.xhrGet({
                    url      : dojoURL,
                    handleAs: 'json',
                    preventCache : true,     
                    load     : function (type, data, evt)
								{
									if(show != "viewPage")
									{
										document.getElementById('delete_progress_indicator_container').style.display = "none";
										noPerPage = document.summarypage.TopRecordsPerSummary.value;
										loadCitations(1, noPerPage, currentFolderId);				
									}else
									{
										document.getElementById('delete_progress_indicator_container').style.display = "none";
										getGroupsInfo(chkIdStr);
									}
							},
		    error    : citationErrorHandler
					});
		return false;
 }

function loadCitations(pageNo, length, currentFolderId,pguid)
{	
	
	document.getElementById('delete_progress_indicator_container').style.display = "none";
	if (currentFolderId == 0 && document.citationSearchForm.search_item.value == "") {
		document.getElementById("idGuideLink").style.display = "";
		document.getElementById("idEndnoteAd_logo").style.display = "";
	}else{
		document.getElementById("idGuideLink").style.display = "none";
		document.getElementById("idEndnoteAd_logo").style.display = "none";
	}
	displayLoadingMsg(currentFolderId);

	
  //  document.getElementById("citMsg").style.display="inline";
// Incase any shared folder id has underscrore character replace it with ':'
    currentFolderId = ""+currentFolderId;    
    if(currentFolderId.indexOf('_')){
        //currentFolderId = currentFolderId.replace(/_/g,":");
        if(currentFolderId.indexOf(':') == -1) {
         	currentFolderId = currentFolderId.replace(/_([^_]*)$/, ":" + "$1");
        }
    }
	var loadCitUrl = "EndNoteWeb.html?func=loadCitations&page="+pageNo+"&length="+length+"&currentFolderId="+currentFolderId;
	if(pguid != "undefined" && pguid != "") {
		 loadCitUrl += "&pguid="+pguid;
	}

	if(document.getElementById("idSortField").value){
        loadCitUrl += "&sortField="+document.getElementById("idSortField").value+"&sortOrder="+document.getElementById("idSortOrder").value;
//        }else if(document.getElementById("idselectedSortField").value){
//		loadCitUrl += "&selectedSortField="+document.getElementById("idselectedSortField").value+"&sortOrder="+document.getElementById("idSortOrder").value;
	}else{
		//set sort arrow on Citation Headings to default position
		var idAuthorLink = document.getElementById("authorLink");
		var idYearLink = document.getElementById("yearLink");
		var idTitleLink = document.getElementById("titleLink");
		if (idAuthorLink.childNodes.length > 1) {
			if (idAuthorLink.lastChild.id == 'down_img') {
				idAuthorLink.replaceChild(up_img, idAuthorLink.lastChild);
			}
		}else{
			idAuthorLink.appendChild(up_img);
			var idYearLink = document.getElementById("yearLink");
			var idTitleLink = document.getElementById("titleLink");
			if (idYearLink.childNodes.length>1){
					idYearLink.removeChild(idYearLink.lastChild);
			}else if (idTitleLink.childNodes.length>1){
					idTitleLink.removeChild(idTitleLink.lastChild);
			}
		}
		//Code to set the alt/title of the headings to default alt/title texts when the references are loading freshly or when the user is navigating between the groups
		idAuthorLink.alt = "Click to sort the list by author in Z to A order";
		idAuthorLink.title = "Click to sort the list by author in Z to A order";
		up_img.setAttribute("alt", "The list is sorted by author in A to Z order");
		up_img.setAttribute("title", "The list is sorted by author in A to Z order");
		idYearLink.alt = "Click to sort the list by year in newest to oldest order";
		idYearLink.title = "Click to sort the list by year in newest to oldest order";
		idTitleLink.alt = "Click to sort the list by title in A to Z order";
		idTitleLink.title = "Click to sort the list by title in A to Z order";
	}
    
    if(document.citationSearchForm.search_item.value != "undefined"){
        loadCitUrl += "&searchItem="+encodeURIComponent(document.citationSearchForm.search_item.value)+"&searchField="+document.citationSearchForm.searchField.value
    }
    if(document.citationSearchForm.authorflag.value != "undefined"){
        loadCitUrl += "&authorflag="+document.citationSearchForm.authorflag.value;
	}
	
	dojo.xhrGet({
                    url      : loadCitUrl,
    		    handleAs : 'json',
                    preventCache : true,						
                    load     : function (data){
									setResponsePage(data);									
                               },
               	    timeout  : '10000',
                    error    : citationErrorHandler
                 });
		
}

function displayLoadingMsg(folderId){
// Check whether current active page is showCitations are not 
    if(document.getElementById("idShowCitations").style.display == "none"){
	if(document.getElementById("idEditCitation").style.display == "inline"){
            document.getElementById("idEditCitation").style.display = "none";
    }else if(document.getElementById("idViewCitation").style.display == "inline"){
            document.getElementById("idViewCitation").style.display = "none";
        }
    }
//	if(folderId != 1 && folderId != 0 && folderId != -1) {
	//	if(folderId.indexOf(':')) {
		  folderId = ""+folderId;
		if(folderId.indexOf(':') != -1 ){
			folderId = folderId.replace(/:/g,"_");
		}
  //  }
    var countString = document.getElementById("idFolderLink_0").childNodes[0].innerHTML;
	countString+= "";
	index1 = countString.indexOf('(');
	index2 = countString.indexOf(')');
	var count = countString.substring( index1 + 1,index2);

	var currentCntString = document.getElementById("idFolderLink_"+folderId).childNodes[0].innerHTML;
	index3 = currentCntString.lastIndexOf('(');
	index4 = currentCntString.lastIndexOf(')'); 
	var folderCount = currentCntString.substring( index3 + 1,index4);

    var tbody = document.getElementById("ref_main");
    if(tbody.rows.length > 6){
        deleteCitationRows();
    }
	if((count == "0" && folderId == 0) || folderCount == 0){
		    document.getElementById("topNavBar").style.display = "none";	
			document.getElementById("displayCitations").style.visibility = "hidden";
			document.getElementById("citMsg").style.visibility="hidden";
		    document.getElementById("citMsg").style.display="none";
			
	}
	else {
		
			document.getElementById("displayErrorMsg").style.display="none";
			document.getElementById("displayCitations").style.visibility = "visible";
			document.getElementById("displayCitations").style.display = "table-row";
			document.getElementById("citMsg").style.visibility="visible";
		    document.getElementById("citMsg").style.display="inline";
			document.getElementById("topNavBar").style.display = "inline";		 
	}

}

function deleteCitationRows(){
    var tbody = document.getElementById("ref_main");
    var rowLength = parseInt(tbody.rows.length);
    var len = rowLength - 2;
    for(i = rowLength-2 ; i >= 5; i--){
        tbody.deleteRow(i);
    }
}

function setResponsePage(citData){
	if (citData.CURRENT_FOLDER_ID == 0 || citData.CURRENT_FOLDER_ID == '1') {
		document.getElementById("removeFgroup_List").style.display="none";
		document.getElementById("removeFlist").style.display="none";
		document.getElementById("quick_list").style.display="inline";
		document.getElementById("idAddToGroup_select").style.display="inline";
		document.getElementById("idDelete").style.display="inline";
		document.getElementById('idRestore').style.display="none";
	}else if (citData.CURRENT_FOLDER_ID == 'EL') {
		document.getElementById("removeFgroup_List").style.display="none";
		document.getElementById("removeFlist").style.display="inline";
		document.getElementById("quick_list").style.display="none";
		document.getElementById("idDelete").style.display="inline";
		document.getElementById('idRestore').style.display="none";
	}else if (citData.CURRENT_FOLDER_ID == '-1') {
 		document.getElementById("removeFgroup_List").style.display="none";
		document.getElementById("removeFlist").style.display="none";
		document.getElementById("quick_list").style.display="none";
		document.getElementById("idDelete").style.display="inline";
		if(document.getElementById('idRestoreval').value=='yes')
		{
			document.getElementById("idAddToGroup_select").style.display="none";
			document.getElementById('idRestore').style.display="inline";
		}
	}else if (citData.CURRENT_FOLDER_ID.indexOf(':') != -1) {
		if(citData.CURRENT_FOLDER_PERM == "rw"){
			document.getElementById("removeFgroup_List").style.display="inline";
			document.getElementById('idRestore').style.display="none";
			if(0 == 1){
				document.getElementById("removeFromGroup").src = "/images/en_us/removeFgroup_disabled.gif";
				document.getElementById("removeFromGroup").onclick = "javascript:void(0)";
				document.getElementById("removeFromGroup").alt = "Remove checked references from this group (disabled)";
				document.getElementById("removeFromGroup").title = "Remove checked references from this group (disabled)";
				document.getElementById("idDeleteTrash").alt = "Move Checked References from All My References to the trash (disabled)";
				document.getElementById("idDeleteTrash").title = "Move Checked References from All My References to the trash (disabled)";
			}else{
				document.getElementById("removeFromGroup").src = "/images/en_us/removeFgroup.gif"; 
				document.getElementById("removeFromGroup").alt = "Remove checked references from this group";
				document.getElementById("removeFromGroup").title = "Remove checked references from this group";
				document.getElementById("removeFromGroup").onclick = function(){
					if(verifyCheckedAllforremove(this.form,'ids','group'))
					{
						if(verifyCheckedAllRemove(this.form)) {
							return passFolderId(this.form,'fromGroup')
						} else { 
							return false; 
						}
					} else { 
						return false; 
					}
				};
			}
		}else if(citData.CURRENT_FOLDER_PERM == "ro"){
			document.getElementById("removeFgroup_List").style.display="none";
		}
		document.getElementById("removeFlist").style.display="none";		 
		document.getElementById("quick_list").style.display="none";
		document.getElementById("idDelete").style.display="none";
		document.getElementById('idRestore').style.display="none";
	}else{ 
	
		var quickSearchFlag = citData.CURRENT_FOLDER_ID.indexOf("pguid");
		if(('0' == '1') && (citData.PGUID == undefined || citData.PGUID == "" || (citData.PGUID == 'undefined' && quickSearchFlag == 0))){
		if(citData.SEARCH_ITEM != "" && quickSearchFlag == -1){
			//document.getElementById("removeFgroupSet_List").style.display="none";
			document.getElementById("removeFgroup_List").style.display="inline";
		}else{
			//document.getElementById("removeFgroupSet_List").style.display="inline";
			document.getElementById("removeFgroup_List").style.display="none";
		}
		}else{
			document.getElementById("removeFgroup_List").style.display="inline";
		}
		document.getElementById('idRestore').style.display="none";
		if(0 == 1){
			document.getElementById("removeFromGroup").src = "/images/en_us/removeFgroup_disabled.gif";
			document.getElementById("removeFromGroup").onclick = "javascript:void(0)";
			document.getElementById("removeFromGroup").alt = "Remove checked references from this group (disabled)";
			document.getElementById("removeFromGroup").title = "Remove checked references from this group (disabled)";
			document.getElementById("idDeleteTrash").alt = "Move Checked References from All My References to the trash (disabled)";
			document.getElementById("idDeleteTrash").title = "Move Checked References from All My References to the trash (disabled)";
		}else{
			document.getElementById("removeFromGroup").src = "/images/en_us/removeFgroup.gif";
			document.getElementById("removeFromGroup").onclick = function(){
				if(verifyCheckedAllforremove(this.form,'ids','group'))
				{
				    if(verifyCheckedAllRemove(this.form)) {
						return passFolderId(this.form,'fromGroup')
				    } else { 
						return false; 
					}
				} else { 
					return false; 
				}
			};
			document.getElementById("removeFromGroup").alt = "Remove checked references from this group";
			document.getElementById("removeFromGroup").title = "Remove checked references from this group";
		}
		document.getElementById("removeFlist").style.display="none";		 		 
		document.getElementById("quick_list").style.display="inline";
		document.getElementById("idAddToGroup_select").style.display="inline";
		document.getElementById("idDelete").style.display="inline";
	}
	document.getElementById("idCheckPage").checked = false;
	document.getElementById("idCheckAllRef").checked = false;


    pageNo = citData.PAGE_NO;

	if(('0' == '0') || citData.CURRENT_FOLDER_ID == 'EL' || (document.citationSearchForm.search_item.value).length > 0 ) {
		document.summarypage.citation_count.value = citData.CURRENT_FOLDER_RECORD_COUNT;
	 }
	 else {
		 var folderid = citData.CURRENT_FOLDER_ID;		
	     folderid = "count"+folderid ;
		 if(document.getElementById(folderid) != undefined) {
			var count = document.getElementById(folderid).innerHTML;
	 		count = count.replace(/\D/g, '');
			document.summarypage.citation_count.value = count;
		 }
	 }

	if(showEndnoteState == 1){
		document.getElementById("idErrorEndnoteAd_container").style.display="";
		document.getElementById("idErrorEndnoteAd_learn").style.display="none";			
	}else{
		document.getElementById("idErrorEndnoteAd_container").style.display="none";
		document.getElementById("idErrorEndnoteAd_learn").style.display="";			
	}
    document.summarypage.citation_ids.value = citData.CURRENT_FOLDER_CITATION_IDS;
    if(citData.CURRENT_FOLDER_ID.indexOf(':')){
// Folders shared by others will have ':' in their folder id's replace them with the '_' as DOM id's should not have any special characters other than '_'
        sharedFolderId = citData.CURRENT_FOLDER_ID;
		citData.CURRENT_FOLDER_ID = citData.CURRENT_FOLDER_ID.replace(/:/g,"_");
    }

    if(citData.CURRENT_FOLDER_ID != document.summarypage.current_folder_id.value) {
		// First disable the present link 
			if(('0' == '1') && (document.summarypage.current_folder_id.value.indexOf('-'))) {
			oldFolderId =  (document.summarypage.current_folder_id.value).replace(/pguid-/,"");
		}
		else {
			oldFolderId =  document.summarypage.current_folder_id.value;
		}
		if(document.getElementById("idFolderLink_"+oldFolderId)) {
			oldFolderClass = document.getElementById("idFolderLink_"+oldFolderId).className;
		}
        oldFolderClass1 =  (oldFolderClass == "sideL1Active") ? "sideL1" : 
        					((oldFolderClass == "folderActive") ? "folder" : 
        						((oldFolderClass == "sideL1Active") ? "sideL1Last" : "")
        					);
         if(oldFolderClass1 && document.getElementById("idFolderLink_"+oldFolderId)){			
        	document.getElementById("idFolderLink_"+oldFolderId).className = oldFolderClass1;
        }  
// Highlight new folder Id 
	    if(('0' == '1') && (citData.CURRENT_FOLDER_ID.indexOf('-'))) {
			newFolderId =  citData.CURRENT_FOLDER_ID.replace(/pguid-/,"");
		}
		else {
			newFolderId =  citData.CURRENT_FOLDER_ID;
		}        
        if(document.getElementById("idFolderLink_"+newFolderId)){
        newFolderClass = document.getElementById("idFolderLink_"+newFolderId).className;
		if (! newFolderClass.match('Active')) {
        document.getElementById("idFolderLink_"+newFolderId).className = (newFolderClass == "sideL1") ? "sideL1Active" : 
                                                                           ((newFolderClass == "folder") ? "folderActive" : 
        						                                             ((newFolderClass == "sideL1Last") ? "sideL1Active" : "")
        						                                           );
		}
	}
    	document.summarypage.current_folder_id.value = citData.CURRENT_FOLDER_ID;    
            	
    }

		if(citData.CURRENT_FOLDER_ID == 1){
		document.getElementById("idFoderDesc").innerHTML = "["+ citData.CURRENT_FOLDER_NAME+"]";
	}else{
		document.getElementById("idFoderDesc").innerHTML = citData.CURRENT_FOLDER_NAME.replace(/&amp;/g, '&');
	}
    setNavBar(pageNo);
    document.summarypage.TopPageInput.value = pageNo;
	document.summarypage.PageNum.value = pageNo;
    document.summarypage.BottomPageInput.value = pageNo;
    document.getElementById("idCheckPage").checked = false;
	var hideGettingStartedGuideLink = '<a href="javascript:void(0);" onclick=javascript:setGettingStartedGuide(\"hide\") title="' + 'Hide Getting Started Guide' + '" alt="' + 'Hide Getting Started Guide' + '">' + 'Hide Getting Started Guide' + '</a>';
    var showGettingStartedGuideLink = '<a href="javascript:void(0);" onclick=javascript:setGettingStartedGuide(\"show\") title="' + 'Show Getting Started Guide' + '" alt="' + 'Show Getting Started Guide' + '">' + 'Show Getting Started Guide' + '</a>';
	if (showGettingStartedGuide == "show"  && citData.CURRENT_FOLDER_ID == 0 && document.citationSearchForm.search_item.value == "" && 0 != 1) {		
		document.getElementById("idShowGettingStarted").style.display = "inline";
		document.getElementById("idGuideLink").innerHTML = hideGettingStartedGuideLink;
		document.getElementById("idShowCitations").style.display = "none";
	}
	else if(showGettingStartedGuide == 'hide' || citData.CURRENT_FOLDER_ID != 0 || document.citationSearchForm.search_item.value != "" || 0 == 1){
		document.getElementById("idShowGettingStarted").style.display = "none";
		document.getElementById("idGuideLink").innerHTML = showGettingStartedGuideLink;
		document.getElementById("idShowCitations").style.display = "inline";
	}   
	if(citData.PGUID != "undefined") {
		document.summarypage.pguid.value = citData.PGUID;		
	}
	else {		
		document.summarypage.pguid.value ="";
		citData.PGUID="";
	}
	document.getElementById('onlineSideBar').style.width="29px";
	document.getElementById('onlineHrBar').style.marginLeft="19px";
	document.getElementById('languages1').style.marginLeft="12px";
	showCitations(citData.DATA,citData.CURRENT_FOLDER_NAME,citData.CURRENT_FOLDER_ID,citData.PUBLISHED_STATE,citData.REF_IDS);
}

function setNavBar(pageNo){
    citationCount = parseInt(document.summarypage.citation_count.value);
    noPerPage = parseInt(document.summarypage.TopRecordsPerSummary.value);
    maxPageCount = (citationCount % noPerPage) ? parseInt((citationCount / noPerPage)+1) : (citationCount / noPerPage) ;
    maxPageCount = (maxPageCount) ? maxPageCount : 1;

    document.getElementById('idPageCount').innerHTML =  maxPageCount;

	document.getElementById('idPageCountBottom').innerHTML =  maxPageCount;

    if(maxPageCount != document.summarypage.max_page_count.value){
        document.summarypage.max_page_count.value = maxPageCount;
    }
        if(pageNo == 1 && pageNo < maxPageCount){
        if(document.getElementById("nav_first_link")){
             document.getElementById("nav_first_container").replaceChild(nav_first_i, document.getElementById("nav_first_link"));
			 document.getElementById("nav_first_container_bottom").replaceChild(nav_first_i_bottom, document.getElementById("nav_first_link_bottom"));
        }
        if(document.getElementById("nav_prev_link")){
            document.getElementById("nav_prev_container").replaceChild(nav_prev_i, document.getElementById("nav_prev_link"));
            document.getElementById("nav_prev_container_bottom").replaceChild(nav_prev_i_bottom, document.getElementById("nav_prev_link_bottom"));

        }
        if(document.getElementById("nav_next_img_i")){
            document.getElementById("nav_next_container").replaceChild(nav_next, document.getElementById("nav_next_img_i"));

            document.getElementById("nav_next_container_bottom").replaceChild(nav_next_bottom, document.getElementById("nav_next_img_i_bottom"));
        }
        if(document.getElementById("nav_last_img_i")){
            document.getElementById("nav_last_container").replaceChild(nav_last, document.getElementById("nav_last_img_i"));

            document.getElementById("nav_last_container_bottom").replaceChild(nav_last_bottom, document.getElementById("nav_last_img_i_bottom"));

        }
    }
    else if(pageNo > 1 && pageNo == maxPageCount){
        if(document.getElementById("nav_first_img_i")){
            document.getElementById("nav_first_container").replaceChild(nav_first, document.getElementById("nav_first_img_i"));
			document.getElementById("nav_first_container_bottom").replaceChild(nav_first_bottom, document.getElementById("nav_first_img_i_bottom"));
        }
        if(document.getElementById("nav_prev_img_i")){
            document.getElementById("nav_prev_container").replaceChild(nav_prev, document.getElementById("nav_prev_img_i"));

            document.getElementById("nav_prev_container_bottom").replaceChild(nav_prev_bottom, document.getElementById("nav_prev_img_i_bottom"));
        }
        if(document.getElementById("nav_next_link")){
            document.getElementById("nav_next_container").replaceChild(nav_next_i, document.getElementById("nav_next_link"));
			document.getElementById("nav_next_container_bottom").replaceChild(nav_next_i_bottom, document.getElementById("nav_next_link_bottom"));
        }
        if(document.getElementById("nav_last_link")){
            document.getElementById("nav_last_container").replaceChild(nav_last_i, document.getElementById("nav_last_link"));
			document.getElementById("nav_last_container_bottom").replaceChild(nav_last_i_bottom, document.getElementById("nav_last_link_bottom"));
        }
    }
    else if(pageNo > 1 && pageNo < maxPageCount){
        if(document.getElementById("nav_first_img_i")){
            document.getElementById("nav_first_container").replaceChild(nav_first, document.getElementById("nav_first_img_i"));
			document.getElementById("nav_first_container_bottom").replaceChild(nav_first_bottom, document.getElementById("nav_first_img_i_bottom"));
        }
        if(document.getElementById("nav_prev_img_i")){
            document.getElementById("nav_prev_container").replaceChild(nav_prev, document.getElementById("nav_prev_img_i"));

			document.getElementById("nav_prev_container_bottom").replaceChild(nav_prev_bottom, document.getElementById("nav_prev_img_i_bottom"));
        }
        if(document.getElementById("nav_next_img_i")){
            document.getElementById("nav_next_container").replaceChild(nav_next, document.getElementById("nav_next_img_i"));

			document.getElementById("nav_next_container_bottom").replaceChild(nav_next_bottom, document.getElementById("nav_next_img_i_bottom"));
        }
        if(document.getElementById("nav_last_img_i")){
            document.getElementById("nav_last_container").replaceChild(nav_last, document.getElementById("nav_last_img_i"));
	
			document.getElementById("nav_last_container_bottom").replaceChild(nav_last_bottom, document.getElementById("nav_last_img_i_bottom"));
        }
    }
    else if(pageNo == 1 && maxPageCount == 1){
        if(document.getElementById("nav_first_link")){
             document.getElementById("nav_first_container").replaceChild(nav_first_i, document.getElementById("nav_first_link"));
			document.getElementById("nav_first_container_bottom").replaceChild(nav_first_i_bottom, document.getElementById("nav_first_link_bottom"));
        }
        if(document.getElementById("nav_prev_link")){
            document.getElementById("nav_prev_container").replaceChild(nav_prev_i, document.getElementById("nav_prev_link"));
			document.getElementById("nav_prev_container_bottom").replaceChild(nav_prev_i_bottom, document.getElementById("nav_prev_link_bottom"));
        }
        if(document.getElementById("nav_next_link")){
            document.getElementById("nav_next_container").replaceChild(nav_next_i, document.getElementById("nav_next_link"));
			document.getElementById("nav_next_container_bottom").replaceChild(nav_next_i_bottom, document.getElementById("nav_next_link_bottom"));
        }
        if(document.getElementById("nav_last_link")){
            document.getElementById("nav_last_container").replaceChild(nav_last_i, document.getElementById("nav_last_link"));
			document.getElementById("nav_last_container_bottom").replaceChild(nav_last_i_bottom, document.getElementById("nav_last_link_bottom"));
        }
    }
}

function getFirstPage(){
    noPerPage = document.summarypage.TopRecordsPerSummary.value;
    loadCitations(1, noPerPage, document.summarypage.current_folder_id.value,document.summarypage.pguid.value);
}

function getPrevPage(){
	pageNo = document.summarypage.PageNum.value;
    noPerPage = document.summarypage.TopRecordsPerSummary.value;

    if(pageNo > 1){
        loadCitations(--pageNo, noPerPage, document.summarypage.current_folder_id.value,document.summarypage.pguid.value);
    }
}

function getNextPage(){
	pageNo = parseInt(document.summarypage.PageNum.value);
    noPerPage = document.summarypage.TopRecordsPerSummary.value;
    maxPageCount = parseInt(document.summarypage.max_page_count.value);

    if(pageNo < maxPageCount){
        loadCitations(++pageNo, noPerPage, document.summarypage.current_folder_id.value,document.summarypage.pguid.value);
    }
}

function getLastPage(){
    maxPageCount = document.summarypage.max_page_count.value;
    noPerPage = document.summarypage.TopRecordsPerSummary.value;
    loadCitations(maxPageCount, noPerPage, document.summarypage.current_folder_id.value,document.summarypage.pguid.value);
}

function getCitationPage(pageNo){
	pageNo = stripSpaces(pageNo);
	if (pageNo.match(/[,.]+/g)){ 
		pageNo=pageNo.replace(/[,.]+.*/g,'');
	} 
	if((pageNo < 1) || isNaN(pageNo)) { 
		alert('Please enter a number.');
		return false;
	}
	if (pageNo > parseInt(document.getElementById('idPageCount').innerHTML)) { 
		pageNo = parseInt(document.getElementById('idPageCount').innerHTML); 
	}
    if(isNaN(pageNo)) {
        alert('Please enter a number.');
        return false;
    }
	var pguid=document.summarypage.pguid.value;
	document.summarypage.TopPageInput.value = pageNo;
	document.summarypage.BottomPageInput.value = pageNo;
    noPerPage = document.summarypage.TopRecordsPerSummary.value;
    if(pguid.length == 0){
	loadCitations(pageNo, noPerPage, document.summarypage.current_folder_id.value,'');
	}else{
    loadCitations(pageNo, noPerPage, document.summarypage.current_folder_id.value,pguid);
	}
	return false;
}

function sortPage(sortField, sortOrder){
	    var idAuthorLink = document.getElementById("authorLink");
        var idYearLink = document.getElementById("yearLink");
        var idTitleLink = document.getElementById("titleLink");
		 var newChild;
        if(sortField == 'author'){
				var authorSortOrder = sortOrder;
				if (idAuthorLink.childNodes.length > 1){
					authorSortOrder = (idAuthorLink.lastChild.id == 'down_img') ? 'a' : 'd';
					newChild = (idAuthorLink.lastChild.id == 'down_img') ? up_img : down_img;	
					idAuthorLink.replaceChild(newChild, idAuthorLink.lastChild);
				}else{
				    newChild = (authorSortOrder == 'a') ? up_img : down_img;
					idAuthorLink.appendChild(newChild);
				}
				if(authorSortOrder.length != 0){
					if(authorSortOrder == 'a'){
						document.getElementById("idForAuthor").value = 'd';
					}else{
						document.getElementById("idForAuthor").value = 'a';
					}
					//Code to set the default sort order to the fields
					document.getElementById("idForYear").value = 'd';
					document.getElementById("idForTitle").value = 'a';
				}
				if(authorSortOrder == 'a') {
					document.getElementById('sort_By').selectedIndex = 0 
					idAuthorLink.alt ="Click to sort the list by author in Z to A order";
					idAuthorLink.title ="Click to sort the list by author in Z to A order";
					up_img.setAttribute("alt", "The list is sorted by author in A to Z order");
					up_img.setAttribute("title", "The list is sorted by author in A to Z order");
				}else{
					document.getElementById('sort_By').selectedIndex = 1;
					idAuthorLink.alt ="Click to sort the list by author in A to Z order";
		    		idAuthorLink.title ="Click to sort the list by author in A to Z order";

					down_img.setAttribute("alt", "The list is sorted by author in Z to A order");
					down_img.setAttribute("title", "The list is sorted by author in Z to A order");
    
				}

				//Code to set the default alt/title messages to the fields
				idYearLink.alt = "Click to sort the list by year in newest to oldest order";
				idYearLink.title = "Click to sort the list by year in newest to oldest order";
				idTitleLink.alt = "Click to sort the list by title in A to Z order";
				idTitleLink.title = "Click to sort the list by title in A to Z order";

				sortOrder = authorSortOrder;
                if (idYearLink.childNodes.length>1){
                        idYearLink.removeChild(idYearLink.lastChild);
                }

                if (idTitleLink.childNodes.length>1){
                        idTitleLink.removeChild(idTitleLink.lastChild);
                }
        }else if (sortField == 'year') {
							
				var yearSortOrder = sortOrder;
				if (idYearLink.childNodes.length > 1){
					newChild = (idYearLink.lastChild.id == 'down_img') ? up_img : down_img;
		            yearSortOrder = (idYearLink.lastChild.id == 'down_img') ? 'a' : 'd';
					idYearLink.replaceChild(newChild, idYearLink.lastChild);
				}else{
					newChild = (yearSortOrder == 'a') ? up_img : down_img;
					idYearLink.appendChild(newChild);
				}
				if(yearSortOrder.length != 0){
					if(yearSortOrder == 'a'){
						document.getElementById("idForYear").value = 'd';
					}else{
						document.getElementById("idForYear").value = 'a';
					}
					//Code to set the default sort order to the fields
					document.getElementById("idForAuthor").value = 'a';
					document.getElementById("idForTitle").value = 'a';
				}
				if(yearSortOrder == 'a') { 
					document.getElementById('sort_By').selectedIndex = 3;
					idYearLink.alt ="Click to sort the list by year in newest to oldest order";
					idYearLink.title ="Click to sort the list by year in newest to oldest order";
					up_img.setAttribute("alt", "The list is sorted by year in oldest to newest order");
					up_img.setAttribute("title", "The list is sorted by year in oldest to newest order");
				}else{
						document.getElementById('sort_By').selectedIndex = 2;
						idYearLink.alt ="Click to sort the list by year in oldest to newest order";
						idYearLink.title ="Click to sort the list by year in oldest to newest order";
						down_img.setAttribute("alt", "The list is sorted by year in newest to oldest order");
						down_img.setAttribute("title", "The list is sorted by year in newest to oldest order");
				}

				//Code to set the default alt/title messages to the fields
				idAuthorLink.alt ="Click to sort the list by author in A to Z order";
				idAuthorLink.title ="Click to sort the list by author in A to Z order";
				idTitleLink.alt ="Click to sort the list by title in A to Z order";
				idTitleLink.title ="Click to sort the list by title in A to Z order";

				sortOrder = yearSortOrder;
                if (idAuthorLink.childNodes.length>1){
                        idAuthorLink.removeChild(idAuthorLink.lastChild);
                }
                if (idTitleLink.childNodes.length>1){
                        idTitleLink.removeChild(idTitleLink.lastChild);
                }
        }else if (sortField == 'title') {
			
				var titleSortOrder = sortOrder;
				if (idTitleLink.childNodes.length > 1){
					titleSortOrder = (idTitleLink.lastChild.id == 'down_img') ? 'a' : 'd';
					newChild = (idTitleLink.lastChild.id == 'down_img') ? up_img : down_img;	
					idTitleLink.replaceChild(newChild, idTitleLink.lastChild);
				}else{
				    newChild = (titleSortOrder == 'a') ? up_img : down_img;
					idTitleLink.appendChild(newChild);
				}
				if(titleSortOrder.length != 0){
					if(titleSortOrder == 'a'){
						document.getElementById("idForTitle").value = 'd';
					}else{
						document.getElementById("idForTitle").value = 'a';
					}
					//Code to set the default sort order to the fields
					document.getElementById("idForAuthor").value = 'a';
					document.getElementById("idForYear").value = 'd';
				}
				if(titleSortOrder == 'a'){
					document.getElementById('sort_By').selectedIndex = 4 ;
					idTitleLink.alt = "Click to sort the list by title in Z to A order";
					idTitleLink.title = "Click to sort the list by title in Z to A order";
					up_img.setAttribute("alt", "The list is sorted by title in A to Z order");
					up_img.setAttribute("title", "The list is sorted by title in A to Z order");
				}else{
					document.getElementById('sort_By').selectedIndex = 5;
					idTitleLink.alt = "Click to sort the list by title in A to Z order";
					idTitleLink.title = "Click to sort the list by title in A to Z order";
					down_img.setAttribute("alt", "The list is sorted by title in Z to A order");
					down_img.setAttribute("title", "The list is sorted by title in Z to A order");
				}

				//Code to set the default alt/title messages to the fields
				idAuthorLink.alt = "Click to sort the list by author in A to Z order";
				idAuthorLink.title = "Click to sort the list by author in A to Z order";
				idYearLink.alt = "Click to sort the list by year in newest to oldest order";
				idYearLink.title = "Click to sort the list by year in newest to oldest order";

				sortOrder = titleSortOrder;	
                if (idAuthorLink.childNodes.length>1){
                        idAuthorLink.removeChild(idAuthorLink.lastChild);
                }
                if (idYearLink.childNodes.length>1){
                        idYearLink.removeChild(idYearLink.lastChild);
                }
        }
        else{
// If the sort field is not author or year or title remove arrow mark hyperlinks
            if(idAuthorLink.childNodes.length>1){
                idAuthorLink.removeChild(idAuthorLink.lastChild);
            }
            if (idYearLink.childNodes.length>1){
                idYearLink.removeChild(idYearLink.lastChild);
            }
            if(idTitleLink.childNodes.length>1){
                idTitleLink.removeChild(idTitleLink.lastChild);
            }
	}
        noPerPage = document.summarypage.TopRecordsPerSummary.value;
		document.getElementById("idSortField").value = sortField;
		document.getElementById("idSortOrder").value = sortOrder;
        loadCitations(1, noPerPage, document.summarypage.current_folder_id.value,document.summarypage.pguid.value);
}

function sortBy(selectedSortField,sortOrder){
    var sortorder_field = selectedSortField.substring(selectedSortField.length,selectedSortField.length-3);
    var selectedSortField = selectedSortField.substring(0,selectedSortField.length-3);
    var sortOrder = (sortorder_field == 'DSC') ? 'd' : 'a';
    sortPage(selectedSortField,sortOrder);
}


function showCitations(citArr,currentFolderName,folderId,pubState){

	var foldername = currentFolderName;
	pguid=document.summarypage.pguid.value;
	document.getElementById("idSpinProgress").style.display = "none";
    document.getElementById("citMsg").style.display="none";
    var tbody = document.getElementById("ref_main");
	// Once again make sure that we are not showing any references, if so delete them before showing new references
     if(tbody.rows.length > 6){
         deleteCitationRows();
     }
	
	getGroupsInfo("",folderId);
	if((folderId.indexOf("_") != -1) && (pubState == 0)){
		document.getElementById("displayCitations").style.display = "none";
		document.getElementById("displayErrorMsg").style.display = "inline";
		document.getElementById("displayCitations").style.display = "none";
		document.getElementById("topNavBar").style.display = "none";
		var errorMessage = 'The group, GROUP_NAME_TOKEN, is no longer shared.';
		if(	document.citationSearchForm.search_item.value == ""){
		currentFolderName=document.getElementById("idFoderDesc").innerHTML;
		currentFolderName = currentFolderName.replace(/&nbsp;/g,'');
		currentFolderName = currentFolderName.replace(/Shared Group:/,'');
		}else{
		currentFolderName =document.getElementById("idQuickSearchGroups").options[document.getElementById("idQuickSearchGroups").selectedIndex].text;
		currentFolderName=currentFolderName.substring(1,currentFolderName.length-1);
		document.getElementById("idFoderDesc").innerHTML=currentFolderName;
	    }
		currentFolderName = '<span class="errEmphasis">'+currentFolderName+'</span>';
		errorMessage = errorMessage.replace(/GROUP_NAME_TOKEN/,currentFolderName);
		errorMessage = '<div class="errtext2">'+errorMessage+'</div>';
		document.getElementById("displayErrorMsg").innerHTML = errorMessage;
	}else if(citArr.length == 0){
	if(pguid.length == 0 && ('0' == '1')){
		if(folderId != 1 && folderId != -1 && folderId != 0){
			pguid="pguid_"+folderId;
		}
	}
	var emptyMessage;
		if (currentFolderName.match('Quick Search')) {
			emptyMessage = 'No matches found.';
		}else if (currentFolderName.match('Shared Group:')) {
			emptyMessage = 'There are currently no references stored in this group.';
		}else if(currentFolderName.match('Quick List')){
			emptyMessage = 'There are currently no references in this list.';
		}else if(currentFolderName.match('Trash')){
			emptyMessage = 'There are currently no references in the Trash.';
		}else if(pguid.match('pguid_')){
			
			emptyMessage = 'There are currently no references stored in this groupset.';
			
		}else{
			emptyMessage = 'There are currently no references stored in this group.';
		}
	    notFoundMsg = document.createTextNode(emptyMessage);
		document.getElementById("displayErrorMsg").style.display = "inline";
		document.getElementById("displayCitations").style.display = "none";
		document.getElementById("topNavBar").style.display = "none";
		if (folderId == 0 && document.citationSearchForm.search_item.value == "") {
			if(document.getElementById("idErrorEndnoteAd_logo") != undefined)
				document.getElementById("idErrorEndnoteAd_logo").style.display = "";
		}else{
			if(document.getElementById("idErrorEndnoteAd_logo") != undefined)
				document.getElementById("idErrorEndnoteAd_logo").style.display = "none";
		}
		if (document.getElementById("displayErrorMsg").childNodes[0].lastChild) {
			while(document.getElementById("displayErrorMsg").childNodes[0].hasChildNodes()){
				document.getElementById("displayErrorMsg").childNodes[0].removeChild(document.getElementById("displayErrorMsg").childNodes[0].lastChild);
			}
			document.getElementById("displayErrorMsg").childNodes[0].appendChild(notFoundMsg);
		}else{
			document.getElementById("displayErrorMsg").childNodes[0].appendChild(notFoundMsg);
		}
		pguid=pguid.replace('pguid_','');
    }else{
		document.getElementById("displayCitations").style.visibility = "visible";
		document.getElementById("displayCitations").style.display = "";
		document.getElementById("topNavBar").style.display = "";
		document.getElementById("displayErrorMsg").style.display = "none";
	}
	currentFolderName = currentFolderName.replace(/\\/g,'\\\\');
    currentFolderName = currentFolderName.replace(/\'/g,"\\'");	
    for(i=0;i<citArr.length;i++){
        tr = tbody.insertRow(tbody.rows.length-1);
		if(folderId == -1){
			tr.className = (i%2) ? "rowTrash" : "row0";
		}else{
	        tr.className = (i%2) ? "row1" : "row0";
		}
// Checkbox
        td = tr.insertCell(tr.cells.length);
        td.setAttribute("valign","top");
        chkBox = document.createElement('input');
        chkBox.setAttribute("type","checkbox");
        chkBox.setAttribute("name","ids");
	//	chkBox.onclick=new Function("unchk(this)");
		chkBox.setAttribute("value",citArr[i].id);
        td.appendChild(chkBox);
// Author
        td = tr.insertCell(tr.cells.length);
        td.setAttribute("valign","top");
        link1 = document.createElement('a');
		link1.setAttribute("alt", "Search for this author in all my references");
		link1.setAttribute("title", "Search for this author in all my references");
		var authorLink = citArr[i].author_plain;
		authorLink = authorLink.replace(/\\/g,"\\\\");
		authorLink = authorLink.replace(/'/g,"\\\'");
		var authorDisp = citArr[i].author.replace(/\&(?!amp;)/g,"&amp;");
		authorDisp = authorDisp.replace(/\<(?!font|\/font|b\>|\/b>|i\>|\/i\>|u\>|\/u\>|sub\>|\/sub\>|sup\>|\/sup\>)/ig,"&lt;");
		authorDisp = authorDisp.replace(/(font color=\".*\"|\/font|\<b|\<\/b|\<i|\<\/i|\<u|\<\/u|\<sub|\<\/sub|\<sup|\<\/sup)?\>/ig, function($0, $1){
	return $1 ? $0 : '&gt;';
});
		
		link1.href = "javascript:searchAuthor('"+authorLink+"')";
		var selectedAuthor = document.citationSearchForm.selectedAuthor.value;
		selectedAuthor += "";
		if(document.citationSearchForm.authorflag.value == 1&& escape(citArr[i].author_plain).match(escape(selectedAuthor))){
	        //author = document.createTextNode(citArr[i].author);
			fontTag = document.createElement('font');
			authorDisp = authorDisp.replace(selectedAuthor,'<font color="#FF0000">'+selectedAuthor+'</font>');
			fontTag.innerHTML = authorDisp;
			link1.appendChild(fontTag);
		}else{
			link1.innerHTML = authorDisp;
		}
        if(document.citationSearchForm.search_item.value != ""){
              var temp_searchitem=document.citationSearchForm.search_item.value;
              temp_searchitem=temp_searchitem.replace(/\+|\*/g,'');
              if( escape(citArr[i].author_plain.toLowerCase()).match(escape(temp_searchitem.toLowerCase()) ) ){
                  link1.innerHTML  = citArr[i].author_search ;
              }
        }

		td.appendChild(link1);
// Year
        td = tr.insertCell(tr.cells.length);
        td.setAttribute("valign","top");
		td.innerHTML=citArr[i].year;
            var cnt = (document.summarypage.TopRecordsPerSummary.value*(document.summarypage.TopPageInput.value-1))+(i+1);

// Title
        titleLnk = document.createElement('a');
		titleLnk.setAttribute("alt", "Go to reference");
		titleLnk.setAttribute("title", "Go to reference");
        titleLnk.setAttribute("href", "javascript:void(0)");
		
        titleLnk.onclick = new Function("viewCitation('"+citArr[i].id+"','"+cnt+"',' ','"+currentFolderName+"','"+pguid+"','"+citArr[i].refID+"')");
        td = tr.insertCell(tr.cells.length);
		if (citArr[i].title.length >= 1) {
			titleLnk.innerHTML = citArr[i].title;
		}else{
			var title = document.createTextNode('<'+'untitled'+'>');
			titleLnk.appendChild(title);
		}

        td.appendChild(titleLnk);
		if (citArr[i].titleLinks.length > 1) {
			var newdiv = document.createElement("div");
			newdiv.innerHTML = citArr[i].titleLinks;
			try{
				dojo.parser.parse(newdiv);
			}catch(e){
				alert(e);
			};
			td.appendChild(newdiv);
		}
	}
	var uid = "Xk0MeArsC7QAAHnXR0o";
	var refIDs = arguments[4];
	if(folderId.indexOf("_") == -1 && refIDs!=""){
	dojo.xhrPost({
                    url      : "EndNoteWeb.html?func=getAttachmentsCount&uid="+uid+"&refIDs="+refIDs,
                    handleAs: 'json',
                    preventCache : true,
                     load     : function (data){
									if(data.isError){
										alert(data.errorMessage);
									}
									else{
										setAttachmentLinks(data,citArr);
									}
							   }
					});
	}
}

function viewCitation(citId, cnt, reclink,currentFolderName,pguid,refID,pageSource){
	if(pageSource=='ViewCitation'){
	currentFolderName = unescape(currentFolderName);
		}
    currentFolderName = escape(currentFolderName);
    cnts = (cnt.indexOf('/') != -1) ? cnt : cnt+"/"+document.summarypage.citation_count.value;
    var currentFolderId = document.summarypage.current_folder_id.value;
	var attachedFlag= document.summarypage.trash_attached_flag.value;
	var pageno= document.summarypage.TopPageInput.value;
    //currentFolderId = currentFolderId.replace(/_/g,":");
    currentFolderId = currentFolderId.replace(/_([^_]*)$/, ":" + "$1");
    var view_url;
	if(currentFolderId !=0){

	if(document.getElementById("idShowGettingStarted")){
	document.getElementById("idShowGettingStarted").style.display = "none";	
	}
	if(document.getElementById("idGuideLink")){
	document.getElementById("idGuideLink").style.display = "none";	
	}

	}
	if(attachedFlag == -1){

	// First disable the present link
		if(('0' == '1') && (currentFolderId.indexOf('-'))) {
			oldFolderId =  (currentFolderId).replace(/pguid-/,"");
		}
		else {
			oldFolderId =  currentFolderId;
		}
		if(document.getElementById("idFolderLink_"+oldFolderId)) {
			oldFolderClass = document.getElementById("idFolderLink_"+oldFolderId).className;
		}
        oldFolderClass1 =  (oldFolderClass == "sideL1Active") ? "sideL1" : 
        					((oldFolderClass == "folderActive") ? "folder" : 
        						((oldFolderClass == "sideL1Active") ? "sideL1Last" : "")
        					);
         if(oldFolderClass1 && document.getElementById("idFolderLink_"+oldFolderId)){			
        	document.getElementById("idFolderLink_"+oldFolderId).className = oldFolderClass1;
        }  

	// Highlight new folder id
		var newFolderId =  -1;        
        if(document.getElementById("idFolderLink_"+newFolderId)){
        newFolderClass = document.getElementById("idFolderLink_"+newFolderId).className;
		if (! newFolderClass.match('Active')) {
        document.getElementById("idFolderLink_"+newFolderId).className = (newFolderClass == "sideL1") ? "sideL1Active" : 
                                                                           ((newFolderClass == "folder") ? "folderActive" : 
        						                                             ((newFolderClass == "sideL1Last") ? "sideL1Active" : "")
        						                                           );
		}
	}
    	document.summarypage.current_folder_id.value = -1;    
            	
    }




	if('0' == '1') {
		if(refID == undefined) {
			refID = document.summarypage.refID.value;
		}		
	}
    if (currentFolderId.indexOf(':') != -1) {
		view_url = "EndNoteWeb.html?func=view&ids="+citId+"&folder_id="+currentFolderId+"&currentFolderName="+currentFolderName+"&cnts="+cnts+"&flag="+attachedFlag+"&useSharedTable=1&ajaxCall=1&pageno="+pageno+"&refID="+refID;
    }else{
		view_url = "EndNoteWeb.html?func=view&ids="+citId+"&folder_id="+currentFolderId+"&currentFolderName="+currentFolderName+"&pguid="+pguid+"&flag="+attachedFlag+"&cnts="+cnts+"&ajaxCall=1&pageno="+pageno+"&refID="+refID;
    }
    var duplicate = document.getElementById("idDuplicate").value;
    if(duplicate != ""){
        view_url += "&duplicate="+duplicate;
    }
    var manageAttachments = document.getElementById("idmanageAttachments").value;
    if(manageAttachments == "yes"){
        view_url += "&manageAttachments="+manageAttachments;
    }
	if (currentFolderId == 'EL') {
        view_url += "&quickList="+1;
	}
	if (document.citationSearchForm.search_item.value != "undefined") {
        view_url += "&hl="+encodeURIComponent(document.citationSearchForm.search_item.value)+"&searchField="+document.citationSearchForm.searchField.value;
	}
    if(document.getElementById("idSortField").value){
        view_url += "&sortField="+document.getElementById("idSortField").value+"&sortOrder="+document.getElementById("idSortOrder").value;
	}
    if(document.citationSearchForm.authorflag.value != "undefined"){
        view_url += "&authorsearchflag="+document.citationSearchForm.authorflag.value;
	}
    if(reclink){
        view_url += "&reclink="+reclink;
    }
// Hide List View and display progress indicator
        if(document.getElementById("idShowCitations").style.display == "inline" || document.getElementById("idEditCitation").style.display == "inline"){
            document.getElementById("idShowCitations").style.display = "none";
            document.getElementById("idEditCitation").style.display = "none";
            document.getElementById("idSpinProgress").style.display = "inline";
        }

        dojo.xhrGet({
                    url      :  view_url,
                    preventCache : true,
                    sync : true,
                    load     : function (data){
	                                   if((!!navigator.userAgent.match(/Trident.*rv[ :]*11\./)) || dojo.isIE || dojo.isSafari || dojo.isChrome || dojo.isOpera ||  ( dojo.isFF > 3) ){
	                                       evalScripts(data);
									   }
                                       var newdiv = document.createElement("div");
                                       newdiv.innerHTML = data;
                                       var parentDiv = document.getElementById("idViewCitation");
									   dojo.query('[widgetId]', parentDiv).forEach(function(n) { try { dijit.byNode(n).destroyRecursive(); }catch(e){}; });

									   // Removing undestroyed widgets from dijit registry
									   dojo.query('[widgetId]', parentDiv).forEach(function(n) {   try { dijit.registry.remove(n.id) ; dojo.byId(n.id).parentNode.removeChild(n);   }catch(e){  } });
                                       if(parentDiv.hasChildNodes()){
                                           parentDiv.removeChild(parentDiv.lastChild);
                                       }
                                       document.getElementById("idViewCitation").appendChild(newdiv);
                                       document.getElementById("idSpinProgress").style.display = "none";
                                       document.getElementById("idViewCitation").style.display = "inline";
									   getGroupsInfo(citId,currentFolderId);
									   try{
											dojo.parser.parse(document.getElementById("idViewCitation"));
											setTabOrder();
									   }catch(e){
											//alert(e);
									   };

                               },
					error	: citationErrorHandler
                 });
}

function editCitation(citId,cnt){
    cnts = (cnt.indexOf('/') != -1) ? cnt : cnt+"/"+document.summarypage.citation_count.value;
	var currentFolderId = document.summarypage.current_folder_id.value;
    var view_url = "EndNoteWeb.html?func=edit&ids="+citId+"&folder_id="+currentFolderId+"&cnts="+cnts+"&ajaxCall=1";
    var duplicate = document.getElementById("idDuplicate").value;
    if(duplicate != ""){
        view_url += "&duplicate="+duplicate;
    }
	if (currentFolderId == 'EL') {
        view_url += "&quickList="+1;
	}
	if (document.citationSearchForm.search_item.value != "undefined") {
        view_url += "&hl="+document.citationSearchForm.search_item.value+"&searchField="+document.citationSearchForm.searchField.value;
	}
    if(document.getElementById("idSortField").value){
        view_url += "&sortField="+document.getElementById("idSortField").value+"&sortOrder="+document.getElementById("idSortOrder").value;
	}
    if(document.citationSearchForm.authorflag.value != "undefined"){
        view_url += "&authorsearchflag="+document.citationSearchForm.authorflag.value;
	}

// Hide List View and display progress indicator
        if(document.getElementById("idShowCitations").style.display == "inline" || document.getElementById("idViewCitation").style.display == "inline"){
            document.getElementById("idShowCitations").style.display = "none";
            document.getElementById("idViewCitation").style.display = "none";
            document.getElementById("idSpinProgress").style.display = "inline";
        }

        dojo.xhrGet({
                    url      :  view_url,
                    preventCache : true,
                    load     : function (data){
                                       var newdiv = document.createElement("div");
                                       newdiv.innerHTML = data;
                                       var parentDiv = document.getElementById("idEditCitation");
                                       if(parentDiv.hasChildNodes()){
                                           parentDiv.removeChild(parentDiv.lastChild);
                                       }
                                       parentDiv = document.getElementById("idViewCitation");
                                       if(parentDiv.hasChildNodes()){
										   parentDiv.removeChild(parentDiv.lastChild);
                                       }
                                       document.getElementById("idEditCitation").appendChild(newdiv);
										//evaluating the javascript code that is dynamically loaded
                                       evalScripts( data );
								       document.getElementById("idSpinProgress").style.display = "none";
                                       document.getElementById("idEditCitation").style.display = "inline";
                               },
					error	: citationErrorHandler
                 });
}

function saveCitation(form){
			  var save_url = "/collect/addCitation?ids="+citId+"&folder_id="+document.summarypage.current_folder_id.value;
              form.submit();
}


function emptyTrash(citId,currentFolderId){
        if(confirm('Are you sure you want to permanently delete the reference(s) in Trash?\nThis action can not be undone.')){
              document.getElementById("idTrashFolderLinkDeleteProgress").style.display = "inline";
              dojo.xhrGet({
                    url      : "EndNoteWeb.html?func=MoveToTrash&currentFolderId=-1&emptyTrash=1",
                    preventCache : true,
                    load     : function (data){
										noPerPage = document.summarypage.TopRecordsPerSummary.value;
										var currentFolderId=document.summarypage.current_folder_id.value;
										if (currentFolderId == -1) {
												loadCitations(1, noPerPage, currentFolderId);
										}
										getGroupsInfo(citId,currentFolderId);
                                        document.getElementById("idTrashFolderLinkDeleteProgress").style.display = "none";
                               },
					error	: function(response, ioArgs) { 
									window.location.reload(true);
							}
                     });
        }
}

function setGettingStartedGuide(flag){
    var hideGettingStartedGuideLink = '<a href="javascript:void(0);" onclick=javascript:setGettingStartedGuide(\"hide\") title="' + 'Hide Getting Started Guide' + '" alt="' + 'Hide Getting Started Guide' + '">' + 'Hide Getting Started Guide' + '</a>';
    var showGettingStartedGuideLink = '<a href="javascript:void(0);" onclick=javascript:setGettingStartedGuide(\"show\") title="' + 'Show Getting Started Guide' + '" alt="' + 'Show Getting Started Guide' + '">' + 'Show Getting Started Guide' + '</a>';
    if(document.getElementById("idEditCitation").style.display == "inline"){
        document.getElementById("idEditCitation").style.display = "none";
    }else if(document.getElementById("idViewCitation").style.display == "inline"){
        document.getElementById("idViewCitation").style.display = "none";
    }
    if ('0' == '0') {
        if(flag == 'show'){
			document.getElementById("idGuideLink").innerHTML = hideGettingStartedGuideLink;
			document.getElementById("idShowGettingStarted").style.display = "inline";
			document.getElementById("idShowCitations").style.display = "none";
        }
        else if(flag == 'hide'){
			document.getElementById("idGuideLink").innerHTML = showGettingStartedGuideLink;
			document.getElementById("idShowGettingStarted").style.display = "none";			
			document.getElementById("idShowCitations").style.display = "inline";
        }
	}
	
        
        dojo.xhrGet({
                    url      : "EndNoteWeb.html?func=setGuideState&setGuideState="+flag,
                    preventCache : true,
					load : function (data){					
						if(data > 0 && '0' == '1') {
							getGettingStartedStatus();
							if(flag == 'hide') {
								loadCitations(1, document.summarypage.TopRecordsPerSummary.value,document.summarypage.current_folder_id.value);
							}
						}
					},
					error	: function(response, ioArgs) { 
								//reload page if session expires
								window.location.href = window.location.protocol+"://"+window.location.host+window.location.pathname;
							}
                 });	 
	 
		if ('0' == '0') {
			getGettingStartedStatus();
		}
	if ('0' == '1') {
		if(flag == 'show'){
			document.getElementById("idGuideLink").innerHTML = hideGettingStartedGuideLink;
			document.getElementById("idShowGettingStarted").style.display = "inline";
			document.getElementById("idShowCitations").style.display = "none";
        }
        else if(flag == 'hide'){
			document.getElementById("idGuideLink").innerHTML = showGettingStartedGuideLink;
			document.getElementById("idShowGettingStarted").style.display = "none";			
			document.getElementById("idShowCitations").style.display = "inline";
        }
	}
		 

}
function searchAuthor(searchItem){
        document.citationSearchForm.search_item.value = searchItem;
        document.citationSearchForm.authorflag.value = 1;
		if("" == '1') {
			document.citationSearchForm.authorflag.value = 0;
		}
        document.citationSearchForm.selectedAuthor.value = searchItem;
		document.getElementById("idSortField").value = "";
		document.getElementById("idSortOrder").value = "";
		var folderId = document.summarypage.current_folder_id.value;		
		if (folderId.indexOf('_') == -1) {
			folderId = 0;
		}
		loadCitations(1, document.summarypage.TopRecordsPerSummary.value, folderId);
}
function changeFolders(myForm,selectedFolderId,folderName,chkIdStr,cnt,ref_Id)
{
	
	if(selectedFolderId != undefined && !selectedFolderId.match(/^(-1|\d+|EL|(.*?):\d+)$/) && (selectedFolderId != 'Create New Group')) {
		selectedFolderId ="";
	}
	var pageSource;
	var suppRefRestore=document.getElementById("idRestoreval").value;
	if(arguments[4] == undefined ){
	 pageSource = "showCitation";
	}
	else { pageSource = "viewCitation"; }

	var currentFolderId=document.summarypage.current_folder_id.value;
    //currentFolderId = currentFolderId.replace(/_/g,":");
    currentFolderId = currentFolderId.replace(/_([^_]*)$/, ":" + "$1");
	var progressImgId;
if(currentFolderId == -1)
 {
	progressImgId = "restore_progress_indicator_container";
 }else{
	progressImgId = "copy_move_progress_indicator_container";
 }
	document.getElementById(progressImgId).style.display = "inline";
	if(folderName == undefined)
		folderName = "";
	selectedFolderId = selectedFolderId+"";
    //document.getElementById('progress_indicator_image').style.display = "inline";
	var checkedAll =0;
	var isQuickSearch = 0;
	var allChkIdStr='';
	var QuickSearch =document.citationSearchForm.search_item;
	if ((QuickSearch != null) && (QuickSearch.value.length >0)) {
			isQuickSearch = 1;
	}
 if (chkIdStr == undefined) {
	if((myForm.CheckAllRef.checked ||  myForm.checkall.value == 1) || (myForm.CheckPage.checked && '0' == '1' && currentFolderId != 'EL')) {
		if(myForm.CheckAllRef.checked || myForm.checkall.value == 1) {		
			checkedAll=1;
		}
		if (isQuickSearch && '0' == '0') {
			allChkIdStr = document.summarypage.citation_ids.value;
			checkedAll = 0;			
		}
         
		var allChkIdStr;
		var allIds;
		if('0' == '0') {
			allChkIdStr = document.summarypage.citation_ids.value;
			allIds = allChkIdStr.split(" ");
		}

   		var idsArr = document.getElementsByTagName("input");		
   		var unchkIds = new Array();
		for(var i=0; i<idsArr.length; i++){
			if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
				if(!idsArr[i].checked){
				unchkIds.push(idsArr[i].getAttribute("value"));
				}	
			}
		}
		if (isQuickSearch && '0' == '0') {
			if (unchkIds.length > 0) {
				var newres = new Array();
				var allIds = allChkIdStr.split(" ");
				var matched =0;
				for (var i=0; i <allIds.length ; i++){
					matched =0;
					for( var j=0; j< unchkIds.length; j++){
						if (allIds[i] == unchkIds[j]){
							matched = 1;
							break;
						}
					}
					if (matched ==0) {
						newres.push(allIds[i]);
					}
				}
				chkIdStr = newres.join(' ');
			}else{
			chkIdStr = allChkIdStr;
			}
		}else{
		chkIdStr = unchkIds.join(' ');
		}
	}else{
    		var idsArr = document.getElementsByTagName("input");
    		var chkIds = new Array();
   			for(var i=0; i<idsArr.length; i++){
       			if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
           			if(idsArr[i].checked){
           				chkIds.push(idsArr[i].getAttribute("value"));
           			}	
       			}
   			}
   			chkIdStr = chkIds.join(' ');
			if ('0' == '1' && chkIdStr == undefined) {
				return false;
			}
    }
 }
 	if ('0' == '0' && chkIdStr == undefined) {
		return false;
	}
	var dojoUrl,IsGroupSet;
	var pguid = document.summarypage.pguid.value;
	if ('0' == '1'){
	selectedFolderId=selectedFolderId.replace('cguid_','');
	selectedFolderId=selectedFolderId.replace('shared_','');
	}else{
	selectedFolderId=selectedFolderId.replace('shared_','');
	}
    if((currentFolderId.indexOf(':') != -1) || (selectedFolderId.indexOf(':') != -1))
	{
		if((currentFolderId.indexOf(':') != -1) && (selectedFolderId.indexOf(':') != -1)){			
			dojoUrl="EndNoteWeb.html?func=addToSharedGroup&useSharedTable=1&currentFolderId=" + currentFolderId + "&selectedFolder_Id=" + selectedFolderId + "&fromShared=1&";
		}else if(selectedFolderId.indexOf(':') != -1) {
				if((currentFolderId == 0) || (currentFolderId == 1) || ( pguid.length == 0 && currentFolderId != 'EL' && isQuickSearch == 0) || (currentFolderId.match(/pguid/))){
					IsGroupSet = 1;
				}else{
					IsGroupSet =0;
				}

			dojoUrl= "EndNoteWeb.html?func=addToSharedGroup&useSharedTable=1&currentFolderId=" + currentFolderId + "&selectedFolder_Id=" + selectedFolderId + "&"+"IsGroupSet="+IsGroupSet;
        }else if(currentFolderId.indexOf(':') != -1) {
			dojoUrl="EndNoteWeb.html?func=copySharedRecs&currentFolderId=" + currentFolderId + "&selectedFolder_Id=" + selectedFolderId + "&folderName="+folderName;
		} 	
		var QsearchItem = document.citationSearchForm.search_item;
		if (QsearchItem != null && QsearchItem.value.length  >0) {
			dojoUrl = dojoUrl +"&qsearchItem="+encodeURIComponent(QsearchItem.value)+"";
		}
	if(myForm.CheckPage != null) {
	   if(myForm.CheckPage.checked) {
		   var page_no = document.summarypage.PageNum.value;
		   dojoUrl += "&checkedPage=1&page="+page_no+"&";
	   }
	}
	} else{
			if((currentFolderId == -1)  && (suppRefRestore=='yes') )
              {
                  dojoUrl = "EndNoteWeb.html?func=addToGroup&Restore=yes&selectedFolderId=&folderName="+folderName+"&currentFolderId="+currentFolderId+"&";
				   if('0' == '1') {
						if(myForm.CheckPage != null) {
					   if(myForm.CheckPage.checked) {
						   var page_no = document.summarypage.PageNum.value;
						   if(document.getElementById("idSortField").value) {
							   dojoUrl += "sortField="+document.getElementById("idSortField").value+"&sortOrder="+document.getElementById("idSortOrder").value+"&";
						   }
						   dojoUrl += "checkedPage=1&page="+page_no+"&";
					   }
				   }
				   }
 
               }else{
                     dojoUrl = "EndNoteWeb.html?func=addToGroup&selectedFolderId="+selectedFolderId+"&folderName="+folderName+"&currentFolderId="+currentFolderId;
	 				   if('0' == '1') {
						if(myForm.CheckPage != null) {
						   if(myForm.CheckPage.checked) {
							   var page_no = document.summarypage.PageNum.value;
							   if(document.getElementById("idSortField").value) {
								   dojoUrl += "&sortField="+document.getElementById("idSortField").value+"&sortOrder="+document.getElementById("idSortOrder").value+"&";
							   }
							   dojoUrl += "&checkedPage=1&page="+page_no+"&";
						   }
					   }

							if((currentFolderId == -1) ||  (currentFolderId == 0) || (currentFolderId == 1) || (pguid.length == 0 && currentFolderId != 'EL')){								
								IsGroupSet = 1;
							}else{
								IsGroupSet =0;
							}
							var QsearchItem = document.citationSearchForm.search_item;
							if (QsearchItem != null && QsearchItem.value.length  >0) {
								dojoUrl = dojoUrl +"&qsearchItem="+encodeURIComponent(QsearchItem.value)+"";
							}
							dojoUrl = dojoUrl+"&IsGroupSet="+IsGroupSet;
						}
               }
	 }
		if (checkedAll == 1) {
			dojoUrl = dojoUrl+"&checkedAll="+checkedAll+"&";
			checkedAll=0;
		}
		
	dojo.xhrPost({
		url      : dojoUrl,
		content: {'ids':chkIdStr},
	    preventCache : true,
		load     : function (data){
			              if(data==28)
							{
								if (document.getElementById('copy_move_progress_indicator_container')) {
										document.getElementById('copy_move_progress_indicator_container').style.display = "none";
								}
							     alert("Selected group no longer exists");
								 return true;
						
							}
							if(data != 1){
							if(pageSource == "showCitation"){
								if(data == 0 && chkIdStr.length < 1) {
									alert("Please check one or more references then select a group.");
								}							
								else {
								if (data == -1) {
								  document.getElementById("displayErrorMsg").childNodes[0].innerHTML = 'You no longer have the ability to add and edit records in the shared group.';
								document.getElementById("displayErrorMsg").style.display = "inline";
								}else{								
								document.getElementById("displayErrorMsg").childNodes[0].innerHTML = data;
								document.getElementById("displayErrorMsg").style.display = "inline";
								}								
							}						
								
							   getGroupsInfo("",currentFolderId);
							}
							else
							{
								if (data == -1) {
								  document.getElementById("ErrorMsgViewCitation").childNodes[0].innerHTML = 'You no longer have the ability to add and edit records in the shared group.';
								}
								else {
								  document.getElementById("ErrorMsgViewCitation").childNodes[0].innerHTML = data;
								}
							document.getElementById("ErrorMsgViewCitation").style.display = "inline";
							getGroupsInfo("",currentFolderId);
							}
						}else{
							var refId = "";							
							if (cnt != undefined) {								
								if(currentFolderId == -1)
								{
									chkIdStr = myForm.nextID.value;
								}
								refId = chkIdStr;
								viewCitation(chkIdStr,cnt,'',folderName,pguid,ref_Id);

							}else if (currentFolderId == -1 || currentFolderId == 1 || currentFolderId.indexOf(':') != -1) {
								noPerPage = document.summarypage.TopRecordsPerSummary.value;								
								var page_no = parseInt(document.summarypage.PageNum.value ) || 1;
								loadCitations(page_no, noPerPage, currentFolderId);
							}
							getGroupsInfo(refId,currentFolderId);
						}
							document.getElementById('progress_indicator_image').style.display = "none";
							document.getElementById('restore_progress_indicator_container').style.display = "none";
							document.getElementById('copy_move_progress_indicator_container').style.display = "none";

				   },
		error	: function(response, ioArgs) {
//							alert('Error while copying records! ');
//							console.error(response);
							window.location.reload(true);
					}
	});
    document.getElementById("idCheckPage").checked = false;
    document.getElementById("idCheckAllRef").checked = false;	
	if(myForm.checkall)
		myForm.checkall.value = 0;
// Uncheck the checked citations
	var idsArr = document.getElementsByTagName("input");
	for(var i=0; i<idsArr.length; i++){
		if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
    		if(idsArr[i].checked){
     			idsArr[i].checked = false;
     		}	
       	}
   	}		
	var divId = "idAddToGroup_listView";
	if(document.getElementById('idViewCitation').style.display == "inline")
		divId = "idAddToGroup_view";
	var thisSelect = document.getElementById(divId);
	if(thisSelect != null)
		thisSelect.options[0].selected=true;

	return false;
}

function changeFoldersGs(myForm,selectedFolderId,folderName,groupsetguid,chkIdStr,cnt,currentFolderName)
{
	var pageSource;
	var suppRefRestore=document.getElementById("idRestoreval").value;
	if(arguments[5] == undefined ){
	 pageSource = "showCitation";
	}
	else { pageSource = "viewCitation"; }

	var currentFolderId=document.summarypage.current_folder_id.value;
    currentFolderId = currentFolderId.replace(/_/g,":");
	var progressImgId;
if(currentFolderId == -1)
 {
	progressImgId = "restore_progress_indicator_container";
 }else{
	progressImgId = "copy_move_progress_indicator_container";
 }
	document.getElementById(progressImgId).style.display = "inline";
	if(folderName == undefined)
		folderName = "";
	selectedFolderId = selectedFolderId+"";
    //document.getElementById('progress_indicator_image').style.display = "inline";
	var checkedAll =0;
	var isQuickSearch = 0;
	var allChkIdStr='';
	var QuickSearch =document.citationSearchForm.search_item;
	if ((QuickSearch != null) && (QuickSearch.value.length >0)) {
			isQuickSearch = 1;
	}
 if (chkIdStr == undefined) {
	if(myForm.CheckAllRef.checked || (myForm.CheckPage.checked && '0' == '1') && currentFolderId != 'EL') {
		if(myForm.CheckAllRef.checked) {
			checkedAll=1;
		}
		if (isQuickSearch && '0' == '0') {
			allChkIdStr = document.summarypage.citation_ids.value;			
				checkedAll = 0;			
		}
		var allChkIdStr; 
		var allIds;
        if('0' == '0') {
		allChkIdStr = document.summarypage.citation_ids.value;
		allIds = allChkIdStr.split(" ");
		}

   		var idsArr = document.getElementsByTagName("input");
   		var unchkIds = new Array();
		for(var i=0; i<idsArr.length; i++){
			if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
				if(!idsArr[i].checked){
				unchkIds.push(idsArr[i].getAttribute("value"));
				}	
			}
		}
		if (isQuickSearch && '0' == '0') {
			if (unchkIds.length > 0) {
				var newres = new Array();
				var allIds = allChkIdStr.split(" ");
				var matched =0;
				for (var i=0; i <allIds.length ; i++){
					matched =0;
					for( var j=0; j< unchkIds.length; j++){
						if (allIds[i] == unchkIds[j]){
							matched = 1;
							break;
						}
					}
					if (matched ==0) {
						newres.push(allIds[i]);
					}
				}
				chkIdStr = newres.join(' ');
			}else{
			chkIdStr = allChkIdStr;
			}
		}else{
		chkIdStr = unchkIds.join(' ');
		}
	}else{
    		var idsArr = document.getElementsByTagName("input");
    		var chkIds = new Array();
   			for(var i=0; i<idsArr.length; i++){
       			if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
           			if(idsArr[i].checked){
           				chkIds.push(idsArr[i].getAttribute("value"));
           			}	
       			}
   			}
   			chkIdStr = chkIds.join(' '); 
			if ('0' == '1' && chkIdStr == undefined) {
				return false;
			}
    }
 }
 	if ('0' == '0' &&  chkIdStr == undefined) {
		return false;
	}
	var dojoUrl,IsGroupSet;
    if((currentFolderId.indexOf(':') != -1) || (selectedFolderId.indexOf(':') != -1))
	{
		if((currentFolderId.indexOf(':') != -1) && (selectedFolderId.indexOf(':') != -1)){			
			dojoUrl="EndNoteWeb.html?func=addToSharedGroup&useSharedTable=1&currentFolderId=" + currentFolderId + "&selectedFolder_Id=" + selectedFolderId + "&fromShared=1&";
		}else if(selectedFolderId.indexOf(':') != -1) {
			dojoUrl= "EndNoteWeb.html?func=addToSharedGroup&useSharedTable=1&currentFolderId=" + currentFolderId + "&selectedFolder_Id=" + selectedFolderId + "&";
        }else if(currentFolderId.indexOf(':') != -1) {
			dojoUrl="EndNoteWeb.html?func=copySharedRecs&currentFolderId=" + currentFolderId + "&selectedFolder_Id=" + selectedFolderId + "&folderName="+folderName+"&groupsetguid=" + groupsetguid + "&";
        } 	
	} else{
			if((currentFolderId == -1)  && (suppRefRestore=='yes') )
              {
                  dojoUrl = "EndNoteWeb.html?func=addToGroup&Restore=yes&selectedFolderId=&folderName="+folderName+"&currentFolderId="+currentFolderId+"&";
 
               }else{
				   if ('0' == '1'){
				dojoUrl = "EndNoteWeb.html?func=addToGroup&selectedFolderId="+selectedFolderId+"&folderName="+folderName+"&currentFolderId="+currentFolderId+"&groupsetguid="+groupsetguid+"&";
				var pguid = document.summarypage.pguid.value;
				if((currentFolderId == -1) ||  (currentFolderId == 0) || (currentFolderId == 'EL') || (currentFolderId == 1) || (pguid.length > 0)) {
					IsGroupSet = 0;
					} else {
						IsGroupSet =1;
					}					   
				   }else{
                     dojoUrl = "EndNoteWeb.html?func=addToGroup&selectedFolderId="+selectedFolderId+"&folderName="+folderName+"&currentFolderId="+currentFolderId+"&";	 				  
	
					}
               }
	 }
		if (checkedAll == 1) {
			dojoUrl = dojoUrl+"&checkedAll="+checkedAll+"&";
			checkedAll=0;
		}
		var QsearchItem = document.citationSearchForm.search_item;
		if (QsearchItem != null && QsearchItem.value.length  >0) {
			dojoUrl = dojoUrl +"qsearchItem="+encodeURIComponent(QsearchItem.value)+"&";
		}
	   if ('0' == '1') {
		   if(myForm.CheckPage != null) {
			   if(myForm.CheckPage.checked) {
				   var page_no = document.summarypage.PageNum.value;
				   if(document.getElementById("idSortField").value) {
					   dojoUrl += "&sortField="+document.getElementById("idSortField").value+"&sortOrder="+document.getElementById("idSortOrder").value+"&";
							   }
						dojoUrl += "&checkedPage=1&page="+page_no+"&";
			   }
		   }
	   }
						
	dojo.xhrPost({
		url      : dojoUrl,
		content: {'ids':chkIdStr,'IsGroupSet':IsGroupSet},
	    preventCache : true,
		load     : function (data){
			              if(data==28)
							{
								if (document.getElementById('copy_move_progress_indicator_container')) {
										document.getElementById('copy_move_progress_indicator_container').style.display = "none";
								}
							     alert("Selected group no longer exists");
								 return true;
						
							}
							if(data != 1){
							if(pageSource == "showCitation"){
								if (data == 0) {
									if(chkIdStr.length < 1) {
										alert("Please check one or more references then select a group.");
									}
									else {
										document.getElementById("displayErrorMsg").childNodes[0].innerHTML ='You have created the maximum number of groups allowed.';
										document.getElementById("displayErrorMsg").style.display = "inline";
									}
								} else {									document.getElementById("displayErrorMsg").childNodes[0].innerHTML = data;
								document.getElementById("displayErrorMsg").style.display = "inline";
								}
							   getGroupsInfo("",currentFolderId);
							}
							else
							{
							document.getElementById("ErrorMsgViewCitation").childNodes[0].innerHTML = data;
							document.getElementById("ErrorMsgViewCitation").style.display = "inline";
							getGroupsInfo("",currentFolderId);
							}
						}else{
							var refId = "";							
							if (cnt != undefined) {								
								if(currentFolderId == -1)
								{
									chkIdStr = myForm.nextID.value;
								}
								refId = chkIdStr;
								viewCitation(chkIdStr,cnt,'',currentFolderName);

							}else if (currentFolderId == -1 || currentFolderId == 1 || currentFolderId.indexOf(':') != -1) {
								noPerPage = document.summarypage.TopRecordsPerSummary.value;
								loadCitations(1, noPerPage, currentFolderId);
							}
							getGroupsInfo(refId,currentFolderId);
						}
							document.getElementById('progress_indicator_image').style.display = "none";
							document.getElementById('restore_progress_indicator_container').style.display = "none";
							document.getElementById('copy_move_progress_indicator_container').style.display = "none";

				   },
		error	: function(response, ioArgs) {
//							alert('Error while copying records! ');
//							console.error(response);
							window.location.reload(true);
					}
	});
    document.getElementById("idCheckPage").checked = false;
    document.getElementById("idCheckAllRef").checked = false;	
// Uncheck the checked citations
	var idsArr = document.getElementsByTagName("input");
	for(var i=0; i<idsArr.length; i++){
		if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
    		if(idsArr[i].checked){
     			idsArr[i].checked = false;
     		}	
       	}
   	}		
	var divId = "idAddToGroup_listView";
	if(document.getElementById('idViewCitation').style.display == "inline")
		divId = "idAddToGroup_view";
	var thisSelect = document.getElementById(divId);
	if(thisSelect != null)
		thisSelect.options[0].selected=true;

	return false;
}

function  getGroupsInfo(citId,folderId){
	var url = "EndNoteWeb.html?func=getGroupsInfo";
	if(citId)
	{
		url = url+"&citId="+citId;
	}
	dojo.xhrGet({
                    url      : url,
                    handleAs: 'json',
                    preventCache : true,
                    load     : function (data){
										updateLeftNav(data,citId,folderId);
										updateQuickSearchGroups(data);
										if(citId == "")
										{  
											if((document.getElementById('idRestoreval').value=='yes') &&  (folderId==-1) )
											{
													//updateAddToGroups(data,folderId);
											}else
											{
													 updateAddToGroups(data,folderId);
											}


										}
                               },
					error	: citationErrorHandler
					});
 }

function updateLeftNav(data,citId,currFolderId){
	grpData = data; //.parseJSON();
	grpArr = grpData.DATA;

	var sharedGroupsDiv = document.getElementById("sharedDivs");
	if (sharedGroupsDiv){
		//remove shared groups links
		while(sharedGroupsDiv.childNodes.length >0){
			sharedGroupsDiv.removeChild(sharedGroupsDiv.childNodes[0]);
		}
	}
    if('0' == '0') {
	document.getElementById("default_group_set").innerHTML="";
	for (var i=0;i<grpArr.length;i++) 
	{
		var folderId = grpArr[i].folderId+"";
		var currFolderId = currFolderId+"";
		var AddToGroupEle="";
		
		if(currFolderId.indexOf(':') != -1)
		{
			currFolderId = currFolderId.replace(/:/g,"_");
		}


		if(folderId.indexOf(':') != -1)
		{
			folderId = folderId.replace(/:/g,"_");
		}
		
		if(folderId.indexOf('_') != -1){
				if (sharedGroupsDiv.childNodes.length == 0){
					div = document.createElement('div');
					div.className="sideHead";
					div.appendChild(document.createTextNode('Groups Shared by Others'));
					sharedGroupsDiv.appendChild(div);
				}
				div = document.createElement('div');
				if (currFolderId == folderId){
					div.className="folderActive";
				}else{
					div.className="folder";
				}
				div.setAttribute("id","idFolderLink_"+folderId);
				anchor = document.createElement('a');
				anchor.setAttribute("href", "javascript:void(0)");			
				anchor.setAttribute("title", 'View references in this group');
				anchor.setAttribute("alt", 'View references in this group');
				anchor.onclick = new Function("changeFolderNavigation('"+grpArr[i].folderId+"')");
				anchor.innerHTML=manualEncode(grpArr[i].groupText);
				div.appendChild(anchor);

				if (grpArr[i].perm == "rw"){
					div.appendChild(document.createTextNode(' '));
					rwImg = document.createElement('img');
					rwImg.setAttribute("src", '/images/en_us'+'/readwrite.gif');			
					rwImg.setAttribute("title", 'You can add and edit references in the group.');
					rwImg.setAttribute("alt", 'You can add and edit references in the group.');
					rwImg.setAttribute("align", "absbottom");
					div.appendChild(rwImg);
				}
				sharedGroupsDiv.appendChild(div);

		}else if (document.getElementById("idFolderLink_"+folderId)) 
		{
			var parentNode = document.getElementById("idFolderLink_"+folderId);
		    parentNode.childNodes[0].innerHTML = manualEncode(grpArr[i].groupText);	
			if(folderId == 'EL' && !dojo.isIE) {
				parentNode.childNodes[1].innerHTML = manualEncode(grpArr[i].groupText);
			}
		 		if (grpArr[i].folderId == -1){
				if(grpArr[i].trashCount>0 ) {
					document.getElementById("emptyTrashId").style.display="inline";
					if(0 == 1){
						document.getElementById("idEmptyTrash").onclick = "javascript:void(0)";
					}else{
						document.getElementById("idEmptyTrash").onclick = function(){emptyTrash(citId,currFolderId);}
					}
				}else{
					document.getElementById("emptyTrashId").style.display="none";
				}
			}
		}else{
			parentTag = document.getElementById("default_group_set");
			div = document.createElement('div');
			//div.className="folder";
			if (currFolderId == folderId){
					div.className="folderActive";
				}else{
					div.className="folder";
				}
			div.setAttribute("id","idFolderLink_"+grpArr[i].folderId);
			anchor = document.createElement('a');
			anchor.setAttribute("href", "javascript:void(0)");	
			var foldertext = grpArr[i].shortFolder;
			var altText= grpArr[i].groupName;
		     foldertext = foldertext.replace(/&nbsp;/g, " ");
			//anchor.setAttribute("title", "View references in "+foldertext);
			//anchor.setAttribute("alt", "View references in "+foldertext);
			var altmsg = 'View references in GROUP_NAME_TOKEN';
			altmsg = altmsg.replace(/GROUP_NAME_TOKEN/,altText);
			anchor.setAttribute("title",altmsg);
			anchor.setAttribute("alt", altmsg);
			anchor.onclick = new Function("changeFolderNavigation('"+grpArr[i].folderId+"')");

			anchor.innerHTML=manualEncode(grpArr[i].groupText)+" ";
			div.appendChild(anchor);
			var published=grpArr[i].published;
			
			if(published == 1) {
				 anchor = document.createElement('a');
			     anchor.setAttribute("href", "EndNoteWeb.html?func=showShareSetting&groupType=myGroups&folderid="+folderId+"&");	
				 shareimg = document.createElement('img');
				 shareimg.setAttribute("src", '/images/en_us'+'/sharedIndicator.gif');			
				 shareimg.setAttribute("title", 'This group is shared to other EndNote users. Go to manage sharing for this group.');
				 shareimg.setAttribute("alt", 'This group is shared to other EndNote users. Go to manage sharing for this group.');
				 shareimg.setAttribute("name", 'sharedIndicator');
				 shareimg.setAttribute("id", 'sharedIndicator');
				 shareimg.setAttribute("border","0");
				 shareimg.setAttribute("align", "absbottom");
				 anchor.appendChild(shareimg);
				 div.appendChild(anchor);
			 }
			
			if(grpArr[i+1].grpType == 0 && grpArr[i+1].folderId != 1){
				parentTag.insertBefore(div, document.getElementById("idFolderLink_"+grpArr[i+1].folderId));
			}else{
				parentTag.insertBefore(div, document.getElementById("idFolderLink_endUserFolder"));
			}			
		}
	}
}

	else {
		for (var j=0;j<grpArr.length;j++) {
			var grpsArr = grpArr[j].groups;
			var groupsetfolderId = grpArr[j].folderId;
			if(document.getElementById("count"+groupsetfolderId) != undefined) {			
				document.getElementById("count"+groupsetfolderId).innerHTML	= " ("+grpArr[j].count+")";
			}
		if ((currFolderId == groupsetfolderId)  && (currFolderId != 'EL') && ((document.citationSearchForm.search_item.value).length < 1 )) {		
				document.summarypage.citation_count.value = grpArr[j].count;
				
		}

			if (grpArr[j].folderId == -1) {			
							if(grpArr[j].count > 0 ) {							
								document.getElementById("emptyTrashId").style.display="inline";
								if(0 == 1) {
									document.getElementById("idEmptyTrash").onclick = "javascript:void(0)";
									} else {
										document.getElementById("idEmptyTrash").onclick = function(){emptyTrash(citId,currFolderId);
										}									
									}
							}
							else {
								document.getElementById("emptyTrashId").style.display="none";
							}
						}
						if (grpArr[j].folderId == -1 || grpArr[j].folderId == 0 || grpArr[j].folderId == 1 ) {
							var parentNode = document.getElementById("idFolderLink_"+grpArr[j].folderId);						
							parentNode.childNodes[0].innerHTML = manualEncode(grpArr[j].groupText);						
						}
						if(grpArr[j].folderId == 'EL') {
							var parentNode = document.getElementById("idFolderLink_"+grpArr[j].folderId);		
							var txtNode = document.createTextNode(grpArr[j].groupText);
							if(parentNode.childNodes[0].tagName != "A")	{
								parentNode.childNodes[1].replaceChild(txtNode, parentNode.childNodes[1].lastChild);
							}
							else {
								parentNode.childNodes[0].replaceChild(txtNode, parentNode.childNodes[0].lastChild);
							}
						}
			
			if(grpsArr != undefined && grpsArr.length != 0) {
				for (i=0; i < grpsArr.length; i++) {
					if(document.getElementById("count"+grpsArr[i].folderId) != undefined) {				
						document.getElementById("count"+grpsArr[i].folderId).innerHTML	= grpsArr[i].count;
					}
					
					var folderId = grpsArr[i].folderId+"";
					var currFolderId = currFolderId+"";
					var AddToGroupEle="";
					if(currFolderId.indexOf(':') != -1) {
						currFolderId = currFolderId.replace(/:/g,"_");
					}
					if(folderId.indexOf(':') != -1) {
						folderId = folderId.replace(/:/g,"_");
					}
					if (currFolderId == folderId && document.citationSearchForm.search_item.value != "undefined" && (document.citationSearchForm.search_item.value).length < 1 ) {						
						document.summarypage.citation_count.value = grpsArr[i].count;								
					}	
					if(folderId.indexOf('_') != -1) {
						if (sharedGroupsDiv.childNodes.length == 0) {
					//		div = document.createElement('div');
					//		div.className="sideHead";
					//		div.appendChild(document.createTextNode('Groups Shared by Others'));
					//	    sharedGroupsDiv.appendChild(div);
						}
					div = document.createElement('div');
					if (currFolderId == folderId) {
						div.className="folderActive";
					} else {
						div.className="folder";
					}
					div.setAttribute("id","idFolderLink_"+folderId);
					anchor = document.createElement('a');
					anchor.setAttribute("href", "javascript:void(0)");			
					anchor.setAttribute("title", 'View references in this group');
					anchor.setAttribute("alt", 'View references in this group');
					anchor.onclick = new Function("changeFolderNavigation('"+grpsArr[i].folderId+"')");
					
					anchor.innerHTML=manualEncode(grpsArr[i].groupText);
					div.appendChild(anchor);						

					if (grpsArr[i].perm == "rw") {
						div.appendChild(document.createTextNode(' '));
						rwImg = document.createElement('img');
						rwImg.setAttribute("src", '/images/en_us'+'/readwrite.gif');			
						rwImg.setAttribute("title", 'You can add and edit references in the group.');
						rwImg.setAttribute("alt", 'You can add and edit references in the group.');
						rwImg.setAttribute("align", "absbottom");
						div.appendChild(rwImg);
					}
					span =  document.createElement('span');
					span.setAttribute("name", 'sharedIndicator');
					span.setAttribute("style", "display:none");
					span.setAttribute("id", "count"+grpsArr[i].folderId);
					span.innerHTML = grpsArr[i].count;
					div.appendChild(span);
					sharedGroupsDiv.appendChild(div);  
					document.getElementById("count"+grpsArr[i].folderId).style.display="none";
					}
					else if (document.getElementById("idFolderLink_"+folderId)) {
						var parentNode = document.getElementById("idFolderLink_"+folderId);						
						if(parentNode.childNodes[1] != undefined) {
							if(parentNode.childNodes[1].innerHTML != undefined) {							
								parentNode.childNodes[1].innerHTML = grpsArr[i].groupText;
							}
							else if (parentNode.childNodes[0] != undefined) {														
							parentNode.childNodes[0].innerHTML = grpsArr[i].groupText;							
							}
						
						}else{
							parentNode.childNodes[0].innerHTML = grpsArr[i].groupText;	
							}					
					  
					} else {
						parentTag = document.getElementById("default_group_set"+groupsetfolderId);	
											
						div = document.createElement('div');
						if (currFolderId == folderId) {
							div.className="folderActive";
						} else {
							div.className="folder";
						}
						div.setAttribute("id","idFolderLink_"+grpsArr[i].folderId);
						div.innerHTML="&nbsp;";
						anchor = document.createElement('a');
						anchor.setAttribute("href", "javascript:void(0)");	
						var foldertext = grpsArr[i].shortFolder;
						foldertext = foldertext.replace(/&nbsp;/g, " ");
						//anchor.setAttribute("title", "View references in "+foldertext);
						//anchor.setAttribute("alt", "View references in "+foldertext);
						var altmsg = 'View references in GROUP_NAME_TOKEN';
						altmsg = altmsg.replace(/GROUP_NAME_TOKEN/,foldertext);
						anchor.setAttribute("title",altmsg);
						anchor.setAttribute("alt", altmsg);
						anchor.onclick = new Function("changeFolderNavigation('"+grpsArr[i].folderId+"','"+groupsetfolderId+"')");

						anchor.innerHTML=manualEncode(grpsArr[i].groupText)+" ";
						
						var published=grpsArr[i].published;
						if(published == 1) {
							shareimg = document.createElement('img');
							shareimg.setAttribute("src", '/images/en_us'+'/sharedIndicator.gif');			
							shareimg.setAttribute("title", 'This group is shared to other EndNote users. Go to manage sharing for this group.');
							shareimg.setAttribute("alt", 'This group is shared to other EndNote users. Go to manage sharing for this group.');
							shareimg.setAttribute("name", 'sharedIndicator');
							shareimg.setAttribute("id", 'sharedIndicator');
							shareimg.setAttribute("border","0");
							shareimg.setAttribute("align", "absbottom");
						    anchor.appendChild(shareimg);
						}
						div.appendChild(anchor);
						//if(grpsArr[i+1].grpType == 0 && grpsArr[i+1].folderId != 1 && grpsArr[i+1].folderId != undefined)
						if(parentTag != undefined) {
							if(grpsArr[i+1] != undefined) {
								parentTag.insertBefore(div, document.getElementById("idFolderLink_"+grpsArr[i+1].folderId));
							} else {
								parentTag.appendChild(div);
								//parentTag.insertBefore(div, document.getElementById("idFolderLink_endUserFolder"));
							}
						}					
					}
				}
			}
		}
	}
}



function updateQuickSearchGroups(data){
	var groupsSelectBox = document.getElementById('idQuickSearchGroups');
	grpArr = data.DATA;	
	
	// Code to remove shared groups
		if('0' == '1') {
	 grpsSelectBoxLen = groupsSelectBox.options.length;	
	
	for(i = 1 ;i < grpsSelectBoxLen;  i++) {		
		if (groupsSelectBox.options[1].value != undefined) {			
			if(groupsSelectBox.options[1].value == "1") {				
			break;
			}
			
		}
		groupsSelectBox.remove(1);
		
	} 
	}
    grpsSelectBoxLen = groupsSelectBox.options.length;
	var sharedValue = groupsSelectBox.options[grpsSelectBoxLen-1].value+"";
	while(sharedValue.indexOf(':') != -1 || sharedValue == "SharedGroupsHeading" || sharedValue == "SharedGroupsLine"){
		groupsSelectBox.remove(grpsSelectBoxLen-1);
		grpsSelectBoxLen = groupsSelectBox.options.length;
		sharedValue = groupsSelectBox.options[grpsSelectBoxLen-1].value+"";
	} 

	var position = 1;
	var sharedGroupFlag = 0;
    if('0' == '0') {
		for (i = 1 ;i < grpArr.length; i++) {
		if (groupsSelectBox.options[1].value == '1') {
			break;
		}
		groupsSelectBox.remove(1);
	}
	for (i=0;i< grpArr.length; i++) {
		if (grpArr[i].folderId !=0 && grpArr[i].folderId != -1 && grpArr[i].folderId != 1 && grpArr[i].folderId != 'EL' ) {
//grpType:  0 represents personal groups, 1 represents RID groups
			if (grpArr[i].grpType == 0) {
				var groupOptionText = '- '+grpArr[i].groupText.replace(/\s\(.*\)$/g,"");
				groupOptionText = groupOptionText.replace(/\&nbsp;/g," ");
				if (grpArr[i].published == 1) {
					groupOptionText += '*';
				}
				try{
					groupsSelectBox.add(new Option(groupOptionText, grpArr[i].folderId),  groupsSelectBox.options[position]);
				}catch(e){
					groupsSelectBox.add(new Option(groupOptionText, grpArr[i].folderId),position);
				}
				position++;
			}

			//Code to update shared groups
			var folderId = grpArr[i].folderId+"";
			if (folderId.indexOf(':') != -1){
				groupOptionText = '- '+grpArr[i].groupText.replace(/\s\(.*\)$/g,"");
				try{
					if (sharedGroupFlag == 0){
						var lineOption = new Option("--------------------", "SharedGroupsLine");
						lineOption.style.color = "#990033";
						lineOption.disabled = "disabled";
						groupsSelectBox.add(lineOption,null);
						var headingOption = new Option('Groups Shared by Others', "SharedGroupsHeading");
						headingOption.style.color = "#990033";
						headingOption.disabled = "disabled";
						headingOption.style.fontWeight = "bold";
						groupsSelectBox.add(headingOption,null);
						sharedGroupFlag = 1;
					}
					groupsSelectBox.add(new Option(groupOptionText, grpArr[i].folderId),null);
				}catch(e){
					if (sharedGroupFlag == 0){
						var lineOption = new Option("--------------------", "SharedGroupsLine");
						lineOption.style.color = "#990033";
						lineOption.disabled = "disabled";
						groupsSelectBox.add(lineOption);
						var headingOption = new Option('Groups Shared by Others', "SharedGroupsHeading");
						headingOption.style.color = "#990033";
						headingOption.disabled = "disabled";
						headingOption.style.fontWeight = "bold";
						groupsSelectBox.add(headingOption);
						sharedGroupFlag = 1;
					}
					groupsSelectBox.add(new Option(groupOptionText, grpArr[i].folderId));
				}
			}
		}
	}
}
 else
{
	grpsSelectBoxLen = groupsSelectBox.options.length;
for (i=0;i< grpArr.length; i++) {
		if (grpArr[i].folderId !=0 && grpArr[i].folderId != -1 && grpArr[i].folderId != 1 && grpArr[i].folderId != 'EL' && grpArr[i].folderId.indexOf(':') == -1 && !grpArr[i].groupText.match(/Unfiled/) ) {
			
//grpType:  0 represents personal groups, 1 represents RID groups
			if (grpArr[i].grpType == 0) { 
				var grpsArr = "";
				grpsArr = grpArr[i].groups;
				if(grpsArr != undefined && grpsArr.length != 0) {
				var groupOptionText = grpArr[i].groupText.replace(/\s\(.*\)$/g,"");
				groupOptionText = groupOptionText.replace(/\&nbsp;/g," ");
				if (grpArr[i].published == 1) {
					groupOptionText += '*';
				}
				try{					
					var groupoption=new Option(groupOptionText, "pguid-"+grpArr[i].folderId  );
					groupsSelectBox.add(groupoption,groupsSelectBox.options[position]);
				}catch(e){
					var groupoption= new Option(groupOptionText, "pguid-"+grpArr[i].folderId);
					groupsSelectBox.add(groupoption,position);
				}
				position++;
				
				
				
				for (j=0; j < grpsArr.length; j++) {			
					var groupOptionText = grpsArr[j].groupText.replace(/\s\(.*\)$/g,"");
				     groupOptionText = groupOptionText.replace(/\&nbsp;/g," ");
               
				if (grpsArr[j].published == 1) {
					groupOptionText += '*';
				}			
						

				try{
					var groupoption = new Option(groupOptionText, grpsArr[j].folderId);		
					if(!dojo.isIE){ 
					groupoption.innerHTML='&nbsp;&nbsp;&nbsp;'+groupoption.text;
					}
					groupsSelectBox.add(groupoption,groupsSelectBox.options[position]);
				}catch(e){	
                       groupOptionText = '  '+groupOptionText;
					   var groupoption = new Option(groupOptionText, grpsArr[j].folderId);
					   groupoption.style.whiteSpace="pre";
					   groupsSelectBox.add(groupoption,position);
				}  
				position++;

				}
				}


			}
		}
			else {
				
				var folderId = grpArr[i].folderId+"";
			   if (folderId.indexOf(':') != -1){
				var sharedgroups = grpArr[i].groups;
				
				for (j=0; j < sharedgroups.length; j++) {
				groupOptionText = sharedgroups[j].groupText.replace(/\s\(.*\)$/g,"");				
				
				

				try{
					var groupoption = new Option(groupOptionText, sharedgroups[j].folderId);
					if(!dojo.isIE){ 
				    groupoption.innerHTML='&nbsp;&nbsp;&nbsp;'+groupoption.text;
					}
					if (sharedGroupFlag == 0){
						var lineOption = new Option("--------------------", "SharedGroupsLine");
						lineOption.disabled = "disabled";
						lineOption.className = "SharedGroupsLine";
						groupsSelectBox.add(lineOption,null);
						var headingOption = new Option('Groups Shared by Others', "SharedGroupsHeading");						
						headingOption.className="SharedGroupsHeading";
						headingOption.disabled = "disabled";
						groupsSelectBox.add(headingOption,null);
						
						sharedGroupFlag = 1;
					}					
					groupsSelectBox.add(groupoption,null);
				}catch(e){
					groupOptionText = '  '+groupOptionText;
					var groupoption = new Option(groupOptionText, sharedgroups[j].folderId);
					if (sharedGroupFlag == 0){
						var lineOption = new Option("--------------------", "SharedGroupsLine");
						lineOption.disabled = "disabled";
						lineOption.className = "SharedGroupsLine";
						groupsSelectBox.add(lineOption);
						var headingOption = new Option('Groups Shared by Others', "SharedGroupsHeading");
						headingOption.disabled = "disabled";
						headingOption.className="SharedGroupsHeading";
						groupsSelectBox.add(headingOption);
						sharedGroupFlag = 1;
					}
					groupoption.style.whiteSpace="pre";
					groupsSelectBox.add(new Option(groupOptionText, sharedgroups[j].folderId));
				} 
				}
			  
		}
	}
	}  
  } 
}


function updateAddToGroups(data,curFolderId){
	var divId = "idAddToGroup_listView";
	if(document.getElementById('idViewCitation').style.display == "inline")
		divId = "idAddToGroup_view";
	
	var groupsSelectBox = document.getElementById(divId);
	if(curFolderId == -1){
		if(0 == 1){
			document.getElementById(divId).disabled = true;
		}
	}else{
		if(0 == 1 && 0 == 1){
			document.getElementById(divId).disabled = true;
		}else{
			document.getElementById(divId).disabled = false;
		}
	}
	
	var sharedFolder = curFolderId.indexOf("_");
	if(sharedFolder == -1){
		sharedFolder = curFolderId.indexOf(':');
	}
	grpArr = data.DATA;
	var grpsSelectBoxLen = groupsSelectBox.options.length;

		for (i = 1 ;i < grpsSelectBoxLen; i++) {
			if (groupsSelectBox.options[1].value == 'Create New Group') {
				break;
			}
			groupsSelectBox.remove(1);
		}

	if('0' == '0') {
			//Code to remove RID Groups
		grpsSelectBoxLen = groupsSelectBox.options.length;
		var startValue, endValue;
		for(i=1;i<grpsSelectBoxLen;i++){
			if(groupsSelectBox.options[i].value == "RIDGroupsLine"){
				startValue = i;
			}
			if(groupsSelectBox.options[i].value == "SharedGroupsLine"){
				endValue = i;
			}else{
				endValue = grpsSelectBoxLen;
			}
		}
		for(i=endValue;i>=startValue;i--){
			groupsSelectBox.remove(i);
		}

		// Code to remove shared groups
		grpsSelectBoxLen = groupsSelectBox.options.length;
		var sharedValue = groupsSelectBox.options[grpsSelectBoxLen-1].value+"";
		while(sharedValue.indexOf(':') != -1 || sharedValue == "SharedGroupsHeading" || sharedValue == "SharedGroupsLine"){
			groupsSelectBox.remove(grpsSelectBoxLen-1);
			grpsSelectBoxLen = groupsSelectBox.options.length;
			sharedValue = groupsSelectBox.options[grpsSelectBoxLen-1].value+"";
		}

	}else{
		//Code to remove RID Groups
		grpsSelectBoxLen = groupsSelectBox.options.length;
		var startValue, endValue;
		var flag = 0;
		var position = 0;
		for(i=1;i<grpsSelectBoxLen;i++){
			if(groupsSelectBox.options[i].value == "SharedGroupsLine"){	
				position = 1;
				break;
			}
			if(groupsSelectBox.options[i].value == "RIDGroupsLine"){
				position = 2;
				break;
			}
		}
		if(position == 1){
		for(i=1;i<grpsSelectBoxLen;i++){
			if(groupsSelectBox.options[i].value == "SharedGroupsLine"){		
				if(flag==0){
					startValue = i;
				}
				flag = 1;		
			}
			if(groupsSelectBox.options[i].value == "RIDGroupsLine"){
				endValue = i;
			}else{
				endValue = grpsSelectBoxLen;
			}
		}
		for(i=endValue;i>=startValue;i--){
			groupsSelectBox.remove(i);
		}
		}
		if(position == 2){
			for(i=1;i<grpsSelectBoxLen;i++){
			if(groupsSelectBox.options[i].value == "RIDGroupsLine"){		
				if(flag==0){
					startValue = i;
				}
				flag = 1;		
			}
			if(groupsSelectBox.options[i].value == "SharedGroupsLine"){
				endValue = i;
			}else{
				endValue = grpsSelectBoxLen;
			}
		}
		for(i=endValue;i>=startValue;i--){
			groupsSelectBox.remove(i);
		}
		}
	}

	var position = 1;
	var sharedGroupFlag = 0;
	var ridGroupFlag = 0;
if('0' == '0') {
	for (i=0;i< grpArr.length; i++) {
		if (grpArr[i].folderId !=0 && grpArr[i].folderId != -1 && grpArr[i].folderId != 'EL' ) {
			//grpType:  0 represents personal groups, 1 represents RID groups
			if (grpArr[i].grpType == 0) {
				var groupOptionText;
				if(grpArr[i].folderId == 1 && (curFolderId == -1 || curFolderId.indexOf('_') != -1 || curFolderId.indexOf(':') != -1)){					
					groupOptionText = grpArr[i].groupText.replace(/\s\(.*\)$/g,"");
				}else if(grpArr[i].folderId != 1)
				{
					groupOptionText = '- '+grpArr[i].groupText.replace(/\s\(.*\)$/g,"");
					if (grpArr[i].published == 1) {
						groupOptionText += '*';
					}
				}else if(grpArr[i].folderId == 1)
				{
					continue;
				}
				var groupOption = new Option(groupOptionText, grpArr[i].folderId);
				if(dojo.isIE){ 
					    groupOptionText = groupOptionText.replace(/&nbsp;/g, " ");
						groupOption.text = groupOptionText;
				}else{
					groupOption.innerHTML = manualEncode(groupOptionText);
				}
				if(0 == 1){
					groupOption.disabled = "disabled";
				}
				try{
					groupsSelectBox.add(groupOption, groupsSelectBox.options[position]);
				}catch(e){
					groupsSelectBox.add(groupOption, position);
				}
				position++;
			}else if(grpArr[i].grpType == 1){
				groupOptionText = '- '+grpArr[i].groupText.replace(/\s\(.*\)$/g,"");
				try{ 
					if(ridGroupFlag == 0){
						var lineOption = new Option("--------------------", "RIDGroupsLine");
						lineOption.style.color = "#996633";
						lineOption.disabled = "disabled";
						groupsSelectBox.add(lineOption,null);
						var headingOption = new Option('ResearcherID', 	"RIDGroupsHeading");
						headingOption.style.color = "#996633";
						headingOption.disabled = "disabled";
						headingOption.style.fontWeight = "bold";
						groupsSelectBox.add(headingOption,null);
						ridGroupFlag = 1;
					}

				   var groupOption = new Option(groupOptionText, grpArr[i].folderId);
                                        groupOption.innerHTML = manualEncode(groupOptionText);
                                        groupsSelectBox.add(groupOption, null);
					if(0 == 1){
						grpsSelectBoxLen = groupsSelectBox.options.length;
						groupsSelectBox.options[grpsSelectBoxLen-1].disabled=true;
					}
				}catch(e){
					if(ridGroupFlag == 0){
						var lineOption = new Option("--------------------", "RIDGroupsLine");
						lineOption.style.color = "#996633";
						lineOption.disabled = "disabled";
						groupsSelectBox.add(lineOption);
						var headingOption = new Option('ResearcherID', "RIDGroupsHeading");
						headingOption.style.color = "#996633";
						headingOption.disabled = "disabled";
						headingOption.style.fontWeight = "bold";
						groupsSelectBox.add(headingOption);
						ridGroupFlag = 1;
					}
				    groupOptionText = groupOptionText.replace(/&nbsp;/g, " ");
					groupsSelectBox.add(new Option(groupOptionText, grpArr[i].folderId));
					if(0 == 1){
						grpsSelectBoxLen = groupsSelectBox.options.length;
						groupsSelectBox.options[grpsSelectBoxLen-1].disabled=true;
					}
				}
			}
			if(curFolderId != -1)
			{			
				//Code to update shared groups
				var folderId = grpArr[i].folderId+"";
				if (folderId.indexOf(':') != -1 && grpArr[i].perm == "rw"){
					groupOptionText = '- '+grpArr[i].groupText.replace(/\s\(.*\)$/g,"");			
					try{
						if (sharedGroupFlag == 0){
							var lineOption = new Option("--------------------", "SharedGroupsLine");
							lineOption.style.color = "#990033";
							lineOption.disabled = "disabled";
							groupsSelectBox.add(lineOption,null);
							var headingOption = new Option('Groups Shared by Others', "SharedGroupsHeading");
							headingOption.style.color = "#990033";
							headingOption.disabled = "disabled";
							headingOption.style.fontWeight = "bold";
							groupsSelectBox.add(headingOption,null);
							sharedGroupFlag = 1;
						}
						groupsSelectBox.add(new Option(groupOptionText, grpArr[i].folderId),null);
						if(0 == 1){
							grpsSelectBoxLen = groupsSelectBox.options.length;
							groupsSelectBox.options[grpsSelectBoxLen-1].disabled=true;
						}
					}catch(e){
						if (sharedGroupFlag == 0){
							var lineOption = new Option("--------------------", "SharedGroupsLine");
							lineOption.style.color = "#990033";
							lineOption.disabled = "disabled";
							groupsSelectBox.add(lineOption);
							var headingOption = new Option('Groups Shared by Others', "SharedGroupsHeading");
							headingOption.style.color = "#990033";
							headingOption.disabled = "disabled";
							headingOption.style.fontWeight = "bold";
							groupsSelectBox.add(headingOption);
							sharedGroupFlag = 1;
						}
						groupsSelectBox.add(new Option(groupOptionText, grpArr[i].folderId));
						if(0 == 1){
							grpsSelectBoxLen = groupsSelectBox.options.length;
							groupsSelectBox.options[grpsSelectBoxLen-1].disabled=true;
						}
					}
				}
			}
		}
	}
	}else{
		grpsSelectBoxLen = groupsSelectBox.options.length;

for (i=0;i< grpArr.length; i++) {
		var folderID = grpArr[i].folderId;
		var value = 0;
		if(folderID != 0 && folderID != null && folderID != 'EL' && folderID != -1 && folderID != 1){
			value = folderID.indexOf(':');
		}else{
			continue;
		}
		if (value == -1) {
			
//grpType:  0 represents personal groups, 1 represents RID groups
			if (grpArr[i].grpType == 0) { 
				var groupOptionText = grpArr[i].groupText.replace(/\s\(.*\)$/g,"");
				groupOptionText = groupOptionText.replace(/\&nbsp;/g," ");
				if (grpArr[i].published == 1) {
					groupOptionText += '*';
				}
				try{					
					var groupoption=new Option(groupOptionText, grpArr[i].folderId  );
					
					groupoption.disabled = "disabled";
					groupsSelectBox.add(groupoption,groupsSelectBox.options[position]);
				}catch(e){
					var groupoption= new Option(groupOptionText, grpArr[i].folderId);
					groupoption.disabled = "disabled";
					groupsSelectBox.add(groupoption,position);
				}
				position++;
				var grpsArr = "";
				grpsArr = grpArr[i].groups;
				
				if(grpsArr != undefined) {
				
				for (j=0; j < grpsArr.length; j++) {
					var groupOptionText = grpsArr[j].groupText.replace(/\s\(.*\)$/g,"");
				groupOptionText = groupOptionText.replace(/\&nbsp;/g," ");
				if (grpsArr[j].published == 1) {
					groupOptionText += '*';
				}
				try{
					if(dojo.isChrome || dojo.isSafari){
						var groupoption = new Option(groupOptionText, grpsArr[j].folderId);
						groupoption.innerHTML='&nbsp;&nbsp;&nbsp;'+groupoption.text;
						groupsSelectBox.add(groupoption,groupsSelectBox.options[position]);
					}else{
						var groupoption = new Option(groupOptionText, grpsArr[j].folderId);
						groupoption.style.paddingLeft = "15px";
						groupoption.style.paddingTop = "0px";
						groupsSelectBox.add(groupoption,groupsSelectBox.options[position]);
					}
				}catch(e){
					groupOptionText = '   '+groupOptionText;
					var groupoption = new Option(groupOptionText, grpsArr[j].folderId);
					groupoption.style.whiteSpace="pre";
					groupsSelectBox.add(groupoption,position);
				}
				position++;

				}
				}


			}else if(grpArr[i].grpType == 1){
				try{ 
					if(ridGroupFlag == 0){
						var lineOption = new Option("--------------------", "RIDGroupsLine");
						lineOption.style.color = "#996633";
						lineOption.disabled = "disabled";
						groupsSelectBox.add(lineOption,null);
						var headingOption = new Option('ResearcherID', 	"RIDGroupsHeading");
						headingOption.style.color = "#996633";
						headingOption.disabled = "disabled";
						headingOption.style.fontWeight = "bold";
						groupsSelectBox.add(headingOption,null);
						ridGroupFlag = 1;
					}
					var grpsArr = "";
					grpsArr = grpArr[i].groups;
					for (j=0; j < grpsArr.length; j++) {
						groupOptionText = grpsArr[j].shortFolder;
						if(dojo.isChrome || dojo.isSafari){
							var groupOption = new Option(groupOptionText, grpsArr[j].folderId);
							groupOption.innerHTML='&nbsp;&nbsp;&nbsp;'+groupOption.text;
							groupsSelectBox.add(groupOption, null);
						}else{
						var groupOption = new Option(groupOptionText, grpsArr[j].folderId);
                        groupOption.innerHTML = manualEncode(groupOptionText);
						groupOption.style.paddingLeft = "15px";
						groupOption.style.paddingTop = "0px";
                        groupsSelectBox.add(groupOption, null);
						}
					}
					if(0 == 1){
						grpsSelectBoxLen = groupsSelectBox.options.length;
						groupsSelectBox.options[grpsSelectBoxLen-1].disabled=true;
					}
				}catch(e){
					if(ridGroupFlag == 0){
						var lineOption = new Option("--------------------", "RIDGroupsLine");
						lineOption.style.color = "#996633";
						lineOption.disabled = "disabled";
						groupsSelectBox.add(lineOption);
						var headingOption = new Option('ResearcherID', "RIDGroupsHeading");
						headingOption.style.color = "#996633";
						headingOption.disabled = "disabled";
						headingOption.style.fontWeight = "bold";
						groupsSelectBox.add(headingOption);
						ridGroupFlag = 1;
					}

				    var grpsArr = "";
					grpsArr = grpArr[i].groups;
					for (j=0; j < grpsArr.length; j++) {
						groupOptionText = grpsArr[j].groupText;
						groupOptionText = groupOptionText.replace(/&nbsp;/g, " ");
						groupOptionText = '   '+groupOptionText;
						groupoption.style.whiteSpace="pre";
						var groupopt = new Option(groupOptionText, grpArr[j].folderId);
						groupopt.style.whiteSpace="pre";
						groupsSelectBox.add(groupopt);
					}
					if(0 == 1){
						grpsSelectBoxLen = groupsSelectBox.options.length;
						groupsSelectBox.options[grpsSelectBoxLen-1].disabled=true;
					}
				}
			}
		}else{
			continue;
		}
	}
		for (i=0;i< grpArr.length; i++) {
			var folderID = grpArr[i].folderId;
			if(folderID != 0 && folderID != null && folderID != 'EL' && folderID != -1 && folderID != 1){
				var isShared = folderID.indexOf(':');
			}
		if(curFolderId != -1 && isShared != -1){
			var folderId = grpArr[i].folderId+"";
			   if (folderId.indexOf(':') != -1){
				var sharedgroups = grpArr[i].groups;		
				for (j=0; j < sharedgroups.length; j++) {
					if(sharedgroups[j].perm == 'ro'){
						continue;
					}
				groupOptionText = sharedgroups[j].groupText.replace(/\s\(.*\)$/g,"");
				groupOptionText = groupOptionText.replace(/\&nbsp;/g," ");
				try{
					if (sharedGroupFlag == 0){
						var lineOption = new Option("--------------------", "SharedGroupsLine");
						lineOption.style.color = "#990033";
						lineOption.disabled = "disabled";
						groupsSelectBox.add(lineOption,null);
						var headingOption = new Option('Groups Shared by Others', "SharedGroupsHeading");
						headingOption.style.color = "#990033";
						headingOption.disabled = "disabled";
						headingOption.style.fontWeight = "bold";
						groupsSelectBox.add(headingOption,null);
						sharedGroupFlag = 1;
					}
					if(dojo.isChrome || dojo.isSafari){
						var groupoption = new Option(groupOptionText, sharedgroups[j].folderId);
						groupoption.innerHTML='&nbsp;&nbsp;&nbsp;'+groupoption.text;
						groupsSelectBox.add(groupoption,null);
					}else{
						var groupoption = new Option(groupOptionText, sharedgroups[j].folderId);
						groupoption.style.paddingLeft = "15px";
						groupoption.style.paddingTop = "0px";
						groupsSelectBox.add(groupoption,null);
					}
				}catch(e){
					if (sharedGroupFlag == 0){
						var lineOption = new Option("--------------------", "SharedGroupsLine");
						lineOption.style.color = "#990033";
						lineOption.disabled = "disabled";
						groupsSelectBox.add(lineOption);
						var headingOption = new Option('Groups Shared by Others', "SharedGroupsHeading");
						headingOption.style.color = "#990033";
						headingOption.disabled = "disabled";
						headingOption.style.fontWeight = "bold";
						groupsSelectBox.add(headingOption);
						sharedGroupFlag = 1;
					}
					groupOptionText = '   '+groupOptionText;
					var groupoption = new Option(groupOptionText, sharedgroups[j].folderId);
					groupoption.style.whiteSpace="pre";
					groupsSelectBox.add(groupoption);
				} 
				}
				}
			   }
		}
		}
		if('0' == '1') {
		if(sharedFolder != -1 || curFolderId == -1){
		for (i=0;i< grpArr.length; i++) {
			if (grpArr[i].folderId == 1){
				var groupOptionText = grpArr[i].groupText.replace(/\s\(.*\)$/g,"");
				groupOptionText = groupOptionText.replace(/\&nbsp;/g," ");
				var groupoption = new Option(groupOptionText, grpArr[i].folderId);
				groupsSelectBox.add(groupoption,groupsSelectBox.options[position]);
			}
		}	
		position++;
	}
	}
}


function evalScripts(scripts)
{       try
        {   
			if(scripts != '')
                {	
					var script = "";
                        scripts = scripts.replace(/<script[^>]*>([\s\S]*?)<\/script>/gi, function(){
                                         if (scripts !== null) script += arguments[1] + '\n';
                                                return '';});
                        if(script){
							if (window.execScript){
								window.execScript(script);
							}else{
								var tag = document.createElement("script");
								tag.type = "text/javascript";
								tag.text = script;
								document.getElementsByTagName("head").item(0).appendChild(tag);
							}
						}
                }
                return false;
        }
        catch(e)
        {       //alert(e);
        }
}

function changeFolderNavigation(folderId,pguid){
	
	if(document.getElementById('idDeleteTrash')){
	if (folderId == -1) {
	document.getElementById('idDeleteTrash').alt ="Permanently Delete Checked References";
    document.getElementById('idDeleteTrash').title ="Permanently Delete Checked References";
	}else{
     document.getElementById('idDeleteTrash').alt ="Move Checked References from All My References to the trash";
	 document.getElementById('idDeleteTrash').title ="Move Checked References from All My References to the trash";
	}
	}
    document.citationSearchForm.search_item.value = ""; 
    document.citationSearchForm.authorflag.value = ""; 
    document.citationSearchForm.selectedAuthor.value = ""; 	
	document.getElementById("idSortField").value = "";
	document.getElementById("idSortOrder").value = "";
    document.summarypage.duplicate.value = "";
    document.summarypage.manageAttachments.value = "";
	document.getElementById('sort_By').selectedIndex = 0;
    loadCitations(1, document.summarypage.TopRecordsPerSummary.value, folderId,pguid);	
}
 function copyToQuicklist(myForm,chkIdStr)
 {
    //document.getElementById('progress_indicator_image').style.display = "inline";
    document.getElementById('copy_to_export_progress_indicator_container').style.display = "inline";
	var checkedAll =0;
	var isQuickSearch = 0;
	var allChkIdStr='';
	var QuickSearch =document.citationSearchForm.search_item;
	if ((QuickSearch != null) && (QuickSearch.value.length >0)) {
			isQuickSearch = 1;
	}
 if (chkIdStr == undefined) {
	if(myForm.CheckAllRef.checked ||  myForm.checkall.value == 1) {
		checkedAll=1;
		if (isQuickSearch && ('0' == '0')) {
			allChkIdStr = document.summarypage.citation_ids.value;			
			checkedAll = 0;
		}
   		var idsArr = document.getElementsByTagName("input");
   		var unchkIds = new Array();
		for(var i=0; i<idsArr.length; i++){
			if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
				if(!idsArr[i].checked){
				unchkIds.push(idsArr[i].getAttribute("value"));
				}	
			}
		}
		if (isQuickSearch) {
			if (unchkIds.length > 0) {
				var newres = new Array();
				var allIds = allChkIdStr.split(" ");
				var matched =0;
				for (var i=0; i <allIds.length ; i++){
					matched =0;
					for( var j=0; j< unchkIds.length; j++){
						if (allIds[i] == unchkIds[j]){
							matched = 1;
							break;
						}
					}
					if (matched ==0) {
						newres.push(allIds[i]);
					}
				}
				chkIdStr = newres.join(' ');
			}else{
			chkIdStr = allChkIdStr;
			}
		}else{
		chkIdStr = unchkIds.join(' ');
		}
    	}else{
    		var idsArr = document.getElementsByTagName("input");
    		var chkIds = new Array();
   			for(var i=0; i<idsArr.length; i++){
       			if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
           			if(idsArr[i].checked){
           				chkIds.push(idsArr[i].getAttribute("value"));
           			}	
       			}
   			}
   			chkIdStr = chkIds.join(' ');   
    }
 }

	if (chkIdStr == undefined) {
		return false;
	}
	var current_folderId = document.summarypage.current_folder_id.value;
	var dojoURL;
	if (checkedAll == 1) {
		dojoURL ="EndNoteWeb.html?func=mark&ids="+chkIdStr+"&checkedAll="+checkedAll+"&currentFolderId="+current_folderId;
		checkedAll=0;
	}else{
		dojoURL ="EndNoteWeb.html?func=mark&ids="+chkIdStr;	
	}
	if('0' == '1') {
		var pguid=document.summarypage.pguid.value;
		if(pguid != "undefined" && pguid.length > 0) {
			dojoURL += "&pguid="+pguid;
		}
		if(document.getElementById("idSortField").value) {
			dojoURL += "&sortField="+document.getElementById("idSortField").value+"&sortOrder="+document.getElementById("idSortOrder").value;
		}
		if (isQuickSearch) {
			dojoURL += "&searchItem="+QuickSearch.value;
		}
	}  
	dojo.xhrGet({
		url      : dojoURL,
		handleAs: 'json',
        preventCache : true,
		load     : function (data){
				       updateQuickList(data);
					   //document.getElementById('progress_indicator_image').style.display = "none";
						document.getElementById('copy_to_export_progress_indicator_container').style.display = "none";
                   },
		error	: function(response, ioArgs) { 
//							alert('Error while copying to quick list! ');
//							console.error(response);
							//document.getElementById('progress_indicator_image').style.display = "none";
							document.getElementById('copy_to_export_progress_indicator_container').style.display = "none";
							window.location.reload(true);
					}
	});
    document.getElementById("idCheckPage").checked = false;
    document.getElementById("idCheckAllRef").checked = false;  
	document.summarypage.checkall.value = 0;
	return false;
}

function updateQuickList(data){
	citData = data;
	folderId = citData.CURRENT_FOLDER_ID;
	folderName = citData.CURRENT_FOLDER_NAME;
	var parentNode = document.getElementById("idFolderLink_"+citData.CURRENT_FOLDER_ID);
	var txtNode = document.createTextNode(citData.CURRENT_FOLDER_NAME+" "+"("+citData.CURRENT_FOLDER_RECORD_COUNT+")");
	if('0' == '1') {
		if(parentNode.childNodes[0].tagName != "A")	{
			parentNode.childNodes[1].replaceChild(txtNode, parentNode.childNodes[1].lastChild);
		}
		else {
			parentNode.childNodes[0].replaceChild(txtNode, parentNode.childNodes[0].lastChild);
		}
	}	
	else {
		if(parentNode.childNodes[0].tagName != "A")	{
			if (parentNode.childNodes[2] != undefined) {
				parentNode.childNodes[2].replaceChild(txtNode, parentNode.childNodes[2].lastChild);
			}
			else {
				parentNode.childNodes[1].replaceChild(txtNode, parentNode.childNodes[1].lastChild);
			}
		}
		else {
			parentNode.childNodes[0].replaceChild(txtNode, parentNode.childNodes[0].lastChild);
		}
	}

// Uncheck the checked citations
	var idsArr = document.getElementsByTagName("input");
	for(var i=0; i<idsArr.length; i++){
		if(idsArr[i].getAttribute('type') == 'checkbox' && idsArr[i].getAttribute('name') == 'ids'){
    		if(idsArr[i].checked){
     			idsArr[i].checked = false;
     		}	
       	}
   	}									   
}

function changeEndnoteAdState(endNoteAdState){	
	if (endNoteAdState == 'off'){		
		document.getElementById("idErrorEndnoteAd_container").style.display="none";
		document.getElementById("idErrorEndnoteAd_learn").style.display="inline";		
		showEndnoteState = 0;
	}else{		
		document.getElementById("idErrorEndnoteAd_container").style.display="inline";
		document.getElementById("idErrorEndnoteAd_learn").style.display="none";
		showEndnoteState = 1;
	}
     dojo.xhrGet({
                    url      : "EndNoteWeb.html?func=setEndnoteAdState&setEndnoteLogo="+endNoteAdState,
                    preventCache : true,
					error	: function(response, ioArgs) { 
								//reload page if session expires
								window.location.href = window.location.protocol+"://"+window.location.host+window.location.pathname;
							}
                 });

}

function returnToList(flag){
	try{
		document.citationSearchForm.search_item.value = decodeURIComponent(document.citationSearchForm.search_item.value);
	}catch(e){ };
        if (flag == 'view') {
                document.getElementById("idViewCitation").style.display = "none";
        }else if (flag == 'edit') {
                document.getElementById("idEditCitation").style.display = "none";
        }
   document.getElementById("idShowCitations").style.display = "inline";
   var currentFolderId=document.summarypage.current_folder_id.value;
   var noPerPage = document.summarypage.TopRecordsPerSummary.value;
   var pageNo = document.summarypage.TopPageInput.value;
   pageNo = document.summarypage.PageNum.value;
   var pguid=document.summarypage.pguid.value;
   loadCitations(pageNo, noPerPage, currentFolderId,pguid);
}

function verifyCitation(frm) {
    	var success = false;
    // This still needs work...
    if (frm.author){
        frm.author.value = frm.author.value.replace(/^\s+/g, '');
        frm.author.value = frm.author.value.replace(/\s+$/g,'');
    }
    if (frm.year){
        frm.year.value = frm.year.value.replace(/^\s+/g, '');
        frm.year.value = frm.year.value.replace(/\s+$/g,'');
    }

    var flag = 0;
    if(frm.author && frm.year){
    if( (frm.author.value == '') && (frm.year.value == '') ) {
    alert("You must complete at least one of the required fields indicated by an asterisk.");
    flag = 1;
    }

    }  else {

    if(frm.year){
    if( frm.year.value == '' ) {
    alert("You must complete at least one of the required fields indicated by an asterisk.");
    flag = 1;
    } 

    }
    }  
    
    if(flag == 1)
    {
        success = false;
    
    } else { success = true; }

    if(success){
		submitEditForm();
    }   
	return success;

}

function submitEditForm(){
        if(document.getElementById("idEditCitation").style.display == "inline"){
            document.getElementById("idEditCitation").style.display = "none";
            document.getElementById("idSpinProgress").style.display = "inline";
        }
        dojo.xhrPost({
                    form      : document.getElementById("idEditCitationForm"),
                    preventCache : true,
                    load     : function (data){
                                       var newdiv = document.createElement("div");
                                       newdiv.innerHTML = data;
                                       var parentDiv = document.getElementById("idViewCitation");
                                       if(parentDiv.hasChildNodes()){
                                           parentDiv.removeChild(parentDiv.lastChild);
                                       }
                                      getGroupsInfo(); document.getElementById("idViewCitation").appendChild(newdiv);
                                      document.getElementById("idSpinProgress").style.display = "none";
									  document.getElementById("idViewCitation").style.display = "inline";
                               },
					error	: citationErrorHandler
                 });
}

function setAttachmentLinks(data,citArr){
	var filecount;
	var figurecount;
	var refData=data.ATTACHMENT_COUNT;
	var cit_id;
	
	for(var j=0;j<citArr.length;j++){
		filecount = -1;
		if('0' == '1'){
			cit_id = citArr[j].refID;
		}
		else {
			cit_id = citArr[j].id;
		}
 		if("on" == "on"){
			for(var i=0;i<refData.length;i++){
				if(refData[i].RefID == cit_id && refData[i].FileType == 'file') {
						filecount = refData[i].FileCount;
						break;
				}
			}
			if(filecount>0){
				var fileAttachId = "fileAttach_"+refData[i].RefID;
				if(document.getElementById(fileAttachId)) {
				document.getElementById(fileAttachId).style.display="inline";
				document.getElementById(fileAttachId).src= " /images/en_us/file_attachment.gif ";
				document.getElementById(fileAttachId).title= "View file attachments";
				document.getElementById(fileAttachId).alt= "View file attachments";		
				}
			}else{
				var fileAttachId = "fileAttach_"+cit_id; 
				if(document.getElementById(fileAttachId)) {
				document.getElementById(fileAttachId).style.display="inline";
				document.getElementById(fileAttachId).src= " /images/en_us/file_attachment_empty.gif ";
				document.getElementById(fileAttachId).title= "View file attachments";
				document.getElementById(fileAttachId).alt= "View file attachments";
				}
			}
		}else{
			var fileAttachId = "fileAttach_"+cit_id;
			if(document.getElementById(fileAttachId)) {
			document.getElementById(fileAttachId).style.display="inline";
			document.getElementById(fileAttachId).src= " /images/en_us/file_attachment.gif ";
			document.getElementById(fileAttachId).title= "View file attachments";
			document.getElementById(fileAttachId).alt= "View file attachments";	
			}
		}
	}
	for(var j=0;j<citArr.length;j++){
		if('0' == '1'){
			cit_id = citArr[j].refID;
		}
		else {
			cit_id = citArr[j].id;
		}
		figurecount = -1;
		if("on" == "on"){
			for(var i=0;i<refData.length;i++){		
				if(refData[i].RefID == cit_id && refData[i].FileType == 'figure') {
					figurecount = refData[i].FileCount;
					break;
				}
			}
			if(figurecount>0){
				var figureAttachId = "figureAttach_"+refData[i].RefID;
				if(document.getElementById(figureAttachId)) {
				document.getElementById(figureAttachId).style.display="inline";
				document.getElementById(figureAttachId).src= " /images/en_us/figure_attachment.gif ";
				document.getElementById(figureAttachId).title= "View figure attachment";
				document.getElementById(figureAttachId).alt= "View figure attachment";				
				}
			}else{
				var figureAttachId = "figureAttach_"+cit_id;   
				if(document.getElementById(figureAttachId)) {
				document.getElementById(figureAttachId).style.display="inline";
				document.getElementById(figureAttachId).src= " /images/en_us/figure_attachment_empty.gif ";
				document.getElementById(figureAttachId).title= "View figure attachment";
				document.getElementById(figureAttachId).alt= "View figure attachment";
				}
			}
		}else{
				var figureAttachId = "figureAttach_"+cit_id;
				if(document.getElementById(figureAttachId)) {
				document.getElementById(figureAttachId).style.display="inline";
				document.getElementById(figureAttachId).src= " /images/en_us/figure_attachment.gif ";
				document.getElementById(figureAttachId).title= "View figure attachment";
				document.getElementById(figureAttachId).alt= "View figure attachment";
				}
		}
	}
}

function manualEncode(folderName){
	folderName = folderName.replace(/</g,"&lt;");
	folderName = folderName.replace(/>/g,"&gt;");
	return folderName;
}

</script>






<td valign="top" class="summary_pagecntnav">
<table id="contentTable" width="100%" border="0" cellpadding="0" cellspacing="0">
<tbody><tr>
<td align="top" class="contnav">
<div id="idShowGettingStarted" style="display:none">
<div class="gsg_Title">Getting Started </div>
<div id="gsg_container">

<div id="find-holder">
 
<div id="find1"><img src="/images/en_us/search_purple2x.png" style="margin-right: 12px" alt="Find" title="Find" width="40" height="40">Find</div>
<div id="find2"><span class="gsg_strong">Collect</span> references by searching online databases or importing your existing collection.
</div>
<div id="find3" style="height:84px;">
<ul>
<li><a href="./EndNoteWeb.html?func=remoteSearchConnections&amp;" alt="Search an online database" title="Search an online database">Search an online database</a></li>
<li><a href="./EndNoteWeb.html?func=new&amp;" alt="Create a reference manually" title="Create a reference manually">Create a reference manually</a></li>
<li><a href="./EndNoteWeb.html?func=import%20citations&amp;" alt="Import references" title="Import references">Import references</a></li>
<li><sup style="background-color: #5e33bf; color: #ffffff; font-family: arial; font-size: 0.55em; font-weight: 500; letter-spacing: 0.12em; padding: 0.3em 0.6em; vertical-align: top;">NEW!</sup>&nbsp;<a href="./EndNoteWeb.html?func=journalDetails&amp;" alt="Find your best potential journal " title="Find your best potential journal ">Find your best potential journal </a></li>
</ul>
</div>

</div> 
  
<div id="store-holder">
 
<div id="store1"><img src="/images/en_us/share_purple2x.png" alt="Store &amp; Share" title="Store &amp; Share" width="62" height="40">Store &amp; Share</div>
<div id="store2"><span class="gsg_strong">Organize</span> and group references in any way that works for you. Then share your groups with colleagues.
</div>
<div id="store3">
<ul>
<li><span><a href="./EndNoteWeb.html?func=folderOptions" alt="Create a new group" title="Create a new group">Create a new group</a></span></li>
<li><span><a href="./EndNoteWeb.html?func=folderOptions#sharedFolder" alt="Share a group" title="Share a group">Share a group</a></span></li>
<li><span><a href="./EndNoteWeb.html?func=findDuplicates&amp;" alt="Find duplicate references" title="Find duplicate references">Find duplicate references</a></span></li>
</ul>
</div>

</div>
  
<div id="create-holder">
 
<div id="create1"><img src="/images/en_us/create_purple2x.png" style="margin-right: 12px" alt="Create" title="Create" width="32" height="40">Create</div>
<div id="create2">Use our plugin to <span class="gsg_strong gsg_normal">format</span> bibliographies and cite references while you write. 
</div>
<div id="create3">
<ul>
<li><a href="./EndNoteWeb.html?func=showcwyw&amp;" alt="Cite While You Writeâ„¢ Plug-In" title="Cite While You Writeâ„¢ Plug-In">Cite While You Writeâ„¢ Plug-In</a></li>
<li><a href="./EndNoteWeb.html?func=bibliography&amp;" alt="Create a formatted bibliography" title="Create a formatted bibliography">Create a formatted bibliography</a></li>
<li><a href="./EndNoteWeb.html?func=scan%20paper&amp;" alt="Format a paper" title="Format a paper">Format a paper</a></li>
</ul>
</div>

</div>

</div>


</div>
<div id="idSpinProgress" style="display:none">
<br><br><br><br><br><br><br>
<table width="100%" height="100%" border="0" align="center" valign="center"><tbody><tr><td align="center" valign="center"><img src="/images/en_us/spinning_progress_indicator_big.gif"></td></tr></tbody></table>
</div>
<div id="idViewCitation" style="display:none"></div>
<div id="idEditCitation" style="display:none"></div>
<div id="idShowCitations" style="display:inline">
<table width="100%" border="0" cellpadding="3" cellspacing="0">


<tbody><tr><td>
	<form id="summarypage" name="summarypage" action="./EndNoteWeb.html" method="get" onsubmit="return false;">
	<input type="hidden" name="quickList" value="">
	<input type="hidden" name="max_page_count" value="1">
	<input type="hidden" name="citation_count" value="0">
	<input type="hidden" name="citation_ids" value="">
	<input type="hidden" name="current_folder_id" value="0">
	<input type="hidden" name="trash_attached_flag" value="">
	<input type="hidden" name="duplicate" id="idDuplicate" value="">
    <input type="hidden" name="manageAttachments" id="idmanageAttachments" value="">
	<input type="hidden" name="currentFolderName" id="currentFolderName" value="All My References">
	<input type="hidden" name="pguid" id="pguid" value="">
	<input type="hidden" name="refID" id="refID">

	<input type="hidden" name="get_all_rec_ids_time_ms" value="0 records @ ">
	<input type="hidden" name="get_recs_by_ids_time_ms" value="0">
	<input type="hidden" name="full_text_time_ms" value="">

<table width="100%" align="left"><tbody><tr><td class="heading" id="idFoderDesc">All My References</td>
	


<td width="33%" align="right" rowspan="3">
<span id="idEndnoteAd_logo">

<!--       EndNote Ad Begin    -->
<div id="idErrorEndnoteAd_container" style="" class="endnoteAd_container">
<div class="endnoteAd_image"><a onclick="ga('send', 'event', 'EndNote Ad Banner', 'click', 'EN Ad'); return openUrl_location('https://endnote.com/product-details?utm_campaign=EndNote_X9_launch_SAR_2018_online&amp;utm_source=owned_display&amp;utm_medium=owned','tab');" href="javascript:void(0);"><img src="/images/en_us/EN.gif" alt="Learn about EndNote for Mac and Windows" title="Learn about EndNote for Mac and Windows"></a></div>
<div id="endNoteAdClose" class="endnoteAd_close"><a href="javascript:void(0)" onclick="javascript:changeEndnoteAdState('off');" alt="Close EndNote notice" title="Close EndNote notice">Close</a></div></div>
<div id="idErrorEndnoteAd_learn" style="display:none;" class="endnoteAd_learn"><a href="javascript:void(0)" onclick="javascript:changeEndnoteAdState('on');" alt="Learn about EndNote for Mac and Windows" title="Learn about EndNote for Mac and Windows">Learn about EndNote Desktop</a></div>
</span>
</td></tr>
<tr>
<td valign="top" style="min-width:930px;" colspan="6" align="left">
<div id="displayErrorMsg" style="display: inline;"><span class="errtext2">There are currently no references stored in this group.</span></div>
</td>



</tr>
<tr><td width="67%" align="left">
<!--EndNote Ad End -->
<table id="topNavBar" style="padding-top:7px;display:none" width="100%" border="0" cellspacing="0" cellpadding="0" class="topNav">
<tbody><tr>
<td width="33%" class="hitCount">
<!--[if gte IE 7]>
<select name="TopRecordsPerSummary" style="font-size:60%;" id="TopRecordsPerSummary" class="formBoxesShow" onchange="changeNumberPerPage(this.value,'top')">
<![endif]-->
<!--[if !IE]-->
<select name="TopRecordsPerSummary" id="TopRecordsPerSummary" class="formBoxesShow" onchange="changeNumberPerPage(this.value,'top')">
<!--[endif]-->
<option value="10">Show 10 per page</option>
<option value="25">Show 25 per page</option>
<option value="50">Show 50 per page</option>
</select></td>
<script language="JAVASCRIPT">

// Top Navigation Bar links

nav_first = document.createElement("a");
nav_first.setAttribute("id", "nav_first_link");
//nav_first.setAttribute("href", "javascript:void(0)");
//nav_first.setAttribute("onclick", "javascript:getFirstPage()");
nav_first.href = "javascript:void(0)";
nav_first.onclick = getFirstPage;
nav_first_img = document.createElement("img");
nav_first_img.setAttribute("id", "nav_first_img");
nav_first_img.setAttribute("src", "/images/en_us/arrow_first.gif");
nav_first_img.setAttribute("alt", "First Page");
nav_first_img.setAttribute("hspace", "3");
nav_first_img.setAttribute("border", "0");
nav_first_img.setAttribute("title", "First Page");
nav_first.appendChild(nav_first_img);

nav_first_i = document.createElement("img");
nav_first_i.setAttribute("id", "nav_first_img_i");
nav_first_i.setAttribute("src", "/images/en_us/arrow_first_i.gif");
nav_first_i.setAttribute("alt", "First Page (disabled)");
nav_first_i.setAttribute("hspace", "3");
nav_first_i.setAttribute("border", "0");
nav_first_i.setAttribute("title", "First Page (disabled)");

nav_prev = document.createElement("a");
nav_prev.setAttribute("id", "nav_prev_link");
//nav_prev.setAttribute("href", "javascript:void(0)");
//nav_prev.setAttribute("onclick", "javascript:getPrevPage()");
nav_prev.href = "javascript:void(0)";
nav_prev.onclick = getPrevPage;
nav_prev_img = document.createElement("img");
nav_prev_img.setAttribute("id", "nav_prev_img");
nav_prev_img.setAttribute("src", "/images/en_us/arrow_left.gif");
nav_prev_img.setAttribute("alt", "Previous Page");
nav_prev_img.setAttribute("hspace", "3");
nav_prev_img.setAttribute("border", "0");
nav_prev_img.setAttribute("title", "Previous Page");
nav_prev.appendChild(nav_prev_img);

nav_prev_i = document.createElement("img");
nav_prev_i.setAttribute("id", "nav_prev_img_i");
nav_prev_i.setAttribute("src", "/images/en_us/arrow_left_i.gif");
nav_prev_i.setAttribute("alt", "Previous Page (disabled)");
nav_prev_i.setAttribute("hspace", "3");
nav_prev_i.setAttribute("border", "0");
nav_prev_i.setAttribute("title", "Previous Page (disabled)");

nav_next = document.createElement("a");
nav_next.setAttribute("id", "nav_next_link");
nav_next.href = "javascript:void(0)";
nav_next.onclick = getNextPage;
nav_next_img = document.createElement("img");
nav_next_img.setAttribute("id", "nav_next_img");
nav_next_img.setAttribute("src", "/images/en_us/arrow_rgt.gif");
nav_next_img.setAttribute("alt", "Next Page");
nav_next_img.setAttribute("hspace", "3");
nav_next_img.setAttribute("border", "0");
nav_next_img.setAttribute("title", "Next Page");
nav_next.appendChild(nav_next_img);

nav_next_i = document.createElement("img");
nav_next_i.setAttribute("id", "nav_next_img_i");
nav_next_i.setAttribute("src", "/images/en_us/arrow_rgt_i.gif");
nav_next_i.setAttribute("alt", "Next Page (disabled)");
nav_next_i.setAttribute("hspace", "3");
nav_next_i.setAttribute("border", "0");
nav_next_i.setAttribute("title", "Next Page (disabled)");

nav_last = document.createElement("a");
nav_last.setAttribute("id", "nav_last_link");
//nav_last.setAttribute("href", "javascript:void(0)");
//nav_last.setAttribute("onclick", "javascript:getLastPage()");
nav_last.href = "javascript:void(0)";
nav_last.onclick = getLastPage;
nav_last_img = document.createElement("img");
nav_last_img.setAttribute("id", "nav_last_img");
nav_last_img.setAttribute("src", "/images/en_us/arrow_last.gif");
nav_last_img.setAttribute("alt", "Last Page");
nav_last_img.setAttribute("hspace", "3");
nav_last_img.setAttribute("border", "0");
nav_last_img.setAttribute("title", "Last Page");
nav_last.appendChild(nav_last_img);

nav_last_i = document.createElement("img");
nav_last_i.setAttribute("id", "nav_last_img_i");
nav_last_i.setAttribute("src", "/images/en_us/arrow_last_i.gif");
nav_last_i.setAttribute("alt", "Last Page (disabled)");
nav_last_i.setAttribute("hspace", "3");
nav_last_i.setAttribute("border", "0");
nav_last_i.setAttribute("title", "Last Page (disabled)");




//Bottom Navigation Bar links



nav_first_bottom = document.createElement("a");
nav_first_bottom.setAttribute("id", "nav_first_link_bottom");
nav_first_bottom.href = "javascript:void(0)";
nav_first_bottom.onclick = getFirstPage;
nav_first_img_bottom = document.createElement("img");
nav_first_img_bottom.setAttribute("id", "nav_first_img_bottom");
nav_first_img_bottom.setAttribute("src", "/images/en_us/arrow_first.gif");
nav_first_img_bottom.setAttribute("alt", "First Page");
nav_first_img_bottom.setAttribute("hspace", "3");
nav_first_img_bottom.setAttribute("border", "0");
nav_first_img_bottom.setAttribute("title", "First Page");
nav_first_bottom.appendChild(nav_first_img_bottom);

nav_first_i_bottom = document.createElement("img");
nav_first_i_bottom.setAttribute("id", "nav_first_img_i_bottom");
nav_first_i_bottom.setAttribute("src", "/images/en_us/arrow_first_i.gif");
nav_first_i_bottom.setAttribute("alt", "First Page (disabled)");
nav_first_i_bottom.setAttribute("hspace", "3");
nav_first_i_bottom.setAttribute("border", "0");
nav_first_i_bottom.setAttribute("title", "First Page (disabled)");

nav_prev_bottom = document.createElement("a");
nav_prev_bottom.setAttribute("id", "nav_prev_link_bottom");
nav_prev_bottom.href = "javascript:void(0)";
nav_prev_bottom.onclick = getPrevPage;
nav_prev_img_bottom = document.createElement("img");
nav_prev_img_bottom.setAttribute("id", "nav_prev_img_bottom");
nav_prev_img_bottom.setAttribute("src", "/images/en_us/arrow_left.gif");
nav_prev_img_bottom.setAttribute("alt", "Previous Page");
nav_prev_img_bottom.setAttribute("hspace", "3");
nav_prev_img_bottom.setAttribute("border", "0");
nav_prev_img_bottom.setAttribute("title", "Previous Page");
nav_prev_bottom.appendChild(nav_prev_img_bottom);

nav_prev_i_bottom = document.createElement("img");
nav_prev_i_bottom.setAttribute("id", "nav_prev_img_i_bottom");
nav_prev_i_bottom.setAttribute("src", "/images/en_us/arrow_left_i.gif");
nav_prev_i_bottom.setAttribute("alt", "Previous Page (disabled)");
nav_prev_i_bottom.setAttribute("hspace", "3");
nav_prev_i_bottom.setAttribute("border", "0");
nav_prev_i_bottom.setAttribute("title", "Previous Page (disabled)");

nav_next_bottom = document.createElement("a");
nav_next_bottom.setAttribute("id", "nav_next_link_bottom");
nav_next_bottom.href = "javascript:void(0)";
nav_next_bottom.onclick = getNextPage;
nav_next_img_bottom = document.createElement("img");
nav_next_img_bottom.setAttribute("id", "nav_next_img_bottom");
nav_next_img_bottom.setAttribute("src", "/images/en_us/arrow_rgt.gif");
nav_next_img_bottom.setAttribute("alt", "Next Page");
nav_next_img_bottom.setAttribute("hspace", "3");
nav_next_img_bottom.setAttribute("border", "0");
nav_next_img_bottom.setAttribute("title", "Next Page");
nav_next_bottom.appendChild(nav_next_img_bottom);

nav_next_i_bottom = document.createElement("img");
nav_next_i_bottom.setAttribute("id", "nav_next_img_i_bottom");
nav_next_i_bottom.setAttribute("src", "/images/en_us/arrow_rgt_i.gif");
nav_next_i_bottom.setAttribute("alt", "Next Page (disabled)");
nav_next_i_bottom.setAttribute("hspace", "3");
nav_next_i_bottom.setAttribute("border", "0");
nav_next_i_bottom.setAttribute("title", "Next Page (disabled)");

nav_last_bottom = document.createElement("a");
nav_last_bottom.setAttribute("id", "nav_last_link_bottom");
nav_last_bottom.href = "javascript:void(0)";
nav_last_bottom.onclick = getLastPage;
nav_last_img_bottom = document.createElement("img");
nav_last_img_bottom.setAttribute("id", "nav_last_img_bottom");
nav_last_img_bottom.setAttribute("src", "/images/en_us/arrow_last.gif");
nav_last_img_bottom.setAttribute("alt", "Last Page");
nav_last_img_bottom.setAttribute("hspace", "3");
nav_last_img_bottom.setAttribute("border", "0");
nav_last_img_bottom.setAttribute("title", "Last Page");
nav_last_bottom.appendChild(nav_last_img_bottom);

nav_last_i_bottom = document.createElement("img");
nav_last_i_bottom.setAttribute("id", "nav_last_img_i_bottom");
nav_last_i_bottom.setAttribute("src", "/images/en_us/arrow_last_i.gif");
nav_last_i_bottom.setAttribute("alt", "Last Page (disabled)");
nav_last_i_bottom.setAttribute("hspace", "3");
nav_last_i_bottom.setAttribute("border", "0");
nav_last_i_bottom.setAttribute("title", "Last Page (disabled)");


</script>

<td width="33%" align="center">

<table id="vcrNav" border="0" cellpadding="0" cellspacing="0">

<tbody><tr>

<td width="15" align="left" id="nav_first_container">
    <img id="nav_first_img_i" src="/images/en_us/arrow_first_i.gif" alt="First Page (disabled)" hspace="3" border="0" title="First Page (disabled)">
</td>
<td width="15" align="left" id="nav_prev_container">
<img id="nav_prev_img_i" src="/images/en_us/arrow_left_i.gif" alt="Previous Page (disabled)" hspace="3" border="0" title="Previous Page (disabled)">
</td>



<!--[if gte IE 7]>
<td align="center" style="font-size:65%" class="goto">
<![endif]-->
<!--[if !IE]-->
<td align="center" class="goto">
<!--[endif]-->
<script type="text/javascript">
<!--
function onEnter( evt, id ) {
    var keyCode = null;
    if( evt.which ) {
        keyCode = evt.which;
    } else if( evt.keyCode ) {
        keyCode = evt.keyCode;
    }
    if( (13 == keyCode) || (3 == keyCode)) {
		dojo.byId(id).click();
        return false;
    }
    return true;
}
function stripSpaces(word)
{
        while(word.length && word.substring(0,1) == " ") word = word.substring(1, word.length);
        while(word.length && word.substring(word.length-1, word.length) == " ") word = word.substring(0, word.length-1);
        return word;
}
//-->
</script>
<input type="hidden" name="PageNum" id="PageNum" value="0">
<label for="TopPageInput">Page</label>&nbsp;
<!--[if gte IE 7]>
<input class="pageNumBoxes" style="font-size:80%;" id="TopPageInput" type="text" name="TopPageInput" value="1" size="5" onkeypress="return onEnter(event,'gotoToppage_image');"/> &nbsp;of <span id='idPageCount'>1</span>
<![endif]-->
<!--[if !IE]-->
<input class="pageNumBoxes" id="TopPageInput" type="text" name="TopPageInput" value="1" size="5" onkeypress="return onEnter(event,'gotoToppage_image');"> &nbsp;of <span id="idPageCount">1</span>
<!--[endif]-->
&nbsp;

        <input type="button" class="grey_btn" id="gotoToppage_image" name="GoToPage" value="Go" alt="Go to the page" title="Go to the page" align="absmiddle" onclick="getCitationPage(document.summarypage.TopPageInput.value);">
</td>


<td width="15" align="right" id="nav_next_container">
<img id="nav_next_img_i" alt="Next Page (disabled)" title="Next Page (disabled)" src="/images/en_us/arrow_rgt_i.gif" border="0" hspace="3">
</td>
<td width="15" align="right" id="nav_last_container">
<img id="nav_last_img_i" alt="Last Page (disabled)" title="Last Page (disabled)" src="/images/en_us/arrow_last_i.gif" border="0" hspace="3">
</td>

</tr>
</tbody></table></td>


</tr>
</tbody></table>
</td></tr>

</tbody></table></form></td></tr>

<tr id="displayCitations" style="visibility: hidden; display: none;">
<td width="100%" valign="top">
<input type="hidden" name="curr" value="1">
<input type="hidden" name="checkall" value="0">
<table width="100%" border="0" cellpadding="2" cellspacing="0" class="references_main">
<tbody id="ref_main">

<tr><td colspan="10" class="dothorz"></td></tr>
<tr>
<td width="3%" rowspan="3" valign="bottom">
<img src="/images/en_us/arrow_dotted_tall.gif" alt=""></td>
<td colspan="4" valign="bottom">
<div class="sortBy">Sort by:<select name="sort_id" id="sort_By" onchange="sortBy(sort_id.value,'d');">
<option name="FirstAuthor1" value="authorASC">First Author -- A to Z</option>
<option name="FirstAuthor2" value="authorDSC">First Author -- Z to A</option>
<option name="Year1" value="yearDSC">Year -- newest to oldest</option>
<option name="Year2" value="yearASC">Year -- oldest to newest</option>
<option name="title1" value="titleASC">Title -- A to Z</option>
<option name="title2" value="titleDSC">Title -- Z to A</option>
<option name="Source Title1" value="secondary_titleASC">Source Title -- A to Z</option>
<option name="Source Title2" value="secondary_titleDSC">Source Title -- Z to A</option>
<option name="timescited1" value="times_citedDSC">Times Cited -- highest to lowest</option>
<option name="timescited2" value="times_citedASC">Times Cited -- lowest to highest</option>
<option name="created1" value="added_to_libraryDSC">Added to Library -- newest to oldest</option>
<option name="created2" value="added_to_libraryASC">Added to Library -- oldest to newest</option>
<option name="modified1" value="last_updatedDSC">Last Updated -- newest to oldest</option>
<option name="modified2" value="last_updatedASC">Last Updated -- oldest to newest</option>
</select></div>
<span class="allPage">
<input type="checkbox" name="CheckAllRef" id="idCheckAllRef" value="Check All"><label for="CheckAllRef">All</label>&nbsp;
<input type="checkbox" name="CheckPage" id="idCheckPage" value="Check Page"><label for="CheckPage">Page</label></span>


<input type="hidden" name="sortField" id="idSortField" value="">
<input type="hidden" name="sortOrder" id="idSortOrder" value="">
<input type="hidden" name="selectedSortField" id="idselectedSortField" value="">
<input type="hidden" name="selectedsortorder" id="idselectedsortorder" value="">
 <input type="hidden" name="restore" id="idRestoreval" value="no">

<div id="idAddToGroup_select" style="display: inline;">
<select name="folder_id" id="idAddToGroup_listView" onchange=" 
if(folder_id.value != 'Save or Copy') {
    if(verifyCheckforSaveCopy(this.form,'ids','SaveCopy')) {
	currFolder = '0';
	if(folder_id.value == 'Create New Group') {	
	   if (0 == 1 ){
		   	showdialog(this.form,this.value);
			folder_id.selectedIndex = 0;
	   }else{
		createFolder_addRef(this.form,this.value);
	   }
	} else if(folder_id.value == ''){
  		folder_id.selectedIndex = 0;
  		return false;
	} else {
		changeFolders(this.form,this.value);
	}
    } else{ 
        folder_id.selectedIndex = 0;
	return false;
    } 
 }">
    <option value="Save or Copy">Add to group...</option>
	



	  <option value="Create New Group">New group</option>
 		
 
 

</select>

</div>
<div id="quick_list" style="display: inline;">
	<input type="button" class="grey_btn" alt="Copy checked references to Quick List" title="Copy checked references to Quick List" align="absbottom" id="copyToQuickList" name="Copy To Quick List" value="Copy To Quick List" onclick="

        if(verifyCheckforSaveCopy(this.form,'ids','CopyExport')) {
	    copyToQuicklist(this.form);
	 }
	else {
	    return false;
	 }
     ">
</div>
<div id="idDelete" style="display:inline">
<input id="idDeleteTrash" type="button" class="grey_btn" value="Delete" alt="Move Checked References from All My References to the trash" title="Move Checked References from All My References to the trash" align="absbottom" name="MoveToTrash" onclick="return confirmDeleteForTrash(this.form,'toTrash');">
</div>

<div id="idRestore" style="display:none">
<input id="idRestoreRefrences" type="button" class="grey_btn" value="Restore" alt="Restore references" title="Restore references" align="absbottom" name="RestoreRef" onclick="return confirmDeleteForTrash(this.form,'restore');">
</div>

<div id="removeFgroup_List" style="display: none;">
<input type="button" class="grey_btn" alt="Remove checked references from this group" name="removefromgroup" value="Remove from Group" hspace="3" align="absbottom" id="removeFromGroup" title="Remove checked references from this group" onclick="if(verifyCheckedAllforremove(this.form,'ids','group'))
  {
    if(verifyCheckedAllRemove(this.form)) {
         return passFolderId(this.form,'fromGroup')
    } else { return false; }
  } else { return false; }"> 

  </div>
<!--
<div id="removeFgroupSet_List" style="display: none;">
<input type="image" src="/images/en_us/removeFgroupset.gif" alt="Remove checked references from this group set" name="removefromgroup" value="removefromgroup" hspace="3" align="absbottom" id="removeFromGroup" title="Remove checked references from this group set" onClick="if(verifyCheckedAllforremove(this.form,'ids','group'))
  {
    if(verifyCheckedAllRemove(this.form)) {
         return passFolderId(this.form,'fromGroup')
    } else { return false; }
  } else { return false; }"> 

 </div>
-->
<div id="removeFlist" style="display: none;">
<input type="button" class="grey_btn" value="Remove From List" alt="Remove checked references from this List" name="removefromgroup" hspace="3" align="absbottom" id="removeFlist" title="Remove checked references from this List" onclick="if(verifyCheckedAllforremove(this.form,'ids','list'))
  {
    if(verifyCheckedAllRemove(this.form)) {
         clearReferences(this.form);
		return true;
    } else { return false; }
  } else { return false; }"> 
  </div>
  <div id="progress_indicator_image" style="display: none; padding-right:15px; padding-bottom: 2px; background-repeat: no-repeat;">&nbsp;</div>
<div id="copy_move_progress_indicator_container" style="display: none;">
 <img src="/images/en_us/progress_indicator_spinning.gif">
    <span id="copy_move_progress_indicator_text">Adding records...</span>
</div>
<div id="delete_progress_indicator_container" style="display: none;">
	 <img src="/images/en_us/progress_indicator_spinning.gif">
    <span id="delete_progress_indicator_text">Deleting records...</span>
</div>
<div id="restore_progress_indicator_container" style="display: none;">
	 <img src="/images/en_us/progress_indicator_spinning.gif">
    <span id="restore_progress_indicator_text">Restoring records...</span>
</div>
<div id="copy_to_export_progress_indicator_container" style="display: none;">
<img src="/images/en_us/progress_indicator_spinning.gif">
<span id="copy_to_export_progress_indicator_text">Copying records...</span>
</div>
</td>
</tr>

<script language="JAVASCRIPT">
up_img = document.createElement("img");
up_img.setAttribute("id", "up_img");
up_img.setAttribute("src", "/images/en_us/sortarrowup.gif");
up_img.setAttribute("alt", "Sort arrow up icon graphic");
up_img.setAttribute("title", "Sort arrow up icon graphic");

down_img = document.createElement("img");
down_img.setAttribute("id", "down_img");
down_img.setAttribute("src", "/images/en_us/sortarrowdown.gif");
down_img.setAttribute("alt", "Sort arrow down icon graphic");
down_img.setAttribute("title", "Sort arrow down icon graphic");
</script>

<tr valign="bottom">

<th scope="col" width="18%">

 <a id="authorLink" class="columnHead" href="javascript:void(0);" onclick="sortPage('author','a');" alt="Click to sort the list by author in Z to A order" title="Click to sort the list by author in Z to A order">Author<img src="/images/en_us/sortarrowup.gif" alt="The list is sorted by author in A to Z order" title="The list is sorted by author in A to Z order"></a>
</th>
<th scope="col" width="8%">
		<a id="yearLink" class="columnHead" href="javascript:void(0);" onclick="sortPage('year','d');" alt="Click to sort the list by year in newest to oldest order" title="Click to sort the list by year in newest to oldest order">Year</a>
</th>
<th scope="col" width="74%">
		<a id="titleLink" class="columnHead" href="javascript:void(0);" onclick="sortPage('title','a');" alt="Click to sort the list by title in A to Z order" title="Click to sort the list by title in A to Z order">Title</a>
<input type="hidden" id="idForAuthor" name="authorSortOrder" value="a">
<input type="hidden" id="idForYear" name="yearSortOrder" value="d">
<input type="hidden" id="idForTitle" name="titleSortOrder" value="a">
<!--
-->
<!--
 <th scope="col" width="5%" align="center">
  <div id='idEditHeading' style='display:inline;' class="columnHead">Edit</div>
 </th>
-->




</th></tr><tr valign="bottom">
<td colspan="5" class="dothorz"></td>
</tr>

<script language="JavaScript" type="text/javascript">

function initFunctionCall(){
if('0' == '0') {
getGettingStartedStatus();
}
	if(0 == 1){
		var buttonIds = ["idDeleteTrash","removeFromGroup"];
		var altMessages = ["Move Checked References from All My References to the trash (disabled)", "Remove checked references from this group (disabled)"];
		for(i=0,j=0;i<buttonIds.length,j<altMessages.length;i++,j++){
				document.getElementById(buttonIds[i]).onclick = "javascript:void(0)";
				document.getElementById(buttonIds[i]).alt = altMessages[j];
				document.getElementById(buttonIds[i]).title = altMessages[j];
				document.getElementById(buttonIds[i]).style.cursor = 'default';
		}
		document.getElementById("idDeleteTrash").src = "/images/en_us/delete_disabled.gif";
		document.getElementById("removeFromGroup").src = "/images/en_us/removeFgroup_disabled.gif";
	}
			var folderId = "";			
			var searchItem = "";
            document.citationSearchForm.authorflag.value = "";
			document.citationSearchForm.search_item.value = decodeURIComponent("");
			if(folderId != "undefined" && folderId.length != 0) 
			{
				if (('0' == '0') || ('0' == '1' && "hide" == "hide" )) {
				loadCitations(1, document.summarypage.TopRecordsPerSummary.value,folderId);
			}
}else if(searchItem.length!=0){
				searchAuthor(searchItem);
			}else{	
				var pguid = "";				
				if(pguid != "undefined" && pguid.length != 0 && "hide" == "hide") {				
					loadCitations(1, document.summarypage.TopRecordsPerSummary.value, '0',pguid);					
				}
				else {	
				if (('0' == '0') || ('0' == '1' && "hide" == "hide" )) {
					loadCitations(1, document.summarypage.TopRecordsPerSummary.value, '0','');
					}
				}
			}
}
var dlg, dialog;

dojo.require("dijit.dijit"); // optimize: load dijit layer
dojo.require("dijit.Dialog");

function createAndShow() {
	var node = document.createElement("div");
	dojo.body().appendChild(node);
	dlg = new dijit.Dialog({
		id: "roDialog",
		content:  "<div align='center' class='summary_pagecntnav'><table style='background: #fff;border: 1px dotted #7eabcd;' id='contentTable' border='0' width='100%' cellpadding='0' cellspacing='0'><tr><td align='top' class='contnav' ><div style='float: left; height: 300px;'><img src='/images/en_us/readOnly.gif' alt='Read Only icon' align='absbottom' title='Read Only icon' /></div><div align='right'><a href='javascript:void(0)' onclick='javascript:dlg.hide();' id='dlgClose' style='font-size:70%;font-weight:dark;' alt='Close' title='Close'>Close</a></div><div><b>EndNote online is currently performing maintenance.</b></div><div><p>You will be able to access your library in <b>READ-ONLY</b> mode during this period.</p><p>Some functionality will be unavailable &ndash; adding, deleting, and editing references including shared references and changing options.</p></div><div><p><img src='/images/en_us/continue2.gif' alt='Continue' title='Continue' onclick='dlg.hide();'></p></div></td></tr></table></div>",
		draggable:false
	}, node);
    dlg._setStyleAttr({width:"50%"});
    dlg.show();
    document.getElementById("roDialog_underlay").style.opacity = 0.3;
    document.getElementById("roDialog_underlay").style.background = "#333";
    document.getElementById("dlgClose").style.outline = "none";
    //Escape Key handler for Safari browser
    if(dojo.isSafari){
	dojo.connect(dojo.byId('roDialog'), "onkeydown", this, function(evt){
		if(evt.keyCode == dojo.keys.ESCAPE){
			dlg.hide();
			dojo.stopEvent(evt);
		}
	});
    }

}

function showSpaceDialog() {
	var spaceNode = document.createElement("div");
	dojo.body().appendChild(spaceNode);
	dialog = new dijit.Dialog({
		id: "spaceDialog",
		content:  "<div id='space' style='display:block; position:static; height:200px'><div id='close' class='rightPosition' alt='Close' title='Close'><a href='javascript:void(0)' onclick='javascript:dialog.hide();'><img src='/images/en_us/close.png'></a></div><div style='height: 90px' ><div id='text2' class='leftPosition'>You are currently using <b> 0.00 KB(0.00%)</b> of the <b>2 GB</b> of <br />space available with your subscription.</div> </div><br/><br/><div align='center' style='padding:50 0'><div id='continue' class='btn-common' alt='Continue' title='Continue' onclick='dialog.hide();'>Continue</div><p></p></div></div></div>",
		draggable:false
	}, spaceNode);
    dialog._setStyleAttr({width:"60%"});
    dialog.show();
    document.getElementById("spaceDialog_underlay").style.opacity = 0.3;
    document.getElementById("spaceDialog_underlay").style.background = "#333";
    document.getElementById("close").style.outline = "none";
    //Escape Key handler for Safari browser
    if(dojo.isSafari){
	dojo.connect(dojo.byId('spaceDialog'), "onkeydown", this, function(evt){
		if(evt.keyCode == dojo.keys.ESCAPE){
			dialog.hide();
			dojo.stopEvent(evt);
		}
	});
    }
}

dojo.addOnLoad(initFunctionCall);
if(0.00 >= 90 && 0 == 1){
	dojo.addOnLoad(showSpaceDialog);
 }

</script>
<tr id="msgRow"><td colspan="5" width="100%" align="center">
<div id="citMsg" style="visibility: hidden; display: none;">
<table><tbody><tr><td>
   <img src="/images/en_us/progress_indicator_spinning.gif"> Loading References Please Wait... 
</td></tr></tbody></table>
</div>
</td></tr>

<tr>
<td colspan="10" align="left">
<table class="dothorz" id="bottomNavBar" width="100%" border="0" cellspacing="0" cellpadding="0">
<tbody><tr>
<td width="33%" class="hitCount">
<select name="BottomRecordsPerSummary" id="BottomRecordsPerSummary" class="formBoxesShow" onchange="changeNumberPerPage(this.value,'bottom')">
<option value="10">Show 10 per page</option>
<option value="25">Show 25 per page</option>
<option value="50">Show 50 per page</option>
</select>
</td>
<script language="JAVASCRIPT">

// Top Navigation Bar links

nav_first = document.createElement("a");
nav_first.setAttribute("id", "nav_first_link");
//nav_first.setAttribute("href", "javascript:void(0)");
//nav_first.setAttribute("onclick", "javascript:getFirstPage()");
nav_first.href = "javascript:void(0)";
nav_first.onclick = getFirstPage;
nav_first_img = document.createElement("img");
nav_first_img.setAttribute("id", "nav_first_img");
nav_first_img.setAttribute("src", "/images/en_us/arrow_first.gif");
nav_first_img.setAttribute("alt", "First Page");
nav_first_img.setAttribute("hspace", "3");
nav_first_img.setAttribute("border", "0");
nav_first_img.setAttribute("title", "First Page");
nav_first.appendChild(nav_first_img);

nav_first_i = document.createElement("img");
nav_first_i.setAttribute("id", "nav_first_img_i");
nav_first_i.setAttribute("src", "/images/en_us/arrow_first_i.gif");
nav_first_i.setAttribute("alt", "First Page (disabled)");
nav_first_i.setAttribute("hspace", "3");
nav_first_i.setAttribute("border", "0");
nav_first_i.setAttribute("title", "First Page (disabled)");

nav_prev = document.createElement("a");
nav_prev.setAttribute("id", "nav_prev_link");
//nav_prev.setAttribute("href", "javascript:void(0)");
//nav_prev.setAttribute("onclick", "javascript:getPrevPage()");
nav_prev.href = "javascript:void(0)";
nav_prev.onclick = getPrevPage;
nav_prev_img = document.createElement("img");
nav_prev_img.setAttribute("id", "nav_prev_img");
nav_prev_img.setAttribute("src", "/images/en_us/arrow_left.gif");
nav_prev_img.setAttribute("alt", "Previous Page");
nav_prev_img.setAttribute("hspace", "3");
nav_prev_img.setAttribute("border", "0");
nav_prev_img.setAttribute("title", "Previous Page");
nav_prev.appendChild(nav_prev_img);

nav_prev_i = document.createElement("img");
nav_prev_i.setAttribute("id", "nav_prev_img_i");
nav_prev_i.setAttribute("src", "/images/en_us/arrow_left_i.gif");
nav_prev_i.setAttribute("alt", "Previous Page (disabled)");
nav_prev_i.setAttribute("hspace", "3");
nav_prev_i.setAttribute("border", "0");
nav_prev_i.setAttribute("title", "Previous Page (disabled)");

nav_next = document.createElement("a");
nav_next.setAttribute("id", "nav_next_link");
nav_next.href = "javascript:void(0)";
nav_next.onclick = getNextPage;
nav_next_img = document.createElement("img");
nav_next_img.setAttribute("id", "nav_next_img");
nav_next_img.setAttribute("src", "/images/en_us/arrow_rgt.gif");
nav_next_img.setAttribute("alt", "Next Page");
nav_next_img.setAttribute("hspace", "3");
nav_next_img.setAttribute("border", "0");
nav_next_img.setAttribute("title", "Next Page");
nav_next.appendChild(nav_next_img);

nav_next_i = document.createElement("img");
nav_next_i.setAttribute("id", "nav_next_img_i");
nav_next_i.setAttribute("src", "/images/en_us/arrow_rgt_i.gif");
nav_next_i.setAttribute("alt", "Next Page (disabled)");
nav_next_i.setAttribute("hspace", "3");
nav_next_i.setAttribute("border", "0");
nav_next_i.setAttribute("title", "Next Page (disabled)");

nav_last = document.createElement("a");
nav_last.setAttribute("id", "nav_last_link");
//nav_last.setAttribute("href", "javascript:void(0)");
//nav_last.setAttribute("onclick", "javascript:getLastPage()");
nav_last.href = "javascript:void(0)";
nav_last.onclick = getLastPage;
nav_last_img = document.createElement("img");
nav_last_img.setAttribute("id", "nav_last_img");
nav_last_img.setAttribute("src", "/images/en_us/arrow_last.gif");
nav_last_img.setAttribute("alt", "Last Page");
nav_last_img.setAttribute("hspace", "3");
nav_last_img.setAttribute("border", "0");
nav_last_img.setAttribute("title", "Last Page");
nav_last.appendChild(nav_last_img);

nav_last_i = document.createElement("img");
nav_last_i.setAttribute("id", "nav_last_img_i");
nav_last_i.setAttribute("src", "/images/en_us/arrow_last_i.gif");
nav_last_i.setAttribute("alt", "Last Page (disabled)");
nav_last_i.setAttribute("hspace", "3");
nav_last_i.setAttribute("border", "0");
nav_last_i.setAttribute("title", "Last Page (disabled)");




//Bottom Navigation Bar links



nav_first_bottom = document.createElement("a");
nav_first_bottom.setAttribute("id", "nav_first_link_bottom");
nav_first_bottom.href = "javascript:void(0)";
nav_first_bottom.onclick = getFirstPage;
nav_first_img_bottom = document.createElement("img");
nav_first_img_bottom.setAttribute("id", "nav_first_img_bottom");
nav_first_img_bottom.setAttribute("src", "/images/en_us/arrow_first.gif");
nav_first_img_bottom.setAttribute("alt", "First Page");
nav_first_img_bottom.setAttribute("hspace", "3");
nav_first_img_bottom.setAttribute("border", "0");
nav_first_img_bottom.setAttribute("title", "First Page");
nav_first_bottom.appendChild(nav_first_img_bottom);

nav_first_i_bottom = document.createElement("img");
nav_first_i_bottom.setAttribute("id", "nav_first_img_i_bottom");
nav_first_i_bottom.setAttribute("src", "/images/en_us/arrow_first_i.gif");
nav_first_i_bottom.setAttribute("alt", "First Page (disabled)");
nav_first_i_bottom.setAttribute("hspace", "3");
nav_first_i_bottom.setAttribute("border", "0");
nav_first_i_bottom.setAttribute("title", "First Page (disabled)");

nav_prev_bottom = document.createElement("a");
nav_prev_bottom.setAttribute("id", "nav_prev_link_bottom");
nav_prev_bottom.href = "javascript:void(0)";
nav_prev_bottom.onclick = getPrevPage;
nav_prev_img_bottom = document.createElement("img");
nav_prev_img_bottom.setAttribute("id", "nav_prev_img_bottom");
nav_prev_img_bottom.setAttribute("src", "/images/en_us/arrow_left.gif");
nav_prev_img_bottom.setAttribute("alt", "Previous Page");
nav_prev_img_bottom.setAttribute("hspace", "3");
nav_prev_img_bottom.setAttribute("border", "0");
nav_prev_img_bottom.setAttribute("title", "Previous Page");
nav_prev_bottom.appendChild(nav_prev_img_bottom);

nav_prev_i_bottom = document.createElement("img");
nav_prev_i_bottom.setAttribute("id", "nav_prev_img_i_bottom");
nav_prev_i_bottom.setAttribute("src", "/images/en_us/arrow_left_i.gif");
nav_prev_i_bottom.setAttribute("alt", "Previous Page (disabled)");
nav_prev_i_bottom.setAttribute("hspace", "3");
nav_prev_i_bottom.setAttribute("border", "0");
nav_prev_i_bottom.setAttribute("title", "Previous Page (disabled)");

nav_next_bottom = document.createElement("a");
nav_next_bottom.setAttribute("id", "nav_next_link_bottom");
nav_next_bottom.href = "javascript:void(0)";
nav_next_bottom.onclick = getNextPage;
nav_next_img_bottom = document.createElement("img");
nav_next_img_bottom.setAttribute("id", "nav_next_img_bottom");
nav_next_img_bottom.setAttribute("src", "/images/en_us/arrow_rgt.gif");
nav_next_img_bottom.setAttribute("alt", "Next Page");
nav_next_img_bottom.setAttribute("hspace", "3");
nav_next_img_bottom.setAttribute("border", "0");
nav_next_img_bottom.setAttribute("title", "Next Page");
nav_next_bottom.appendChild(nav_next_img_bottom);

nav_next_i_bottom = document.createElement("img");
nav_next_i_bottom.setAttribute("id", "nav_next_img_i_bottom");
nav_next_i_bottom.setAttribute("src", "/images/en_us/arrow_rgt_i.gif");
nav_next_i_bottom.setAttribute("alt", "Next Page (disabled)");
nav_next_i_bottom.setAttribute("hspace", "3");
nav_next_i_bottom.setAttribute("border", "0");
nav_next_i_bottom.setAttribute("title", "Next Page (disabled)");

nav_last_bottom = document.createElement("a");
nav_last_bottom.setAttribute("id", "nav_last_link_bottom");
nav_last_bottom.href = "javascript:void(0)";
nav_last_bottom.onclick = getLastPage;
nav_last_img_bottom = document.createElement("img");
nav_last_img_bottom.setAttribute("id", "nav_last_img_bottom");
nav_last_img_bottom.setAttribute("src", "/images/en_us/arrow_last.gif");
nav_last_img_bottom.setAttribute("alt", "Last Page");
nav_last_img_bottom.setAttribute("hspace", "3");
nav_last_img_bottom.setAttribute("border", "0");
nav_last_img_bottom.setAttribute("title", "Last Page");
nav_last_bottom.appendChild(nav_last_img_bottom);

nav_last_i_bottom = document.createElement("img");
nav_last_i_bottom.setAttribute("id", "nav_last_img_i_bottom");
nav_last_i_bottom.setAttribute("src", "/images/en_us/arrow_last_i.gif");
nav_last_i_bottom.setAttribute("alt", "Last Page (disabled)");
nav_last_i_bottom.setAttribute("hspace", "3");
nav_last_i_bottom.setAttribute("border", "0");
nav_last_i_bottom.setAttribute("title", "Last Page (disabled)");


</script>

<td width="33%" align="center">

<table id="vcrNav" border="0" cellpadding="0" cellspacing="0">

<tbody><tr>

<td width="15" align="left" id="nav_first_container_bottom">
    <img id="nav_first_img_i_bottom" src="/images/en_us/arrow_first_i.gif" alt="First Page (disabled)" hspace="3" border="0" title="First Page (disabled)">
</td>
<td width="15" align="left" id="nav_prev_container_bottom">
<img id="nav_prev_img_i_bottom" src="/images/en_us/arrow_left_i.gif" alt="Previous Page (disabled)" hspace="3" border="0" title="Previous Page (disabled)">
</td>



<td align="center" class="goto">
<script type="text/javascript">
<!--
function onEnter( evt, id ) {
    var keyCode = null;
    if( evt.which ) {
        keyCode = evt.which;
    } else if( evt.keyCode ) {
        keyCode = evt.keyCode;
    }
    if( (13 == keyCode) || (3 == keyCode)) {
		dojo.byId(id).click();
        return false;
    }
    return true;
}
function stripSpaces(word)
{
        while(word.length && word.substring(0,1) == " ") word = word.substring(1, word.length);
        while(word.length && word.substring(word.length-1, word.length) == " ") word = word.substring(0, word.length-1);
        return word;
}
//-->
</script>
<label for="BottomPageInput">Page</label>&nbsp;
	<input class="pageNumBoxes" id="BottomPageInput" type="text" name="BottomPageInput" value="1" size="5" onkeypress="return onEnter(event,'gotoBottompage_image');"> &nbsp;of <span id="idPageCountBottom">1</span>
&nbsp;

	<input type="button" class="grey_btn" id="gotoBottompage_image" name="GoToPage" value="Go" alt="Go to the page" title="Go to the page" align="absmiddle" border="0" onclick="getCitationPage(document.summarypage.BottomPageInput.value);">
</td>


<td width="15" align="right" id="nav_next_container_bottom">
<img id="nav_next_img_i_bottom" alt="Next Page (disabled)" title="Next Page (disabled)" src="/images/en_us/arrow_rgt_i.gif" border="0" hspace="3">
</td>
<td width="15" align="right" id="nav_last_container_bottom">
<img id="nav_last_img_i_bottom" alt="Last Page (disabled)" title="Last Page (disabled)" src="/images/en_us/arrow_last_i.gif" border="0" hspace="3">
</td>

</tr>
</tbody></table></td>


<td width="33%" align="right">&nbsp;</td>
</tr>
</tbody></table>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody></table>

</div></td>
</tr>
</tbody></table>
</td>

<!-- begin: MasterEnd -->
<td width="1" class="dotvert"><img src="/images/en_us/spacer.gif"></td>
</tr>
</tbody></table>
</div></td>
</tr>
</tbody></table>
</td>
</tr>
</tbody></table>
</td>
<td width="5">&nbsp;</td>
</tr>
<tr>
    <td bgcolor="#FFFFFF" class="pagecntnav1" colspan="2">
 <div id="onlineHrBar" style="margin-left:19px;" class="dothorz"></div>
 &nbsp;

    </td>
    <td>&nbsp;</td>
</tr>
<tr>
    <td width="1">&nbsp;</td>
    <td>
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
            <tbody><tr>
                <td valign="top" class="tdbgwhite" style="padding-left:12px;">
	<!-- begin: language toggle -->
	<!-- begin: language selection -->
<script type="text/javascript">
function chgLanguage(lang){
    document.chgLangForm.locale.value = lang;
	if(document.summarypage){
		if(document.summarypage.current_folder_id){       
			var folderId = document.summarypage.current_folder_id.value;		
			if(!folderId.match(/^(-1|\d+|EL|\w+[:_]\d+)$/)) { 
				folderId = 0; 
			}			
		document.getElementById("idLangChgFolderId").value = folderId;
		}		
	}
	if(document.citationSearchForm){		
	    document.getElementById("idLangChgSearchItem").value = encodeURIComponent(document.citationSearchForm.search_item.value);
		document.getElementById("idLangAuthorFlag").value = document.citationSearchForm.authorflag.value;
    }
	if(document.getElementById("idForCitId") && document.getElementById("idViewCitation").style.display == "inline"){
		document.getElementById("idLangChgCitId").value = document.getElementById("idForCitId").value;
		var element = document.createElement("input");
	    element.setAttribute("type", "hidden");
		element.setAttribute("value", document.getElementById("idForCitId").value);
	    element.setAttribute("name", "ShowViewCitation");
		document.chgLangForm.appendChild(element);
		ga('send', 'event', 'Language - '+lang , 'Link','lang','1');
	}

var fcall;

if (document.getElementById("idLangChgAjaxFunc")) {
	fcall = document.getElementById("idLangChgAjaxFunc").value;
}
var fpatt = /ajaxErrorFunc=forgotPassword/g;
var spatt = /ajaxErrorFunc=showEMailID/g;
var rpatt = /ajaxErrorFunc=showRegister/g;
var faction = document.chgLangForm.action;

if (fcall == "showEMailID") {
  if (faction.match(spatt) == null) {
	faction =faction.replace(fpatt,fcall);
	document.chgLangForm.action =faction + "&ajaxErrorFunc=showEMailID&";
  }
}

if (fcall == "forgotPassword") {
  if (faction.match(spatt) != null) {
	faction = faction.replace(spatt,"ajaxErrorFunc="+fcall);
	document.chgLangForm.action = faction;
  }
  if (faction.match(fpatt) == null) {
	document.chgLangForm.action =faction + "&ajaxErrorFunc=forgotPassword&";
  }

}

if (fcall == "showRegister") { 
	if (faction.match(spatt) != null ) {
	faction = faction.replace(spatt,"ajaxErrorFunc="+fcall);
	document.chgLangForm.action = faction;
	}
            if (faction.match(rpatt) == null) {
	 document.chgLangForm.action =faction + "&ajaxErrorFunc=showRegister&"; 
  }
                
}

    document.chgLangForm.submit();
}
</script>
<form name="chgLangForm" id="idChgLangForm" action="./EndNoteWeb.html?APISSO=Yes&amp;func=apisso&amp;authT=i-076ef85bcfa78a721:EeU5zy5MRp6U2bKT8Zu0lg" method="post">
<input type="hidden" name="locale">
<input type="hidden" name="langChgAjaxFunc" id="idLangChgAjaxFunc" value="remoteSearchConnections">
<input type="hidden" name="langChgRetAll" id="idLangChgRetAll" value="">
<input type="hidden" name="langChgRangeStart" id="idLangChgRangeStart" value="">
<input type="hidden" name="langChgRangeEnd" id="idLangChgRangeEnd" value="">
<input type="hidden" name="langChgFolderId" id="idLangChgFolderId">
<input type="hidden" name="langChgSearchItem" id="idLangChgSearchItem">
<input type="hidden" name="langChgCitId" id="idLangChgCitId">
<input type="hidden" name="langChgAddCap" value="">
<input type="hidden" name="langAuthorFlag" id="idLangAuthorFlag">
<!-- <input type="hidden" name="ShowViewCitation" id="idShowViewCitation"> -->

   <div class="languages1" id="languages1" style="margin-left: 12px;">


   <div class="languages2">
   <div class="languages3">
   <div class="languages4">
   <span class="languageHdr">View in</span>
                                <span class="languageText"><a href="javascript:chgLanguage('zh_cn')">ç®€ä½“ä¸­æ–‡</a></span>
                                <span class="languageText"><a href="javascript:chgLanguage('zh_tw')">ç¹ä½“ä¸­æ–‡</a></span>
			   <span class="languageText">English</span>
                                <span class="languageText"><a href="javascript:chgLanguage('de')">Deutsch</a></span>
                                <span class="languageText"><a href="javascript:chgLanguage('ja')">æ—¥æœ¬èªž</a></span>
                                <span class="languageText"><a href="javascript:chgLanguage('ko_kr')">í•œêµ­ì–´</a></span>
                                <span class="languageText"><a href="javascript:chgLanguage('pt_br')">PortuguÃªs</a></span>
                                <span class="languageText"><a href="javascript:chgLanguage('es_la')">EspaÃ±ol</a></span>
</div></div></div></div>
</form>

<!--  end: language selection -->
   

	<!-- end: language toggle -->
<!-- end: MasterEnd -->
<!-- begin: Footer -->
</td>
</tr>
</tbody></table></td>
<td>&nbsp;</td>
</tr>
</tbody></table>
<!-- end: Footer -->


  




  




</body></html>